{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with an automatic size and a light gray background. Add two columns with a width of 250 pixels each, a height of 500 pixels, and a gutter of 30 pixels. The columns should have a light green tint fill and green dashed outlines. Position four circles at the bottom of the columns: two blue and red circles in the left column, two green and orange circles in the right column. Add small pink debug circles at each corner of the left column and small cyan debug circles at each corner of the right column. Ensure the columns are aligned to the left of the artboard."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 250,\n  height: 500,\n  gutter: 30,\n  verticalAlignment: \"bottom\", // BOTTOM alignment (should push circles to bottom)\n  horizontalAlignment: \"left\", // LEFT alignment (should align circles to left)\n  columnSpacing: 20,\n  \n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n  \n  columnStyle: {\n    fill: \"#e8f8f5\",  // Light green tint\n    stroke: \"#1abc9c\", // Green outline\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\", // Dashed line\n  },\n  columnBoxModel: { padding: 10 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst circle1 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle2 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(0).addElement(circle1);\ncolumns.getColumn(0).addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle4 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(1).addElement(circle3);\ncolumns.getColumn(1).addElement(circle4);\n\nfunction createDebugCircle(position, color, radius) {\n  const circle = new Circle({\n    radius: radius,\n    style: {\n      fill: color,\n      stroke: \"white\",\n      strokeWidth: 1,\n    },\n  });\n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: position,\n    x: 0,\n    y: 0,\n  });\n  return circle;\n}\n\nconst col0 = columns.getColumn(0);\nconst col1 = columns.getColumn(1);\n\nartboard.addElement(createDebugCircle(col0.contentBox.topLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.topRight, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomRight, \"#ff1493\", 5));\n\nartboard.addElement(createDebugCircle(col1.contentBox.topLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.topRight, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomRight, \"#00ffff\", 5));\n\nconsole.log(\"=== DEBUG INFO ===\");\nconsole.log(\"Column 0 content height:\", col0.contentHeight);\nconsole.log(\"Column 0 content width:\", col0.contentWidth);\nconsole.log(\"Circle 1 position:\", circle1.getAbsolutePosition());\nconsole.log(\"Circle 2 position:\", circle2.getAbsolutePosition());\nconsole.log(\"Column 0 content box bottom:\", col0.contentBox.bottomLeft.y);\nconsole.log(\"Circle 2 bottom (center.y + radius):\", circle2.center.y + 60);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a canvas with a soft background. Place a couple of columns that include some decorative circles stacked at the bottom. Use different circle colors to make them stand out. Add a few small markers at the corners of these columns for debugging purposes. Make sure everything fits nicely on the canvas and is aligned to the left."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 250,\n  height: 500,\n  gutter: 30,\n  verticalAlignment: \"bottom\", // BOTTOM alignment (should push circles to bottom)\n  horizontalAlignment: \"left\", // LEFT alignment (should align circles to left)\n  columnSpacing: 20,\n  \n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n  \n  columnStyle: {\n    fill: \"#e8f8f5\",  // Light green tint\n    stroke: \"#1abc9c\", // Green outline\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\", // Dashed line\n  },\n  columnBoxModel: { padding: 10 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst circle1 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle2 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(0).addElement(circle1);\ncolumns.getColumn(0).addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle4 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(1).addElement(circle3);\ncolumns.getColumn(1).addElement(circle4);\n\nfunction createDebugCircle(position, color, radius) {\n  const circle = new Circle({\n    radius: radius,\n    style: {\n      fill: color,\n      stroke: \"white\",\n      strokeWidth: 1,\n    },\n  });\n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: position,\n    x: 0,\n    y: 0,\n  });\n  return circle;\n}\n\nconst col0 = columns.getColumn(0);\nconst col1 = columns.getColumn(1);\n\nartboard.addElement(createDebugCircle(col0.contentBox.topLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.topRight, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomRight, \"#ff1493\", 5));\n\nartboard.addElement(createDebugCircle(col1.contentBox.topLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.topRight, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomRight, \"#00ffff\", 5));\n\nconsole.log(\"=== DEBUG INFO ===\");\nconsole.log(\"Column 0 content height:\", col0.contentHeight);\nconsole.log(\"Column 0 content width:\", col0.contentWidth);\nconsole.log(\"Circle 1 position:\", circle1.getAbsolutePosition());\nconsole.log(\"Circle 2 position:\", circle2.getAbsolutePosition());\nconsole.log(\"Column 0 content box bottom:\", col0.contentBox.bottomLeft.y);\nconsole.log(\"Circle 2 bottom (center.y + radius):\", circle2.center.y + 60);\n\nreturn artboard.render();\n\n"}]}
