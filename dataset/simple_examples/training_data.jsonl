{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background. Divide it into two columns that are 250 pixels wide, 500 pixels tall, with a 20-pixel spacing between them. Use a light green tint for the column backgrounds with green dashed outlines. Place two blue circles with a dark blue border in the first column, aligned to the bottom left. Add two circles in the second column, one green with a dark green border and one orange with a dark orange border, also aligned to the bottom left. Include small debug circles at each corner of the column content boxes, using pink in the first column and cyan in the second."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 250,\n  height: 500,\n  gutter: 30,\n  verticalAlignment: \"bottom\", // BOTTOM alignment (should push circles to bottom)\n  horizontalAlignment: \"left\", // LEFT alignment (should align circles to left)\n  columnSpacing: 20,\n  \n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n  \n  columnStyle: {\n    fill: \"#e8f8f5\",  // Light green tint\n    stroke: \"#1abc9c\", // Green outline\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\", // Dashed line\n  },\n  columnBoxModel: { padding: 10 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst circle1 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle2 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(0).addElement(circle1);\ncolumns.getColumn(0).addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle4 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(1).addElement(circle3);\ncolumns.getColumn(1).addElement(circle4);\n\nfunction createDebugCircle(position, color, radius) {\n  const circle = new Circle({\n    radius: radius,\n    style: {\n      fill: color,\n      stroke: \"white\",\n      strokeWidth: 1,\n    },\n  });\n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: position,\n    x: 0,\n    y: 0,\n  });\n  return circle;\n}\n\nconst col0 = columns.getColumn(0);\nconst col1 = columns.getColumn(1);\n\nartboard.addElement(createDebugCircle(col0.contentBox.topLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.topRight, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomRight, \"#ff1493\", 5));\n\nartboard.addElement(createDebugCircle(col1.contentBox.topLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.topRight, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomRight, \"#00ffff\", 5));\n\nconsole.log(\"=== DEBUG INFO ===\");\nconsole.log(\"Column 0 content height:\", col0.contentHeight);\nconsole.log(\"Column 0 content width:\", col0.contentWidth);\nconsole.log(\"Circle 1 position:\", circle1.getAbsolutePosition());\nconsole.log(\"Circle 2 position:\", circle2.getAbsolutePosition());\nconsole.log(\"Column 0 content box bottom:\", col0.contentBox.bottomLeft.y);\nconsole.log(\"Circle 2 bottom (center.y + radius):\", circle2.center.y + 60);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a pale background and some columns. Within these columns, add several colored circles, ensuring they are aligned towards the bottom left. Use different colors for the circles, with matching or contrasting outlines. Add a few small indicators at various points within the columns to mark positions."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 250,\n  height: 500,\n  gutter: 30,\n  verticalAlignment: \"bottom\", // BOTTOM alignment (should push circles to bottom)\n  horizontalAlignment: \"left\", // LEFT alignment (should align circles to left)\n  columnSpacing: 20,\n  \n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n  \n  columnStyle: {\n    fill: \"#e8f8f5\",  // Light green tint\n    stroke: \"#1abc9c\", // Green outline\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\", // Dashed line\n  },\n  columnBoxModel: { padding: 10 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst circle1 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle2 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(0).addElement(circle1);\ncolumns.getColumn(0).addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nconst circle4 = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncolumns.getColumn(1).addElement(circle3);\ncolumns.getColumn(1).addElement(circle4);\n\nfunction createDebugCircle(position, color, radius) {\n  const circle = new Circle({\n    radius: radius,\n    style: {\n      fill: color,\n      stroke: \"white\",\n      strokeWidth: 1,\n    },\n  });\n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: position,\n    x: 0,\n    y: 0,\n  });\n  return circle;\n}\n\nconst col0 = columns.getColumn(0);\nconst col1 = columns.getColumn(1);\n\nartboard.addElement(createDebugCircle(col0.contentBox.topLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.topRight, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomLeft, \"#ff1493\", 5));\nartboard.addElement(createDebugCircle(col0.contentBox.bottomRight, \"#ff1493\", 5));\n\nartboard.addElement(createDebugCircle(col1.contentBox.topLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.topRight, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomLeft, \"#00ffff\", 5));\nartboard.addElement(createDebugCircle(col1.contentBox.bottomRight, \"#00ffff\", 5));\n\nconsole.log(\"=== DEBUG INFO ===\");\nconsole.log(\"Column 0 content height:\", col0.contentHeight);\nconsole.log(\"Column 0 content width:\", col0.contentWidth);\nconsole.log(\"Circle 1 position:\", circle1.getAbsolutePosition());\nconsole.log(\"Circle 2 position:\", circle2.getAbsolutePosition());\nconsole.log(\"Column 0 content box bottom:\", col0.contentBox.bottomLeft.y);\nconsole.log(\"Circle 2 bottom (center.y + radius):\", circle2.center.y + 60);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a 2x2 grid layout with each cell measuring 500x350 pixels, and a 30-pixel gutter. Set the background color of the canvas to #2c3e50. Use #34495e as the fill color and #1abc9c for the stroke of the grid, with a stroke width of 2 pixels. In the top-left cell, place a right-angled triangle with sides 150 by 200 pixels, oriented towards the bottom-left, filled with #3498db, and stroked in #2980b9 with a stroke width of 3 pixels. Place a red marker circle with a radius of 6 pixels at the triangle's center. In the top-right, place another right-angled triangle with equal sides of 180 pixels, oriented towards the top-right, filled with #9b59b6, and stroked with #8e44ad. Add a similar red marker at its center. In the bottom-left cell, add an equilateral triangle with side 200 pixels, filled with #2ecc71 and stroked with #27ae60. Add a red marker at this triangle's center too. Finally, in the bottom-right cell, add an isosceles triangle with sides 180 and 220 pixels, filled with #f39c12 and stroked with #e67e22, along with a red marker at its center."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 40 },\n});\n\nconst grid = new Grid({\n  rows: 2,\n  columns: 2,\n  cellWidth: 500,\n  cellHeight: 350,\n  gutter: 30,\n  style: {\n    fill: \"#34495e\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 30 },\n});\n\ngrid.container.position({\n  relativeFrom: grid.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(grid.container);\n\nconst rightTriangle1 = new Triangle({\n  type: \"right\",\n  a: 150,\n  b: 200,\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle1.position({\n  relativeFrom: rightTriangle1.center,\n  relativeTo: grid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 0).addElement(rightTriangle1);\n\nconst marker1 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker1.position({\n  relativeFrom: marker1.center,\n  relativeTo: rightTriangle1.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(0, 0).addElement(marker1);\n\nconst rightTriangle2 = new Triangle({\n  type: \"right\",\n  a: 180,\n  b: 180,\n  orientation: \"topRight\",\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle2.position({\n  relativeFrom: rightTriangle2.center,\n  relativeTo: grid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 1).addElement(rightTriangle2);\n\nconst marker2 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker2.position({\n  relativeFrom: marker2.center,\n  relativeTo: rightTriangle2.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(0, 1).addElement(marker2);\n\nconst equilateralTriangle = new Triangle({\n  type: \"equilateral\",\n  a: 200,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nequilateralTriangle.position({\n  relativeFrom: equilateralTriangle.center,\n  relativeTo: grid.getCell(1, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 0).addElement(equilateralTriangle);\n\nconst marker3 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker3.position({\n  relativeFrom: marker3.center,\n  relativeTo: equilateralTriangle.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(1, 0).addElement(marker3);\n\nconst isoscelesTriangle = new Triangle({\n  type: \"isosceles\",\n  a: 180,\n  b: 220,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\nisoscelesTriangle.position({\n  relativeFrom: isoscelesTriangle.center,\n  relativeTo: grid.getCell(1, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 1).addElement(isoscelesTriangle);\n\nconst marker4 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker4.position({\n  relativeFrom: marker4.center,\n  relativeTo: isoscelesTriangle.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(1, 1).addElement(marker4);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a visual layout featuring several triangles in a grid format on a dark background. Use a mix of right, equilateral, and isosceles triangles with varying sizes and orientations, each having distinct colors for fills and outlines. Include some small circles at the center of each triangle, and ensure the layout maintains clear spacing between elements."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 40 },\n});\n\nconst grid = new Grid({\n  rows: 2,\n  columns: 2,\n  cellWidth: 500,\n  cellHeight: 350,\n  gutter: 30,\n  style: {\n    fill: \"#34495e\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 30 },\n});\n\ngrid.container.position({\n  relativeFrom: grid.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(grid.container);\n\nconst rightTriangle1 = new Triangle({\n  type: \"right\",\n  a: 150,\n  b: 200,\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle1.position({\n  relativeFrom: rightTriangle1.center,\n  relativeTo: grid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 0).addElement(rightTriangle1);\n\nconst marker1 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker1.position({\n  relativeFrom: marker1.center,\n  relativeTo: rightTriangle1.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(0, 0).addElement(marker1);\n\nconst rightTriangle2 = new Triangle({\n  type: \"right\",\n  a: 180,\n  b: 180,\n  orientation: \"topRight\",\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle2.position({\n  relativeFrom: rightTriangle2.center,\n  relativeTo: grid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 1).addElement(rightTriangle2);\n\nconst marker2 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker2.position({\n  relativeFrom: marker2.center,\n  relativeTo: rightTriangle2.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(0, 1).addElement(marker2);\n\nconst equilateralTriangle = new Triangle({\n  type: \"equilateral\",\n  a: 200,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nequilateralTriangle.position({\n  relativeFrom: equilateralTriangle.center,\n  relativeTo: grid.getCell(1, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 0).addElement(equilateralTriangle);\n\nconst marker3 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker3.position({\n  relativeFrom: marker3.center,\n  relativeTo: equilateralTriangle.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(1, 0).addElement(marker3);\n\nconst isoscelesTriangle = new Triangle({\n  type: \"isosceles\",\n  a: 180,\n  b: 220,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\nisoscelesTriangle.position({\n  relativeFrom: isoscelesTriangle.center,\n  relativeTo: grid.getCell(1, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 1).addElement(isoscelesTriangle);\n\nconst marker4 = new Circle({\n  radius: 6,\n  style: { fill: \"#e74c3c\" },\n});\nmarker4.position({\n  relativeFrom: marker4.center,\n  relativeTo: isoscelesTriangle.center,\n  x: 0,\n  y: 0,\n});\ngrid.getCell(1, 1).addElement(marker4);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with five columns, each 240px wide and 500px tall, aligned centrally on an artboard with a light gray background. Within each column, place a regular polygon starting with a pentagon, increasing sides by one for each subsequent column, with the first polygon being a pentagon and the fifth a nonagon. Each polygon should have a radius of 90px, with even-sided polygons rotated for a flat bottom. Use specific colors for each polygon: red, blue, green, orange, and purple, with matching border colors, and add a small dark circle at the center of each polygon. Surround each polygon with a dashed circumcircle in light gray, keeping the same radius as the polygon."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ecf0f1\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 5,\n  columnWidth: 240,\n  height: 500,\n  gutter: 20,\n  verticalAlignment: \"center\",\n  horizontalAlignment: \"center\",\n  style: {\n    fill: \"#bdc3c7\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst colors = [\n  { fill: \"#e74c3c\", stroke: \"#c0392b\" },\n  { fill: \"#3498db\", stroke: \"#2980b9\" },\n  { fill: \"#2ecc71\", stroke: \"#27ae60\" },\n  { fill: \"#f39c12\", stroke: \"#e67e22\" },\n  { fill: \"#9b59b6\", stroke: \"#8e44ad\" },\n];\n\nfor (let i = 0; i < 5; i++) {\n  const sides = 5 + i;\n  const polygon = new RegularPolygon({\n    sides: sides,\n    radius: 90,\n    rotation: sides % 2 === 0 ? 22.5 : 0, // Rotate even-sided polygons for flat bottom\n    style: {\n      fill: colors[i].fill,\n      stroke: colors[i].stroke,\n      strokeWidth: 3,\n    },\n  });\n\n  polygon.position({\n    relativeFrom: polygon.center,\n    relativeTo: columns.getColumn(i).contentBox.center,\n    x: 0,\n    y: 0,\n  });\n\n  columns.getColumn(i).addElement(polygon);\n\n  const marker = new Circle({\n    radius: 5,\n    style: { fill: \"#34495e\" },\n  });\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: polygon.center,\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(marker);\n\n  const circumCircle = new Circle({\n    radius: 90,\n    style: {\n      fill: \"none\",\n      stroke: \"#7f8c8d\",\n      strokeWidth: 1,\n      strokeDasharray: \"5,5\",\n    },\n  });\n  circumCircle.position({\n    relativeFrom: circumCircle.center,\n    relativeTo: polygon.center,\n    x: 0,\n    y: 0,\n  });\n  artboard.addElement(circumCircle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw an arrangement of several columns on a light background, each containing a shape with an increasing number of sides as you move along the columns. Use a variety of colors for these shapes, and ensure they are visually centered within each column. Add a small marker in the center of each shape and a lightly dashed circle around them, hinting at connection or focus."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ecf0f1\",\n  boxModel: { padding: 40 },\n});\n\nconst columns = new Columns({\n  count: 5,\n  columnWidth: 240,\n  height: 500,\n  gutter: 20,\n  verticalAlignment: \"center\",\n  horizontalAlignment: \"center\",\n  style: {\n    fill: \"#bdc3c7\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 20 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(columns.container);\n\nconst colors = [\n  { fill: \"#e74c3c\", stroke: \"#c0392b\" },\n  { fill: \"#3498db\", stroke: \"#2980b9\" },\n  { fill: \"#2ecc71\", stroke: \"#27ae60\" },\n  { fill: \"#f39c12\", stroke: \"#e67e22\" },\n  { fill: \"#9b59b6\", stroke: \"#8e44ad\" },\n];\n\nfor (let i = 0; i < 5; i++) {\n  const sides = 5 + i;\n  const polygon = new RegularPolygon({\n    sides: sides,\n    radius: 90,\n    rotation: sides % 2 === 0 ? 22.5 : 0, // Rotate even-sided polygons for flat bottom\n    style: {\n      fill: colors[i].fill,\n      stroke: colors[i].stroke,\n      strokeWidth: 3,\n    },\n  });\n\n  polygon.position({\n    relativeFrom: polygon.center,\n    relativeTo: columns.getColumn(i).contentBox.center,\n    x: 0,\n    y: 0,\n  });\n\n  columns.getColumn(i).addElement(polygon);\n\n  const marker = new Circle({\n    radius: 5,\n    style: { fill: \"#34495e\" },\n  });\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: polygon.center,\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(marker);\n\n  const circumCircle = new Circle({\n    radius: 90,\n    style: {\n      fill: \"none\",\n      stroke: \"#7f8c8d\",\n      strokeWidth: 1,\n      strokeDasharray: \"5,5\",\n    },\n  });\n  circumCircle.position({\n    relativeFrom: circumCircle.center,\n    relativeTo: polygon.center,\n    x: 0,\n    y: 0,\n  });\n  artboard.addElement(circumCircle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with an automatic size and a dark blue background. Place a red circle with a radius of 60 exactly in the center. Above it at a distance of 250, position a blue square of size 100. To the right at the same distance, add an equilateral green triangle with a side length of 120. Below the center circle, include an orange circle with a radius of 70. To the left, position a purple right triangle with equal sides of 100, oriented towards the top right. Draw dashed lines connecting the center of the red circle to the center of each of these shapes, with each line matching the color of the target shape."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 50 },\n});\n\nconst centerCircle = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncenterCircle.position({\n  relativeFrom: centerCircle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(centerCircle);\n\nconst topSquare = new Square({\n  size: 100,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\ntopSquare.position({\n  relativeFrom: topSquare.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: -250,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(topSquare);\n\nconst rightTriangle = new Triangle({\n  type: \"equilateral\",\n  a: 120,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle.position({\n  relativeFrom: rightTriangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(rightTriangle);\n\nconst bottomCircle = new Circle({\n  radius: 70,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\nbottomCircle.position({\n  relativeFrom: bottomCircle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 250,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(bottomCircle);\n\nconst leftTriangle = new Triangle({\n  type: \"right\",\n  a: 100,\n  b: 100,\n  orientation: \"topRight\",\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\nleftTriangle.position({\n  relativeFrom: leftTriangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: -250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(leftTriangle);\n\nconst lineTargets = [\n  { shape: topSquare, color: \"#3498db\", name: \"topSquare\" },\n  { shape: rightTriangle, color: \"#2ecc71\", name: \"rightTriangle\" },\n  { shape: bottomCircle, color: \"#f39c12\", name: \"bottomCircle\" },\n  { shape: leftTriangle, color: \"#9b59b6\", name: \"leftTriangle\" },\n];\n\nconsole.log(\"=== BEFORE LINE CREATION ===\");\nconsole.log(\"centerCircle.center:\", centerCircle.center);\nlineTargets.forEach((t) => {\n  console.log(`${t.name}.center:`, t.shape.center);\n});\n\nlineTargets.forEach((target) => {\n  const dx = target.shape.center.x - centerCircle.center.x;\n  const dy = target.shape.center.y - centerCircle.center.y;\n  \n  console.log(`${target.name}: dx=${dx}, dy=${dy}`);\n  \n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: dx, y: dy },\n    style: {\n      stroke: target.color,\n      strokeWidth: 3,\n      strokeDasharray: \"10,5\",\n    },\n  });\n\n  line.position({\n    relativeFrom: line.start,\n    relativeTo: centerCircle.center,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n\n  artboard.addElement(line);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw several different shapes on a canvas, each with distinct colors and sizes. Include a circle in the center and arrange other shapes like squares and triangles around it at equal distances. Connect these shapes to the center circle using dashed lines. Use various colors for the lines that correspond to the colors of the shapes they connect to."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 50 },\n});\n\nconst centerCircle = new Circle({\n  radius: 60,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncenterCircle.position({\n  relativeFrom: centerCircle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(centerCircle);\n\nconst topSquare = new Square({\n  size: 100,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 3,\n  },\n});\n\ntopSquare.position({\n  relativeFrom: topSquare.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: -250,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(topSquare);\n\nconst rightTriangle = new Triangle({\n  type: \"equilateral\",\n  a: 120,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\nrightTriangle.position({\n  relativeFrom: rightTriangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(rightTriangle);\n\nconst bottomCircle = new Circle({\n  radius: 70,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\nbottomCircle.position({\n  relativeFrom: bottomCircle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 250,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(bottomCircle);\n\nconst leftTriangle = new Triangle({\n  type: \"right\",\n  a: 100,\n  b: 100,\n  orientation: \"topRight\",\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\nleftTriangle.position({\n  relativeFrom: leftTriangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: -250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(leftTriangle);\n\nconst lineTargets = [\n  { shape: topSquare, color: \"#3498db\", name: \"topSquare\" },\n  { shape: rightTriangle, color: \"#2ecc71\", name: \"rightTriangle\" },\n  { shape: bottomCircle, color: \"#f39c12\", name: \"bottomCircle\" },\n  { shape: leftTriangle, color: \"#9b59b6\", name: \"leftTriangle\" },\n];\n\nconsole.log(\"=== BEFORE LINE CREATION ===\");\nconsole.log(\"centerCircle.center:\", centerCircle.center);\nlineTargets.forEach((t) => {\n  console.log(`${t.name}.center:`, t.shape.center);\n});\n\nlineTargets.forEach((target) => {\n  const dx = target.shape.center.x - centerCircle.center.x;\n  const dy = target.shape.center.y - centerCircle.center.y;\n  \n  console.log(`${target.name}: dx=${dx}, dy=${dy}`);\n  \n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: dx, y: dy },\n    style: {\n      stroke: target.color,\n      strokeWidth: 3,\n      strokeDasharray: \"10,5\",\n    },\n  });\n\n  line.position({\n    relativeFrom: line.start,\n    relativeTo: centerCircle.center,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n\n  artboard.addElement(line);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Please create an artboard with a dark blue-gray background. Place a top grid containing one row and five columns. In the first cell, insert a circle with a radius of 80px and a blue stroke, inside a square of size 113px filled with blue. In the second cell, place an equilateral triangle with a side length of 150px, filled with red. In the third cell, add a pentagon with a radius of 75px, filled with green. Next, add a hexagon with a radius of 75px and a 30-degree rotation, filled with orange in the fourth cell. Finally, in the fifth cell, add an octagon with a radius of 75px and a 22.5-degree rotation, filled with purple. Below these, add a bottom container in a horizontal layout with several shapes: a circle, a square, a triangle, and a hexagon, connected by dashed lines."},{"role":"assistant","content":"import { \n  Artboard, \n  Circle, \n  Rect, \n  Square, \n  Triangle, \n  RegularPolygon,\n  Line,\n  Grid,\n  Container\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#34495e\",\n  boxModel: { padding: 30 },\n});\n\nconst topGrid = new Grid({\n  rows: 1,\n  columns: 5,\n  cellWidth: 250,\n  cellHeight: 300,\n  gutter: 15,\n  style: {\n    fill: \"#2c3e50\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 15 },\n});\n\ntopGrid.container.position({\n  relativeFrom: topGrid.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(topGrid.container);\n\nconst cell0Circle = new Circle({\n  radius: 80,\n  style: {\n    fill: \"none\",\n    stroke: \"#3498db\",\n    strokeWidth: 3,\n  },\n});\n\ncell0Circle.position({\n  relativeFrom: cell0Circle.center,\n  relativeTo: topGrid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nconst cell0Square = new Square({\n  size: 113, // 80 * sqrt(2)\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 2,\n  },\n});\n\ncell0Square.position({\n  relativeFrom: cell0Square.center,\n  relativeTo: cell0Circle.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 0).addElement(cell0Circle);\ntopGrid.getCell(0, 0).addElement(cell0Square);\n\nconst cell1Triangle = new Triangle({\n  type: \"equilateral\",\n  a: 150,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncell1Triangle.position({\n  relativeFrom: cell1Triangle.center,\n  relativeTo: topGrid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 1).addElement(cell1Triangle);\n\nconst cell2Pentagon = new RegularPolygon({\n  sides: 5,\n  radius: 75,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\ncell2Pentagon.position({\n  relativeFrom: cell2Pentagon.center,\n  relativeTo: topGrid.getCell(0, 2).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 2).addElement(cell2Pentagon);\n\nconst cell3Hexagon = new RegularPolygon({\n  sides: 6,\n  radius: 75,\n  rotation: 30,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncell3Hexagon.position({\n  relativeFrom: cell3Hexagon.center,\n  relativeTo: topGrid.getCell(0, 3).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 3).addElement(cell3Hexagon);\n\nconst cell4Octagon = new RegularPolygon({\n  sides: 8,\n  radius: 75,\n  rotation: 22.5,\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\ncell4Octagon.position({\n  relativeFrom: cell4Octagon.center,\n  relativeTo: topGrid.getCell(0, 4).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 4).addElement(cell4Octagon);\n\nconst bottomContainer = new Container({\n  width: 1340,\n  height: 600,\n  direction: \"none\",\n  style: {\n    fill: \"#2c3e50\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 30 },\n});\n\nbottomContainer.position({\n  relativeFrom: bottomContainer.topLeft,\n  relativeTo: topGrid.container.bottomLeft,\n  x: 0,\n  y: 15,\n});\n\nartboard.addElement(bottomContainer);\n\nconst pattern = [\n  { \n    shape: new Circle({ radius: 50, style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 } }), \n    pos: { x: 200, y: 300 } \n  },\n  { \n    shape: new Square({ size: 90, style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 } }), \n    pos: { x: 500, y: 200 } \n  },\n  { \n    shape: new Triangle({ type: \"equilateral\", a: 100, style: { fill: \"#2ecc71\", stroke: \"#27ae60\", strokeWidth: 2 } }), \n    pos: { x: 800, y: 300 } \n  },\n  { \n    shape: new RegularPolygon({ sides: 6, radius: 50, rotation: 30, style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 } }), \n    pos: { x: 1100, y: 200 } \n  },\n];\n\npattern.forEach((item) => {\n  item.shape.position({\n    relativeFrom: item.shape.center,\n    relativeTo: bottomContainer.contentBox.topLeft,\n    x: item.pos.x,\n    y: item.pos.y,\n  });\n  bottomContainer.addElement(item.shape);\n});\n\nfor (let i = 0; i < pattern.length - 1; i++) {\n  const startShape = pattern[i].shape;\n  const endShape = pattern[i + 1].shape;\n  \n  const dx = endShape.center.x - startShape.center.x;\n  const dy = endShape.center.y - startShape.center.y;\n  \n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: dx, y: dy },\n    style: {\n      stroke: \"#ecf0f1\",\n      strokeWidth: 2,\n      strokeDasharray: \"5,5\",\n    },\n  });\n  \n  line.position({\n    relativeFrom: line.start,\n    relativeTo: startShape.center,\n    x: 0,\n    y: 0,\n  });\n  \n  bottomContainer.addElement(line);\n}\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a canvas that includes a variety of geometric shapes arranged in a grid at the top. These shapes should be colorful and include several polygons. Below this grid, there should be a section with some more shapes positioned in a pattern and connected by lines. Use some contrasting colors for the shapes and the background to make the design visually appealing."},{"role":"assistant","content":"import { \n  Artboard, \n  Circle, \n  Rect, \n  Square, \n  Triangle, \n  RegularPolygon,\n  Line,\n  Grid,\n  Container\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#34495e\",\n  boxModel: { padding: 30 },\n});\n\nconst topGrid = new Grid({\n  rows: 1,\n  columns: 5,\n  cellWidth: 250,\n  cellHeight: 300,\n  gutter: 15,\n  style: {\n    fill: \"#2c3e50\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 15 },\n});\n\ntopGrid.container.position({\n  relativeFrom: topGrid.container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(topGrid.container);\n\nconst cell0Circle = new Circle({\n  radius: 80,\n  style: {\n    fill: \"none\",\n    stroke: \"#3498db\",\n    strokeWidth: 3,\n  },\n});\n\ncell0Circle.position({\n  relativeFrom: cell0Circle.center,\n  relativeTo: topGrid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nconst cell0Square = new Square({\n  size: 113, // 80 * sqrt(2)\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 2,\n  },\n});\n\ncell0Square.position({\n  relativeFrom: cell0Square.center,\n  relativeTo: cell0Circle.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 0).addElement(cell0Circle);\ntopGrid.getCell(0, 0).addElement(cell0Square);\n\nconst cell1Triangle = new Triangle({\n  type: \"equilateral\",\n  a: 150,\n  style: {\n    fill: \"#e74c3c\",\n    stroke: \"#c0392b\",\n    strokeWidth: 3,\n  },\n});\n\ncell1Triangle.position({\n  relativeFrom: cell1Triangle.center,\n  relativeTo: topGrid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 1).addElement(cell1Triangle);\n\nconst cell2Pentagon = new RegularPolygon({\n  sides: 5,\n  radius: 75,\n  style: {\n    fill: \"#2ecc71\",\n    stroke: \"#27ae60\",\n    strokeWidth: 3,\n  },\n});\n\ncell2Pentagon.position({\n  relativeFrom: cell2Pentagon.center,\n  relativeTo: topGrid.getCell(0, 2).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 2).addElement(cell2Pentagon);\n\nconst cell3Hexagon = new RegularPolygon({\n  sides: 6,\n  radius: 75,\n  rotation: 30,\n  style: {\n    fill: \"#f39c12\",\n    stroke: \"#e67e22\",\n    strokeWidth: 3,\n  },\n});\n\ncell3Hexagon.position({\n  relativeFrom: cell3Hexagon.center,\n  relativeTo: topGrid.getCell(0, 3).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 3).addElement(cell3Hexagon);\n\nconst cell4Octagon = new RegularPolygon({\n  sides: 8,\n  radius: 75,\n  rotation: 22.5,\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 3,\n  },\n});\n\ncell4Octagon.position({\n  relativeFrom: cell4Octagon.center,\n  relativeTo: topGrid.getCell(0, 4).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ntopGrid.getCell(0, 4).addElement(cell4Octagon);\n\nconst bottomContainer = new Container({\n  width: 1340,\n  height: 600,\n  direction: \"none\",\n  style: {\n    fill: \"#2c3e50\",\n    stroke: \"#1abc9c\",\n    strokeWidth: 2,\n  },\n  boxModel: { padding: 30 },\n});\n\nbottomContainer.position({\n  relativeFrom: bottomContainer.topLeft,\n  relativeTo: topGrid.container.bottomLeft,\n  x: 0,\n  y: 15,\n});\n\nartboard.addElement(bottomContainer);\n\nconst pattern = [\n  { \n    shape: new Circle({ radius: 50, style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 } }), \n    pos: { x: 200, y: 300 } \n  },\n  { \n    shape: new Square({ size: 90, style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 } }), \n    pos: { x: 500, y: 200 } \n  },\n  { \n    shape: new Triangle({ type: \"equilateral\", a: 100, style: { fill: \"#2ecc71\", stroke: \"#27ae60\", strokeWidth: 2 } }), \n    pos: { x: 800, y: 300 } \n  },\n  { \n    shape: new RegularPolygon({ sides: 6, radius: 50, rotation: 30, style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 } }), \n    pos: { x: 1100, y: 200 } \n  },\n];\n\npattern.forEach((item) => {\n  item.shape.position({\n    relativeFrom: item.shape.center,\n    relativeTo: bottomContainer.contentBox.topLeft,\n    x: item.pos.x,\n    y: item.pos.y,\n  });\n  bottomContainer.addElement(item.shape);\n});\n\nfor (let i = 0; i < pattern.length - 1; i++) {\n  const startShape = pattern[i].shape;\n  const endShape = pattern[i + 1].shape;\n  \n  const dx = endShape.center.x - startShape.center.x;\n  const dy = endShape.center.y - startShape.center.y;\n  \n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: dx, y: dy },\n    style: {\n      stroke: \"#ecf0f1\",\n      strokeWidth: 2,\n      strokeDasharray: \"5,5\",\n    },\n  });\n  \n  line.position({\n    relativeFrom: line.start,\n    relativeTo: startShape.center,\n    x: 0,\n    y: 0,\n  });\n  \n  bottomContainer.addElement(line);\n}\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an 800x600 artboard with a dark blue background and a 50-pixel padding around the edges. Inside, include a container with a dashed outline that centers a right triangle with a 120-pixel base and a 90-pixel height, oriented to the bottom left. Fill the triangle with a blue-gray color and use a light gray stroke. Calculate and display squares on each side of the triangle, filling them with red, blue, and green colors at 70% opacity. Add small white circles with colored borders at the corners of these squares."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Triangle,\n  Rect,\n  Circle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 50 },\n});\n\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\", // Freeform mode with normalization\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"none\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\",\n  },\n});\n\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120, // Base = 3 units\n  b: 90, // Height = 4 units\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#34495e\",\n    stroke: \"#ecf0f1\",\n    strokeWidth: 3,\n  },\n});\n\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: container.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(triangle);\n\nconst sides = triangle.sides;\nconst colors = [\"#e74c3c\", \"#3498db\", \"#2ecc71\"]; // Red, Blue, Green\n\nconsole.log(\"=== PYTHAGOREAN THEOREM ===\");\nconsole.log(\"Side a:\", Math.round(sides[0].length));\nconsole.log(\"Side b:\", Math.round(sides[1].length));\nconsole.log(\"Side c (hypotenuse):\", Math.round(sides[2].length));\nconsole.log(\n  \"a² + b² = c²?\",\n  Math.round(sides[0].length ** 2 + sides[1].length ** 2),\n  \"≈\",\n  Math.round(sides[2].length ** 2)\n);\n\nconst squares = [];\nsides.forEach((side, index) => {\n  const square = new Rect({\n    width: side.length,\n    height: side.length,\n    style: {\n      fill: colors[index],\n      fillOpacity: 0.7,\n      stroke: colors[index],\n      strokeWidth: 2,\n    },\n  });\n\n  square.position({\n    relativeFrom: square.center,\n    relativeTo: side.center,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n\n  square.rotate(side.angle);\n\n  square.translate(side.outwardNormal, side.length / 2);\n\n  container.addElement(square);\n  squares.push(square);\n});\n\nsquares.forEach((square, index) => {\n  const corners = square.getCorners();\n  corners.forEach((corner) => {\n    const debugCircle = new Circle({\n      radius: 4,\n      style: {\n        fill: \"white\",\n        stroke: colors[index],\n        strokeWidth: 2,\n      },\n    });\n\n    debugCircle.position({\n      relativeFrom: debugCircle.center,\n      relativeTo: corner,\n      x: 0,\n      y: 0,\n      boxReference: \"contentBox\",\n    });\n\n    container.addElement(debugCircle);\n  });\n});\n\ncontainer.finalizeFreeformLayout();\n\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(container);\n\nconsole.log(\"\\n=== CONTAINER ===\");\nconsole.log(\"Final size:\", container.width, \"x\", container.height);\nconsole.log(\"Position:\", container.getAbsolutePosition());\n\nconsole.log(\"\\n=== ARTBOARD ===\");\nconsole.log(\"Final size:\", artboard.width, \"x\", artboard.height);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a medium-sized artboard with a dark background color. Inside, have a freeform space with a dashed outline containing a right triangle. Place a few squares beside each triangle side, each with a different color and some opacity. Also, add small contrasting circles at the corners of these squares. Make sure everything is centered and neatly arranged."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Triangle,\n  Rect,\n  Circle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#2c3e50\",\n  boxModel: { padding: 50 },\n});\n\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\", // Freeform mode with normalization\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"none\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\",\n  },\n});\n\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120, // Base = 3 units\n  b: 90, // Height = 4 units\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#34495e\",\n    stroke: \"#ecf0f1\",\n    strokeWidth: 3,\n  },\n});\n\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: container.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(triangle);\n\nconst sides = triangle.sides;\nconst colors = [\"#e74c3c\", \"#3498db\", \"#2ecc71\"]; // Red, Blue, Green\n\nconsole.log(\"=== PYTHAGOREAN THEOREM ===\");\nconsole.log(\"Side a:\", Math.round(sides[0].length));\nconsole.log(\"Side b:\", Math.round(sides[1].length));\nconsole.log(\"Side c (hypotenuse):\", Math.round(sides[2].length));\nconsole.log(\n  \"a² + b² = c²?\",\n  Math.round(sides[0].length ** 2 + sides[1].length ** 2),\n  \"≈\",\n  Math.round(sides[2].length ** 2)\n);\n\nconst squares = [];\nsides.forEach((side, index) => {\n  const square = new Rect({\n    width: side.length,\n    height: side.length,\n    style: {\n      fill: colors[index],\n      fillOpacity: 0.7,\n      stroke: colors[index],\n      strokeWidth: 2,\n    },\n  });\n\n  square.position({\n    relativeFrom: square.center,\n    relativeTo: side.center,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n\n  square.rotate(side.angle);\n\n  square.translate(side.outwardNormal, side.length / 2);\n\n  container.addElement(square);\n  squares.push(square);\n});\n\nsquares.forEach((square, index) => {\n  const corners = square.getCorners();\n  corners.forEach((corner) => {\n    const debugCircle = new Circle({\n      radius: 4,\n      style: {\n        fill: \"white\",\n        stroke: colors[index],\n        strokeWidth: 2,\n      },\n    });\n\n    debugCircle.position({\n      relativeFrom: debugCircle.center,\n      relativeTo: corner,\n      x: 0,\n      y: 0,\n      boxReference: \"contentBox\",\n    });\n\n    container.addElement(debugCircle);\n  });\n});\n\ncontainer.finalizeFreeformLayout();\n\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(container);\n\nconsole.log(\"\\n=== CONTAINER ===\");\nconsole.log(\"Final size:\", container.width, \"x\", container.height);\nconsole.log(\"Position:\", container.getAbsolutePosition());\n\nconsole.log(\"\\n=== ARTBOARD ===\");\nconsole.log(\"Final size:\", artboard.width, \"x\", artboard.height);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background, 800 by 600 pixels. Add a blue rectangle (100x60) with a dark blue border, positioned 150 pixels right and 100 pixels down from the top-left corner. Rotate it 30 degrees. Place circles at its corners, each with different colors (red, orange, green, purple). Add a red square (80x80) with a 70% opacity, positioned 400 pixels right and 150 pixels down, rotated 45 degrees, and move it slightly downwards and to the right. Place similar colored circles at each of its corners. Draw a green equilateral triangle (80 pixels on each side) at 150 pixels right and 350 pixels down, rotated 60 degrees, and shifted slightly. Place larger colored circles at its vertices. Finally, add a purple rectangle (60x40) at 550 pixels right and 350 pixels down, with several translations to adjust its position, and add smaller colored circles at its corners."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#ecf0f1\",\n  boxModel: { padding: 40 },\n});\n\nconst rect1 = new Rect({\n  width: 100,\n  height: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 2,\n  },\n});\n\nrect1.position({\n  relativeFrom: rect1.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 100,\n  boxReference: \"contentBox\",\n});\n\nrect1.rotate(30); // Rotate 30 degrees\n\nartboard.addElement(rect1);\n\nrect1.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst rect2 = new Rect({\n  width: 80,\n  height: 80,\n  style: {\n    fill: \"#e74c3c\",\n    fillOpacity: 0.7,\n    stroke: \"#c0392b\",\n    strokeWidth: 2,\n  },\n});\n\nrect2.position({\n  relativeFrom: rect2.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 400,\n  y: 150,\n  boxReference: \"contentBox\",\n});\n\nrect2.rotate(45);\nrect2.translate({ x: 1, y: -1 }, 60);\n\nartboard.addElement(rect2);\n\nrect2.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst triangle = new Triangle({\n  type: \"equilateral\",\n  a: 80,\n  style: {\n    fill: \"#2ecc71\",\n    fillOpacity: 0.8,\n    stroke: \"#27ae60\",\n    strokeWidth: 2,\n  },\n});\n\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 350,\n  boxReference: \"contentBox\",\n});\n\ntriangle.rotate(60);\ntriangle.translate({ x: 2, y: 1 }, 40);\n\nartboard.addElement(triangle);\n\ntriangle.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 5,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst rect3 = new Rect({\n  width: 60,\n  height: 40,\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 2,\n  },\n});\n\nrect3.position({\n  relativeFrom: rect3.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 550,\n  y: 350,\n  boxReference: \"contentBox\",\n});\n\nrect3.translate({ x: 1, y: 0 }, 30);  // Move right\nrect3.translate({ x: 0, y: 1 }, 40);  // Move down\nrect3.translate({ x: -1, y: 0 }, 20); // Move left\n\nartboard.addElement(rect3);\n\nrect3.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconsole.log(\"=== TRANSFORM EXAMPLES ===\");\nconsole.log(\"Rect1 (rotated 30°):\");\nconsole.log(\"  Center:\", rect1.center);\nconsole.log(\"  Corners:\", rect1.getCorners());\n\nconsole.log(\"\\nRect2 (rotated 45° + translated):\");\nconsole.log(\"  Center:\", rect2.center);\nconsole.log(\"  Corners:\", rect2.getCorners());\n\nconsole.log(\"\\nTriangle (rotated 60° + translated):\");\nconsole.log(\"  Center:\", triangle.center);\nconsole.log(\"  Vertices:\", triangle.getCorners());\n\nconsole.log(\"\\nRect3 (multiple translations):\");\nconsole.log(\"  Center:\", rect3.center);\nconsole.log(\"  Corners:\", rect3.getCorners());\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw an artboard with a soft background and several geometric shapes like rectangles, squares, and triangles. Include various sizes and colors, some with rotations and slight movements. Make sure to add some small colorful circles at the corners or points of the shapes for decoration. The shapes should be spaced out across the artboard to create an interesting layout."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#ecf0f1\",\n  boxModel: { padding: 40 },\n});\n\nconst rect1 = new Rect({\n  width: 100,\n  height: 60,\n  style: {\n    fill: \"#3498db\",\n    stroke: \"#2980b9\",\n    strokeWidth: 2,\n  },\n});\n\nrect1.position({\n  relativeFrom: rect1.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 100,\n  boxReference: \"contentBox\",\n});\n\nrect1.rotate(30); // Rotate 30 degrees\n\nartboard.addElement(rect1);\n\nrect1.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst rect2 = new Rect({\n  width: 80,\n  height: 80,\n  style: {\n    fill: \"#e74c3c\",\n    fillOpacity: 0.7,\n    stroke: \"#c0392b\",\n    strokeWidth: 2,\n  },\n});\n\nrect2.position({\n  relativeFrom: rect2.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 400,\n  y: 150,\n  boxReference: \"contentBox\",\n});\n\nrect2.rotate(45);\nrect2.translate({ x: 1, y: -1 }, 60);\n\nartboard.addElement(rect2);\n\nrect2.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst triangle = new Triangle({\n  type: \"equilateral\",\n  a: 80,\n  style: {\n    fill: \"#2ecc71\",\n    fillOpacity: 0.8,\n    stroke: \"#27ae60\",\n    strokeWidth: 2,\n  },\n});\n\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 350,\n  boxReference: \"contentBox\",\n});\n\ntriangle.rotate(60);\ntriangle.translate({ x: 2, y: 1 }, 40);\n\nartboard.addElement(triangle);\n\ntriangle.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 5,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconst rect3 = new Rect({\n  width: 60,\n  height: 40,\n  style: {\n    fill: \"#9b59b6\",\n    stroke: \"#8e44ad\",\n    strokeWidth: 2,\n  },\n});\n\nrect3.position({\n  relativeFrom: rect3.center,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 550,\n  y: 350,\n  boxReference: \"contentBox\",\n});\n\nrect3.translate({ x: 1, y: 0 }, 30);  // Move right\nrect3.translate({ x: 0, y: 1 }, 40);  // Move down\nrect3.translate({ x: -1, y: 0 }, 20); // Move left\n\nartboard.addElement(rect3);\n\nrect3.getCorners().forEach((corner, index) => {\n  const circle = new Circle({\n    radius: 4,\n    style: {\n      fill: [\"#e74c3c\", \"#f39c12\", \"#2ecc71\", \"#9b59b6\"][index],\n      stroke: \"white\",\n      strokeWidth: 2,\n    },\n  });\n  \n  circle.position({\n    relativeFrom: circle.center,\n    relativeTo: corner,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(circle);\n});\n\nconsole.log(\"=== TRANSFORM EXAMPLES ===\");\nconsole.log(\"Rect1 (rotated 30°):\");\nconsole.log(\"  Center:\", rect1.center);\nconsole.log(\"  Corners:\", rect1.getCorners());\n\nconsole.log(\"\\nRect2 (rotated 45° + translated):\");\nconsole.log(\"  Center:\", rect2.center);\nconsole.log(\"  Corners:\", rect2.getCorners());\n\nconsole.log(\"\\nTriangle (rotated 60° + translated):\");\nconsole.log(\"  Center:\", triangle.center);\nconsole.log(\"  Vertices:\", triangle.getCorners());\n\nconsole.log(\"\\nRect3 (multiple translations):\");\nconsole.log(\"  Center:\", rect3.center);\nconsole.log(\"  Corners:\", rect3.getCorners());\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and padding of 50 pixels. Add a vertical container at the top-left with a width of 600 pixels, spacing of 40 pixels between elements, and no fill. Display three sections of text: 1) Einstein's equation with the part highlighted in light yellow with a brown border, 2) Pythagorean theorem with variables highlighted in light blue with a dark blue border, 3) Quadratic formula with components highlighted in different colors - light yellow with a brown border for 'b', light red with a dark red border for 'b^2-4ac', and light green with a dark green border for '2a'. Add a sentence at the end with keywords like 'energy', 'mass', and 'light' highlighted in green, each marked with a green circle above them."},{"role":"assistant","content":"if (typeof document !== 'undefined') {\n  const style = document.createElement('style');\n  style.textContent = `\n    #mass-energy,\n    .variable,\n    .concept,\n    #coef-b,\n    #discriminant,\n    #denominator {\n      outline: 2px solid red !important;\n      outline-offset: 0px;\n    }\n    \n    #mass-energy::before,\n    .variable::before,\n    .concept::before,\n    #coef-b::before,\n    #discriminant::before,\n    #denominator::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      border: 1px dashed blue;\n      pointer-events: none;\n    }\n  `;\n  document.head.appendChild(style);\n  console.log('[Debug] CSS styling added for annotated elements (red outline)');\n}\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst mainContainer = new Container({\n  width: 600,\n  height: \"auto\",\n  direction: \"vertical\",\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"left\",\n  spacing: 40,\n  boxModel: { padding: 0 },\n  style: {\n    fill: \"none\",\n  },\n});\n\nartboard.addElement(mainContainer);\n\nfunction createSection(content, highlights) {\n  const text = new Text({\n    content,\n    fontSize: 24,\n    fontFamily: \"Georgia\",\n    style: {\n      fill: \"#2c3e50\",\n    },\n  });\n\n  mainContainer.addElement(text);\n\n  highlights.forEach(({ id, className, color, stroke }) => {\n    let element;\n    if (id) {\n      element = text.getElementById(id);\n    } else if (className) {\n      const elements = text.getElementsByClass(className);\n      elements.forEach((el, idx) => {\n        console.log(`[Example] Creating highlight for class \"${className}\" [${idx}]`);\n        console.log(`  Element bbox: ${el.bbox.width.toFixed(2)} x ${el.bbox.height.toFixed(2)} at (${el.bbox.x.toFixed(2)}, ${el.bbox.y.toFixed(2)})`);\n        console.log(`  Highlight size: ${el.bbox.width.toFixed(2)} x ${el.bbox.height.toFixed(2)} (no padding)`);\n        console.log(`  Highlight position: (${el.topLeft.x.toFixed(2)}, ${el.topLeft.y.toFixed(2)})`);\n        \n        const highlight = new Rect({\n          width: el.bbox.width,\n          height: el.bbox.height,\n          style: {\n            fill: color,\n            stroke: stroke,\n            strokeWidth: 2,\n            opacity: 0.5,\n          },\n        });\n\n        highlight.position({\n          relativeFrom: highlight.topLeft,\n          relativeTo: { x: el.topLeft.x, y: el.topLeft.y },\n          x: 0,\n          y: 0,\n        });\n\n        artboard.addElement(highlight);\n      });\n      return; // Skip single element handling\n    }\n\n    if (element) {\n      console.log(`[Example] Creating highlight for ID \"${id}\"`);\n      console.log(`  Element bbox: ${element.bbox.width.toFixed(2)} x ${element.bbox.height.toFixed(2)} at (${element.bbox.x.toFixed(2)}, ${element.bbox.y.toFixed(2)})`);\n      console.log(`  Highlight size: ${element.bbox.width.toFixed(2)} x ${element.bbox.height.toFixed(2)} (no padding)`);\n      console.log(`  Highlight position: (${element.topLeft.x.toFixed(2)}, ${element.topLeft.y.toFixed(2)})`);\n      \n      const highlight = new Rect({\n        width: element.bbox.width,\n        height: element.bbox.height,\n        style: {\n          fill: color,\n          stroke: stroke,\n          strokeWidth: 2,\n          opacity: 0.5,\n        },\n      });\n\n      highlight.position({\n        relativeFrom: highlight.topLeft,\n        relativeTo: { x: element.topLeft.x, y: element.topLeft.y },\n        x: 0,\n        y: 0,\n      });\n\n      artboard.addElement(highlight);\n    }\n  });\n}\n\ncreateSection(\n  \"Einstein's equation $E = \\\\cssId{mass-energy}{mc^2}$ is famous.\",\n  [\n    {\n      id: \"mass-energy\",\n      color: \"#fff3cd\",\n      stroke: \"#856404\",\n    },\n  ]\n);\n\ncreateSection(\n  \"Pythagorean theorem: $\\\\class{variable}{x}^2 + \\\\class{variable}{y}^2 = \\\\class{variable}{z}^2$\",\n  [\n    {\n      className: \"variable\",\n      color: \"#d1ecf1\",\n      stroke: \"#0c5460\",\n    },\n  ]\n);\n\ncreateSection(\n  \"Quadratic formula: $x = \\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}$\",\n  [\n    { id: \"coef-b\", color: \"#fff3cd\", stroke: \"#856404\" },\n    { id: \"discriminant\", color: \"#f8d7da\", stroke: \"#721c24\" },\n    { id: \"denominator\", color: \"#d4edda\", stroke: \"#155724\" },\n  ]\n);\n\nconst sentence = new Text({\n  content:\n    \"Key concepts: $\\\\class{concept}{energy}$, $\\\\class{concept}{mass}$, and $\\\\class{concept}{light}$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nmainContainer.addElement(sentence);\n\nconst concepts = sentence.getElementsByClass(\"concept\");\nconsole.log(`Found ${concepts.length} concepts:`, concepts);\n\nconcepts.forEach((concept, index) => {\n  const marker = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#28a745\",\n      stroke: \"#155724\",\n      strokeWidth: 2,\n    },\n  });\n\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: { x: concept.topCenter.x, y: concept.topCenter.y - 15 },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(marker);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a canvas with a soft background and padding around its edges. Place a container to hold multiple sections of mathematical text and concepts in a vertical layout. Highlight certain parts in various colors for emphasis, using different shades for different terms. Also, include some key phrases and mark them with small symbols above them to make them stand out visually."},{"role":"assistant","content":"if (typeof document !== 'undefined') {\n  const style = document.createElement('style');\n  style.textContent = `\n    #mass-energy,\n    .variable,\n    .concept,\n    #coef-b,\n    #discriminant,\n    #denominator {\n      outline: 2px solid red !important;\n      outline-offset: 0px;\n    }\n    \n    #mass-energy::before,\n    .variable::before,\n    .concept::before,\n    #coef-b::before,\n    #discriminant::before,\n    #denominator::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      border: 1px dashed blue;\n      pointer-events: none;\n    }\n  `;\n  document.head.appendChild(style);\n  console.log('[Debug] CSS styling added for annotated elements (red outline)');\n}\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst mainContainer = new Container({\n  width: 600,\n  height: \"auto\",\n  direction: \"vertical\",\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"left\",\n  spacing: 40,\n  boxModel: { padding: 0 },\n  style: {\n    fill: \"none\",\n  },\n});\n\nartboard.addElement(mainContainer);\n\nfunction createSection(content, highlights) {\n  const text = new Text({\n    content,\n    fontSize: 24,\n    fontFamily: \"Georgia\",\n    style: {\n      fill: \"#2c3e50\",\n    },\n  });\n\n  mainContainer.addElement(text);\n\n  highlights.forEach(({ id, className, color, stroke }) => {\n    let element;\n    if (id) {\n      element = text.getElementById(id);\n    } else if (className) {\n      const elements = text.getElementsByClass(className);\n      elements.forEach((el, idx) => {\n        console.log(`[Example] Creating highlight for class \"${className}\" [${idx}]`);\n        console.log(`  Element bbox: ${el.bbox.width.toFixed(2)} x ${el.bbox.height.toFixed(2)} at (${el.bbox.x.toFixed(2)}, ${el.bbox.y.toFixed(2)})`);\n        console.log(`  Highlight size: ${el.bbox.width.toFixed(2)} x ${el.bbox.height.toFixed(2)} (no padding)`);\n        console.log(`  Highlight position: (${el.topLeft.x.toFixed(2)}, ${el.topLeft.y.toFixed(2)})`);\n        \n        const highlight = new Rect({\n          width: el.bbox.width,\n          height: el.bbox.height,\n          style: {\n            fill: color,\n            stroke: stroke,\n            strokeWidth: 2,\n            opacity: 0.5,\n          },\n        });\n\n        highlight.position({\n          relativeFrom: highlight.topLeft,\n          relativeTo: { x: el.topLeft.x, y: el.topLeft.y },\n          x: 0,\n          y: 0,\n        });\n\n        artboard.addElement(highlight);\n      });\n      return; // Skip single element handling\n    }\n\n    if (element) {\n      console.log(`[Example] Creating highlight for ID \"${id}\"`);\n      console.log(`  Element bbox: ${element.bbox.width.toFixed(2)} x ${element.bbox.height.toFixed(2)} at (${element.bbox.x.toFixed(2)}, ${element.bbox.y.toFixed(2)})`);\n      console.log(`  Highlight size: ${element.bbox.width.toFixed(2)} x ${element.bbox.height.toFixed(2)} (no padding)`);\n      console.log(`  Highlight position: (${element.topLeft.x.toFixed(2)}, ${element.topLeft.y.toFixed(2)})`);\n      \n      const highlight = new Rect({\n        width: element.bbox.width,\n        height: element.bbox.height,\n        style: {\n          fill: color,\n          stroke: stroke,\n          strokeWidth: 2,\n          opacity: 0.5,\n        },\n      });\n\n      highlight.position({\n        relativeFrom: highlight.topLeft,\n        relativeTo: { x: element.topLeft.x, y: element.topLeft.y },\n        x: 0,\n        y: 0,\n      });\n\n      artboard.addElement(highlight);\n    }\n  });\n}\n\ncreateSection(\n  \"Einstein's equation $E = \\\\cssId{mass-energy}{mc^2}$ is famous.\",\n  [\n    {\n      id: \"mass-energy\",\n      color: \"#fff3cd\",\n      stroke: \"#856404\",\n    },\n  ]\n);\n\ncreateSection(\n  \"Pythagorean theorem: $\\\\class{variable}{x}^2 + \\\\class{variable}{y}^2 = \\\\class{variable}{z}^2$\",\n  [\n    {\n      className: \"variable\",\n      color: \"#d1ecf1\",\n      stroke: \"#0c5460\",\n    },\n  ]\n);\n\ncreateSection(\n  \"Quadratic formula: $x = \\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}$\",\n  [\n    { id: \"coef-b\", color: \"#fff3cd\", stroke: \"#856404\" },\n    { id: \"discriminant\", color: \"#f8d7da\", stroke: \"#721c24\" },\n    { id: \"denominator\", color: \"#d4edda\", stroke: \"#155724\" },\n  ]\n);\n\nconst sentence = new Text({\n  content:\n    \"Key concepts: $\\\\class{concept}{energy}$, $\\\\class{concept}{mass}$, and $\\\\class{concept}{light}$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nmainContainer.addElement(sentence);\n\nconst concepts = sentence.getElementsByClass(\"concept\");\nconsole.log(`Found ${concepts.length} concepts:`, concepts);\n\nconcepts.forEach((concept, index) => {\n  const marker = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#28a745\",\n      stroke: \"#155724\",\n      strokeWidth: 2,\n    },\n  });\n\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: { x: concept.topCenter.x, y: concept.topCenter.y - 15 },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(marker);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual representation with a width of 900 and a height of 1200, featuring a light grey background. At the top, display a title '1. Pure Latex (No text mixing)' in bold Arial font, size 20, with a dark blue color. Below, add the equation 'E = mc^2' in LaTeX format, size 28, in the same dark blue. Highlight the 'mc^2' part with a light yellow rectangle at 50% opacity. Further down, display another LaTeX equation showing 'x^2 + y^2 = z^2' in size 26, with highlights on 'x', 'y', and 'z' using a light blue color at 50% opacity. Then, add the quadratic formula in display mode, size 36, with three highlighted sections: 'b' in light yellow, 'b^2-4ac' in light red, and '2a' in light green, all at 50% opacity. After a space, introduce a second section with a title '2. Text with embedded LaTeX (Text mixing)' in the same style as the first title. Include a sentence about Einstein's equation, embedding 'E = mc^2' with a highlight on 'mc^2' similar to before. Add debug rectangles around each LaTeX component in blue dashed lines. Follow with a sentence describing the Pythagorean theorem, highlighting 'x', 'y', and 'z' in light blue. Finally, add a sentence about the quadratic formula, highlighting 'b', 'b^2-4ac', and '2a' similarly to before."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 900,\n  height: 1200,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 0 },\n});\n\nlet currentY = 50;\n\n\nconst sectionTitle1 = new Text({\n  content: \"1. Pure Latex (No text mixing)\",\n  fontSize: 20,\n  fontFamily: \"Arial\",\n  fontWeight: \"bold\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nsectionTitle1.position({\n  relativeFrom: sectionTitle1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(sectionTitle1);\ncurrentY += 40;\n\nconst latex1 = new Latex({\n  content: \"E = \\\\cssId{mass-energy}{mc^2}\",\n  fontSize: 28,\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex1.position({\n  relativeFrom: latex1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex1);\n\nconst elem1 = latex1.getElementById(\"mass-energy\");\nif (elem1) {\n  const highlight1 = new Rect({\n    width: elem1.bbox.width,\n    height: elem1.bbox.height,\n    style: {\n      fill: \"#fff3cd\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight1.position({\n    relativeFrom: highlight1.topLeft,\n    relativeTo: { x: elem1.topLeft.x, y: elem1.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight1);\n}\n\ncurrentY += 50;\n\nconst latex2 = new Latex({\n  content: \"\\\\class{variable}{x}^2 + \\\\class{variable}{y}^2 = \\\\class{variable}{z}^2\",\n  fontSize: 26,\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex2.position({\n  relativeFrom: latex2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex2);\n\nconst vars2 = latex2.getElementsByClass(\"variable\");\n\nvars2.forEach((v, idx) => {\n  const highlight = new Rect({\n    width: v.bbox.width,\n    height: v.bbox.height,\n    style: {\n      fill: \"#d1ecf1\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: v.topLeft.x, y: v.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n});\n\ncurrentY += 50;\n\nconst latex3 = new Latex({\n  content: \"x = \\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}\",\n  fontSize: 36,\n  displayMode: true, // Display mode for larger, centered formula\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex3.position({\n  relativeFrom: latex3.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex3);\n\nconst annotations = [\n  { id: \"coef-b\", color: \"#fff3cd\", stroke: \"#856404\" },\n  { id: \"discriminant\", color: \"#f8d7da\", stroke: \"#721c24\" },\n  { id: \"denominator\", color: \"#d4edda\", stroke: \"#155724\" },\n];\n\nannotations.forEach(({ id, color, stroke }) => {\n  const elem = latex3.getElementById(id);\n  if (elem) {\n    const highlight = new Rect({\n      width: elem.bbox.width,\n      height: elem.bbox.height,\n      style: {\n        fill: color,\n        opacity: 0.5,\n      },\n    });\n\n    highlight.position({\n      relativeFrom: highlight.topLeft,\n      relativeTo: { x: elem.topLeft.x, y: elem.topLeft.y },\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(highlight);\n  }\n});\n\ncurrentY += 80;\n\n\nconst sectionTitle2 = new Text({\n  content: \"2. Text with embedded LaTeX (Text mixing)\",\n  fontSize: 20,\n  fontFamily: \"Arial\",\n  fontWeight: \"bold\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nsectionTitle2.position({\n  relativeFrom: sectionTitle2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(sectionTitle2);\ncurrentY += 40;\n\nconst text1 = new Text({\n  content: \"Einstein's equation $E = \\\\cssId{mass-energy-2}{mc^2}$ is famous.\",\n  fontSize: 24,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext1.position({\n  relativeFrom: text1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text1);\n\nconst textDebugRect1 = new Rect({\n  width: text1.textWidth,\n  height: text1.textHeight,\n  style: {\n    fill: \"none\",\n    stroke: \"red\",\n    strokeWidth: 1,\n    opacity: 0.7,\n  },\n});\ntextDebugRect1.position({\n  relativeFrom: textDebugRect1.topLeft,\n  relativeTo: text1.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(textDebugRect1);\n\nconst latexSegments1 = text1.getLatexSegmentBBoxes();\nconsole.log(\"\\n=== TEXT 1: Einstein's equation ===\");\nconsole.log(\"Text position:\", text1.topLeft);\nconsole.log(\"LaTeX segments:\", latexSegments1);\n\nlatexSegments1.forEach((segment) => {\n  const latexDebugRect = new Rect({\n    width: segment.width,\n    height: segment.height,\n    style: {\n      fill: \"none\",\n      stroke: \"blue\",\n      strokeWidth: 1,\n      strokeDasharray: \"3,3\",\n      opacity: 0.7,\n    },\n  });\n  latexDebugRect.position({\n    relativeFrom: latexDebugRect.topLeft,\n    relativeTo: artboard.topLeft,\n    x: segment.x,\n    y: segment.y,\n  });\n  artboard.addElement(latexDebugRect);\n});\n\nconst elem2 = text1.getElementById(\"mass-energy-2\");\nif (elem2) {\n  console.log(\"\\nAnnotated element 'mass-energy-2':\");\n  console.log(\"  bbox:\", elem2.bbox);\n  console.log(\"  topLeft:\", elem2.topLeft);\n  console.log(\"  Relative to text:\", { x: elem2.topLeft.x - text1.topLeft.x, y: elem2.topLeft.y - text1.topLeft.y });\n  \n  const highlight2 = new Rect({\n    width: elem2.bbox.width,\n    height: elem2.bbox.height,\n    style: {\n      fill: \"#fff3cd\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight2.position({\n    relativeFrom: highlight2.topLeft,\n    relativeTo: { x: elem2.topLeft.x, y: elem2.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight2);\n}\n\ncurrentY += 50;\n\nconst text2 = new Text({\n  content: \"Pythagorean theorem: $\\\\class{variable2}{x}^2 + \\\\class{variable2}{y}^2 = \\\\class{variable2}{z}^2$\",\n  fontSize: 22,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext2.position({\n  relativeFrom: text2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text2);\n\nconst textDebugRect2 = new Rect({\n  width: text2.textWidth,\n  height: text2.textHeight,\n  style: {\n    fill: \"none\",\n    stroke: \"red\",\n    strokeWidth: 1,\n    opacity: 0.7,\n  },\n});\ntextDebugRect2.position({\n  relativeFrom: textDebugRect2.topLeft,\n  relativeTo: text2.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(textDebugRect2);\n\nconst latexSegments2 = text2.getLatexSegmentBBoxes();\nconsole.log(\"\\n=== TEXT 2: Pythagorean theorem ===\");\nconsole.log(\"Text position:\", text2.topLeft);\nconsole.log(\"LaTeX segments:\", latexSegments2);\n\nlatexSegments2.forEach((segment) => {\n  const latexDebugRect = new Rect({\n    width: segment.width,\n    height: segment.height,\n    style: {\n      fill: \"none\",\n      stroke: \"blue\",\n      strokeWidth: 1,\n      strokeDasharray: \"3,3\",\n      opacity: 0.7,\n    },\n  });\n  latexDebugRect.position({\n    relativeFrom: latexDebugRect.topLeft,\n    relativeTo: artboard.topLeft,\n    x: segment.x,\n    y: segment.y,\n  });\n  artboard.addElement(latexDebugRect);\n});\n\nconst vars3 = text2.getElementsByClass(\"variable2\");\n\nconsole.log(\"\\nAnnotated elements with class 'variable2':\");\nvars3.forEach((v, idx) => {\n  console.log(`  [${idx}]:`, {\n    bbox: v.bbox,\n    topLeft: v.topLeft,\n    relativeToText: { x: v.topLeft.x - text2.topLeft.x, y: v.topLeft.y - text2.topLeft.y }\n  });\n  \n  const highlight = new Rect({\n    width: v.bbox.width,\n    height: v.bbox.height,\n    style: {\n      fill: \"#d1ecf1\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: v.topLeft.x, y: v.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n});\n\ncurrentY += 50;\n\nconst text3 = new Text({\n  content: \"Quadratic formula: $x = \\\\frac{-\\\\cssId{coef-b-2}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant-2}{b^2-4ac}}}{\\\\cssId{denominator-2}{2a}}$\",\n  fontSize: 22,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext3.position({\n  relativeFrom: text3.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text3);\n\nconst annotations2 = [\n  { id: \"coef-b-2\", color: \"#fff3cd\", stroke: \"#856404\" },\n  { id: \"discriminant-2\", color: \"#f8d7da\", stroke: \"#721c24\" },\n  { id: \"denominator-2\", color: \"#d4edda\", stroke: \"#155724\" },\n];\n\nannotations2.forEach(({ id, color, stroke }) => {\n  const elem = text3.getElementById(id);\n  if (elem) {\n    const highlight = new Rect({\n      width: elem.bbox.width,\n      height: elem.bbox.height,\n      style: {\n        fill: color,\n        opacity: 0.5,\n      },\n    });\n\n    highlight.position({\n      relativeFrom: highlight.topLeft,\n      relativeTo: { x: elem.topLeft.x, y: elem.topLeft.y },\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(highlight);\n  }\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design an artboard with a light background and place several sections of text and equations. Start with a bold header followed by a mathematical equation in a larger font. Highlight certain parts of this equation with some soft colors. Below, add another equation and emphasize some key variables with light shades. Include a larger formula with various highlighted elements in different colors. Continue with another header and incorporate sentences that contain embedded equations. Use highlights to draw attention to specific parts of these equations. Finally, make sure to enclose certain elements with visible outlines to distinguish them."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 900,\n  height: 1200,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 0 },\n});\n\nlet currentY = 50;\n\n\nconst sectionTitle1 = new Text({\n  content: \"1. Pure Latex (No text mixing)\",\n  fontSize: 20,\n  fontFamily: \"Arial\",\n  fontWeight: \"bold\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nsectionTitle1.position({\n  relativeFrom: sectionTitle1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(sectionTitle1);\ncurrentY += 40;\n\nconst latex1 = new Latex({\n  content: \"E = \\\\cssId{mass-energy}{mc^2}\",\n  fontSize: 28,\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex1.position({\n  relativeFrom: latex1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex1);\n\nconst elem1 = latex1.getElementById(\"mass-energy\");\nif (elem1) {\n  const highlight1 = new Rect({\n    width: elem1.bbox.width,\n    height: elem1.bbox.height,\n    style: {\n      fill: \"#fff3cd\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight1.position({\n    relativeFrom: highlight1.topLeft,\n    relativeTo: { x: elem1.topLeft.x, y: elem1.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight1);\n}\n\ncurrentY += 50;\n\nconst latex2 = new Latex({\n  content: \"\\\\class{variable}{x}^2 + \\\\class{variable}{y}^2 = \\\\class{variable}{z}^2\",\n  fontSize: 26,\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex2.position({\n  relativeFrom: latex2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex2);\n\nconst vars2 = latex2.getElementsByClass(\"variable\");\n\nvars2.forEach((v, idx) => {\n  const highlight = new Rect({\n    width: v.bbox.width,\n    height: v.bbox.height,\n    style: {\n      fill: \"#d1ecf1\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: v.topLeft.x, y: v.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n});\n\ncurrentY += 50;\n\nconst latex3 = new Latex({\n  content: \"x = \\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}\",\n  fontSize: 36,\n  displayMode: true, // Display mode for larger, centered formula\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nlatex3.position({\n  relativeFrom: latex3.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(latex3);\n\nconst annotations = [\n  { id: \"coef-b\", color: \"#fff3cd\", stroke: \"#856404\" },\n  { id: \"discriminant\", color: \"#f8d7da\", stroke: \"#721c24\" },\n  { id: \"denominator\", color: \"#d4edda\", stroke: \"#155724\" },\n];\n\nannotations.forEach(({ id, color, stroke }) => {\n  const elem = latex3.getElementById(id);\n  if (elem) {\n    const highlight = new Rect({\n      width: elem.bbox.width,\n      height: elem.bbox.height,\n      style: {\n        fill: color,\n        opacity: 0.5,\n      },\n    });\n\n    highlight.position({\n      relativeFrom: highlight.topLeft,\n      relativeTo: { x: elem.topLeft.x, y: elem.topLeft.y },\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(highlight);\n  }\n});\n\ncurrentY += 80;\n\n\nconst sectionTitle2 = new Text({\n  content: \"2. Text with embedded LaTeX (Text mixing)\",\n  fontSize: 20,\n  fontFamily: \"Arial\",\n  fontWeight: \"bold\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\nsectionTitle2.position({\n  relativeFrom: sectionTitle2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(sectionTitle2);\ncurrentY += 40;\n\nconst text1 = new Text({\n  content: \"Einstein's equation $E = \\\\cssId{mass-energy-2}{mc^2}$ is famous.\",\n  fontSize: 24,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext1.position({\n  relativeFrom: text1.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text1);\n\nconst textDebugRect1 = new Rect({\n  width: text1.textWidth,\n  height: text1.textHeight,\n  style: {\n    fill: \"none\",\n    stroke: \"red\",\n    strokeWidth: 1,\n    opacity: 0.7,\n  },\n});\ntextDebugRect1.position({\n  relativeFrom: textDebugRect1.topLeft,\n  relativeTo: text1.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(textDebugRect1);\n\nconst latexSegments1 = text1.getLatexSegmentBBoxes();\nconsole.log(\"\\n=== TEXT 1: Einstein's equation ===\");\nconsole.log(\"Text position:\", text1.topLeft);\nconsole.log(\"LaTeX segments:\", latexSegments1);\n\nlatexSegments1.forEach((segment) => {\n  const latexDebugRect = new Rect({\n    width: segment.width,\n    height: segment.height,\n    style: {\n      fill: \"none\",\n      stroke: \"blue\",\n      strokeWidth: 1,\n      strokeDasharray: \"3,3\",\n      opacity: 0.7,\n    },\n  });\n  latexDebugRect.position({\n    relativeFrom: latexDebugRect.topLeft,\n    relativeTo: artboard.topLeft,\n    x: segment.x,\n    y: segment.y,\n  });\n  artboard.addElement(latexDebugRect);\n});\n\nconst elem2 = text1.getElementById(\"mass-energy-2\");\nif (elem2) {\n  console.log(\"\\nAnnotated element 'mass-energy-2':\");\n  console.log(\"  bbox:\", elem2.bbox);\n  console.log(\"  topLeft:\", elem2.topLeft);\n  console.log(\"  Relative to text:\", { x: elem2.topLeft.x - text1.topLeft.x, y: elem2.topLeft.y - text1.topLeft.y });\n  \n  const highlight2 = new Rect({\n    width: elem2.bbox.width,\n    height: elem2.bbox.height,\n    style: {\n      fill: \"#fff3cd\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight2.position({\n    relativeFrom: highlight2.topLeft,\n    relativeTo: { x: elem2.topLeft.x, y: elem2.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight2);\n}\n\ncurrentY += 50;\n\nconst text2 = new Text({\n  content: \"Pythagorean theorem: $\\\\class{variable2}{x}^2 + \\\\class{variable2}{y}^2 = \\\\class{variable2}{z}^2$\",\n  fontSize: 22,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext2.position({\n  relativeFrom: text2.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text2);\n\nconst textDebugRect2 = new Rect({\n  width: text2.textWidth,\n  height: text2.textHeight,\n  style: {\n    fill: \"none\",\n    stroke: \"red\",\n    strokeWidth: 1,\n    opacity: 0.7,\n  },\n});\ntextDebugRect2.position({\n  relativeFrom: textDebugRect2.topLeft,\n  relativeTo: text2.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(textDebugRect2);\n\nconst latexSegments2 = text2.getLatexSegmentBBoxes();\nconsole.log(\"\\n=== TEXT 2: Pythagorean theorem ===\");\nconsole.log(\"Text position:\", text2.topLeft);\nconsole.log(\"LaTeX segments:\", latexSegments2);\n\nlatexSegments2.forEach((segment) => {\n  const latexDebugRect = new Rect({\n    width: segment.width,\n    height: segment.height,\n    style: {\n      fill: \"none\",\n      stroke: \"blue\",\n      strokeWidth: 1,\n      strokeDasharray: \"3,3\",\n      opacity: 0.7,\n    },\n  });\n  latexDebugRect.position({\n    relativeFrom: latexDebugRect.topLeft,\n    relativeTo: artboard.topLeft,\n    x: segment.x,\n    y: segment.y,\n  });\n  artboard.addElement(latexDebugRect);\n});\n\nconst vars3 = text2.getElementsByClass(\"variable2\");\n\nconsole.log(\"\\nAnnotated elements with class 'variable2':\");\nvars3.forEach((v, idx) => {\n  console.log(`  [${idx}]:`, {\n    bbox: v.bbox,\n    topLeft: v.topLeft,\n    relativeToText: { x: v.topLeft.x - text2.topLeft.x, y: v.topLeft.y - text2.topLeft.y }\n  });\n  \n  const highlight = new Rect({\n    width: v.bbox.width,\n    height: v.bbox.height,\n    style: {\n      fill: \"#d1ecf1\",\n      opacity: 0.5,\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: v.topLeft.x, y: v.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n});\n\ncurrentY += 50;\n\nconst text3 = new Text({\n  content: \"Quadratic formula: $x = \\\\frac{-\\\\cssId{coef-b-2}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant-2}{b^2-4ac}}}{\\\\cssId{denominator-2}{2a}}$\",\n  fontSize: 22,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#2c3e50\",\n  },\n});\n\ntext3.position({\n  relativeFrom: text3.topLeft,\n  relativeTo: artboard.topLeft,\n  x: 50,\n  y: currentY,\n});\n\nartboard.addElement(text3);\n\nconst annotations2 = [\n  { id: \"coef-b-2\", color: \"#fff3cd\", stroke: \"#856404\" },\n  { id: \"discriminant-2\", color: \"#f8d7da\", stroke: \"#721c24\" },\n  { id: \"denominator-2\", color: \"#d4edda\", stroke: \"#155724\" },\n];\n\nannotations2.forEach(({ id, color, stroke }) => {\n  const elem = text3.getElementById(id);\n  if (elem) {\n    const highlight = new Rect({\n      width: elem.bbox.width,\n      height: elem.bbox.height,\n      style: {\n        fill: color,\n        opacity: 0.5,\n      },\n    });\n\n    highlight.position({\n      relativeFrom: highlight.topLeft,\n      relativeTo: { x: elem.topLeft.x, y: elem.topLeft.y },\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(highlight);\n  }\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a diagram with three vertical columns in a horizontal layout. The background should be light gray. The first column has three math equations in blue: Einstein's energy equation, the quadratic formula, and Euler's identity. Highlight specific parts of these equations with pink for 'E', green for 'm', light blue for 'c', yellow for 'b', green for the discriminant, and light blue for the denominator. The second column contains four textual descriptions with embedded math, in purple, explaining famous equations and concepts such as Einstein's equation, Pythagorean theorem, derivatives, and complex numbers. Highlight specific parts of these equations with yellow, green, and light blue. The last column contains plain text instructions in green, highlighting aspects of text elements. Make sure the text is in Georgia font with varying sizes and the layout is neat and aligned."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Rect,\n  Text,\n  Latex,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",     // Align columns to top (default, shown for clarity)\n  horizontalAlignment: \"left\",  // Align content to left (default, shown for clarity)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst column1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#90caf9\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column1);\n\nconst latex1 = new Latex({\n  content: \"\\\\cssId{energy}{E} = \\\\cssId{mass}{m}\\\\cssId{speed}{c}^2\",\n  fontSize: 32,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex1);\n\nconst latex2 = new Latex({\n  content: \"\\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}\",\n  fontSize: 28,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex2);\n\nconst latex3 = new Latex({\n  content: \"\\\\class{euler-const}{e}^{\\\\class{euler-const}{i\\\\pi}} + \\\\class{euler-const}{1} = \\\\class{euler-const}{0}\",\n  fontSize: 30,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex3);\n\n\nconst column2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#ce93d8\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column2);\n\nconst mixedText1 = new Text({\n  content: \"Einstein's equation $\\\\cssId{mass-energy}{E = mc^2}$ is famous.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText1);\n\nconst mixedText2 = new Text({\n  content: \"The theorem $\\\\class{pyth-var}{a}^2 + \\\\class{pyth-var}{b}^2 = \\\\class{pyth-var}{c}^2$ for right triangles.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText2);\n\nconst mixedText3 = new Text({\n  content: \"Calculate $\\\\cssId{derivative}{\\\\frac{df}{dx}}$ for any function $\\\\cssId{func}{f(x)}$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText3);\n\nconst mixedText4 = new Text({\n  content: \"Complex: $\\\\class{complex-part}{a} + \\\\class{complex-part}{b}\\\\class{complex-part}{i}$ where $i^2 = -1$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText4);\n\n\nconst column3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#a5d6a7\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column3);\n\nconst textContainer3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n});\n\nconst text1 = new Text({\n  content: \"Pure text elements are simple and clean.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text1);\n\nconst text2 = new Text({\n  content: \"They support multiple lines and different font sizes.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text2);\n\nconst text3 = new Text({\n  content: \"Containers auto-size to fit their content.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text3);\n\nconst text4 = new Text({\n  content: \"This creates flexible layouts.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text4);\n\nconst text5 = new Text({\n  content: \"Perfect for documents and diagrams!\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  fontWeight: 600,\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text5);\n\ncolumn3.addElement(textContainer3);\n\n\nfunction addHighlight(element, color) {\n  const highlight = new Rect({\n    width: element.bbox.width,\n    height: element.bbox.height,\n    style: {\n      fill: color,\n      opacity: 0.5,\n    },\n  });\n  \n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: element.topLeft.x, y: element.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(highlight);\n}\n\nconst energy = latex1.getElementById(\"energy\");\nif (energy) addHighlight(energy, \"#f8d7da\");\n\nconst mass = latex1.getElementById(\"mass\");\nif (mass) addHighlight(mass, \"#d4edda\");\n\nconst speed = latex1.getElementById(\"speed\");\nif (speed) addHighlight(speed, \"#d1ecf1\");\n\nconst coefB = latex2.getElementById(\"coef-b\");\nif (coefB) addHighlight(coefB, \"#fff3cd\");\n\nconst disc = latex2.getElementById(\"discriminant\");\nif (disc) addHighlight(disc, \"#d4edda\");\n\nconst denom = latex2.getElementById(\"denominator\");\nif (denom) addHighlight(denom, \"#d1ecf1\");\n\nconst eulerConsts = latex3.getElementsByClass(\"euler-const\");\nconst eulerColors = [\"#e7d4f7\", \"#c3e7ff\", \"#ffe7c3\", \"#c3ffd4\"];\neulerConsts.forEach((elem, idx) => {\n  addHighlight(elem, eulerColors[idx % eulerColors.length]);\n});\n\nconst massEnergy = mixedText1.getElementById(\"mass-energy\");\nif (massEnergy) addHighlight(massEnergy, \"#fff3cd\");\n\nconst pythVars = mixedText2.getElementsByClass(\"pyth-var\");\npythVars.forEach((v) => addHighlight(v, \"#d4edda\"));\n\nconst derivative = mixedText3.getElementById(\"derivative\");\nif (derivative) addHighlight(derivative, \"#d1ecf1\");\n\nconst func = mixedText3.getElementById(\"func\");\nif (func) addHighlight(func, \"#f8d7da\");\n\nconst complexParts = mixedText4.getElementsByClass(\"complex-part\");\nconst complexColors = [\"#e7d4f7\", \"#ffe7c3\", \"#c3ffd4\"];\ncomplexParts.forEach((part, idx) => {\n  addHighlight(part, complexColors[idx % complexColors.length]);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a visual layout with several sections of equations and text. Include some columns with mathematical formulas and others with explanatory text. Use different colors to distinguish and highlight key parts of the formulas or important concepts. Arrange everything in a visually appealing and organized manner, ensuring that the overall design is clean and readable. Use a mix of fonts and sizes for variety and clarity."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Rect,\n  Text,\n  Latex,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",     // Align columns to top (default, shown for clarity)\n  horizontalAlignment: \"left\",  // Align content to left (default, shown for clarity)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst column1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#90caf9\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column1);\n\nconst latex1 = new Latex({\n  content: \"\\\\cssId{energy}{E} = \\\\cssId{mass}{m}\\\\cssId{speed}{c}^2\",\n  fontSize: 32,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex1);\n\nconst latex2 = new Latex({\n  content: \"\\\\frac{-\\\\cssId{coef-b}{b} \\\\pm \\\\sqrt{\\\\cssId{discriminant}{b^2-4ac}}}{\\\\cssId{denominator}{2a}}\",\n  fontSize: 28,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex2);\n\nconst latex3 = new Latex({\n  content: \"\\\\class{euler-const}{e}^{\\\\class{euler-const}{i\\\\pi}} + \\\\class{euler-const}{1} = \\\\class{euler-const}{0}\",\n  fontSize: 30,\n  displayMode: true,\n  style: {\n    fill: \"#1976d2\",\n  },\n});\ncolumn1.addElement(latex3);\n\n\nconst column2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#ce93d8\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column2);\n\nconst mixedText1 = new Text({\n  content: \"Einstein's equation $\\\\cssId{mass-energy}{E = mc^2}$ is famous.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText1);\n\nconst mixedText2 = new Text({\n  content: \"The theorem $\\\\class{pyth-var}{a}^2 + \\\\class{pyth-var}{b}^2 = \\\\class{pyth-var}{c}^2$ for right triangles.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText2);\n\nconst mixedText3 = new Text({\n  content: \"Calculate $\\\\cssId{derivative}{\\\\frac{df}{dx}}$ for any function $\\\\cssId{func}{f(x)}$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText3);\n\nconst mixedText4 = new Text({\n  content: \"Complex: $\\\\class{complex-part}{a} + \\\\class{complex-part}{b}\\\\class{complex-part}{i}$ where $i^2 = -1$.\",\n  fontSize: 20,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#7b1fa2\",\n  },\n});\ncolumn2.addElement(mixedText4);\n\n\nconst column3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"left\",  // Align items to left (default)\n  verticalAlignment: \"top\",     // Stack items from top (default)\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#a5d6a7\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column3);\n\nconst textContainer3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n});\n\nconst text1 = new Text({\n  content: \"Pure text elements are simple and clean.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text1);\n\nconst text2 = new Text({\n  content: \"They support multiple lines and different font sizes.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text2);\n\nconst text3 = new Text({\n  content: \"Containers auto-size to fit their content.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text3);\n\nconst text4 = new Text({\n  content: \"This creates flexible layouts.\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text4);\n\nconst text5 = new Text({\n  content: \"Perfect for documents and diagrams!\",\n  fontSize: 18,\n  fontFamily: \"Georgia\",\n  fontWeight: 600,\n  style: {\n    fill: \"#388e3c\",\n  },\n});\ntextContainer3.addElement(text5);\n\ncolumn3.addElement(textContainer3);\n\n\nfunction addHighlight(element, color) {\n  const highlight = new Rect({\n    width: element.bbox.width,\n    height: element.bbox.height,\n    style: {\n      fill: color,\n      opacity: 0.5,\n    },\n  });\n  \n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: { x: element.topLeft.x, y: element.topLeft.y },\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(highlight);\n}\n\nconst energy = latex1.getElementById(\"energy\");\nif (energy) addHighlight(energy, \"#f8d7da\");\n\nconst mass = latex1.getElementById(\"mass\");\nif (mass) addHighlight(mass, \"#d4edda\");\n\nconst speed = latex1.getElementById(\"speed\");\nif (speed) addHighlight(speed, \"#d1ecf1\");\n\nconst coefB = latex2.getElementById(\"coef-b\");\nif (coefB) addHighlight(coefB, \"#fff3cd\");\n\nconst disc = latex2.getElementById(\"discriminant\");\nif (disc) addHighlight(disc, \"#d4edda\");\n\nconst denom = latex2.getElementById(\"denominator\");\nif (denom) addHighlight(denom, \"#d1ecf1\");\n\nconst eulerConsts = latex3.getElementsByClass(\"euler-const\");\nconst eulerColors = [\"#e7d4f7\", \"#c3e7ff\", \"#ffe7c3\", \"#c3ffd4\"];\neulerConsts.forEach((elem, idx) => {\n  addHighlight(elem, eulerColors[idx % eulerColors.length]);\n});\n\nconst massEnergy = mixedText1.getElementById(\"mass-energy\");\nif (massEnergy) addHighlight(massEnergy, \"#fff3cd\");\n\nconst pythVars = mixedText2.getElementsByClass(\"pyth-var\");\npythVars.forEach((v) => addHighlight(v, \"#d4edda\"));\n\nconst derivative = mixedText3.getElementById(\"derivative\");\nif (derivative) addHighlight(derivative, \"#d1ecf1\");\n\nconst func = mixedText3.getElementById(\"func\");\nif (func) addHighlight(func, \"#f8d7da\");\n\nconst complexParts = mixedText4.getElementsByClass(\"complex-part\");\nconst complexColors = [\"#e7d4f7\", \"#ffe7c3\", \"#c3ffd4\"];\ncomplexParts.forEach((part, idx) => {\n  addHighlight(part, complexColors[idx % complexColors.length]);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a design with a dark background artboard that has a padding of 40 pixels. Inside, place a horizontal container with a top alignment and 30 pixels of spacing between its elements. The container should have a dark blue fill with a light blue stroke of 3 pixels and a 3-pixel border on all sides with 20 pixels of padding each side. Add three vertical columns inside this container, each centered horizontally with 20 pixels of spacing between items. Each column should have a dark blue fill with a red stroke of 2 pixels, and should be padded by 20 pixels with a 2-pixel border."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#1a1a2e\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\", // Align children to top\n  boxModel: {\n    padding: { top: 20, right: 20, bottom: 20, left: 20 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#16213e\",\n    stroke: \"#0f3460\",\n    strokeWidth: 3,\n  },\n});\n\nartboard.addElement(mainContainer);\n\nconst column1 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column1);\n\nconst column2 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column2);\n\nconst column3 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column3);\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a dark-themed artboard that contains a few vertically aligned sections. Use some padding and borders to separate elements. Arrange these sections horizontally with some spacing between them, making sure they are aligned to the top. Keep the color palette consistent with shades of blue and some contrasting strokes."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#1a1a2e\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\", // Align children to top\n  boxModel: {\n    padding: { top: 20, right: 20, bottom: 20, left: 20 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#16213e\",\n    stroke: \"#0f3460\",\n    strokeWidth: 3,\n  },\n});\n\nartboard.addElement(mainContainer);\n\nconst column1 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column1);\n\nconst column2 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column2);\n\nconst column3 = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(column3);\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a dark blue background. Add a horizontal container at the top with three vertical sections inside it. The main container should have a padding of 20 pixels on all sides and a border of 3 pixels in a dark blue shade. Each section should have a dark blue fill and a red border, with different border widths and paddings. The sections should be spaced 30 pixels apart. Center the contents of each section horizontally, and ensure the entire setup is padded neatly within the artboard."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Columns,\n  Grid,\n  Rect,\n  Circle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#1a1a2e\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\", // Align children to top\n  boxModel: {\n    padding: { top: 20, right: 20, bottom: 20, left: 20 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#16213e\",\n    stroke: \"#0f3460\",\n    strokeWidth: 3,\n  },\n});\n\nconst leftSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(leftSection);\n\nconst middleSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n  boxModel: {\n    padding: { top: 25, right: 25, bottom: 25, left: 25 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 3,\n  },\n});\n\nmainContainer.addElement(middleSection);\n\nconst rightSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(rightSection);\n\nartboard.addElement(mainContainer);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a layout with a background that has a dark tone. Include a few vertical columns aligned horizontally at the top, each with some space between them. Make sure the columns have a consistent style, and arrange them so that all contents are aligned neatly with some padding. Use contrasting colors for the borders and make sure everything fits nicely within the layout."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Columns,\n  Grid,\n  Rect,\n  Circle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#1a1a2e\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\", // Align children to top\n  boxModel: {\n    padding: { top: 20, right: 20, bottom: 20, left: 20 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#16213e\",\n    stroke: \"#0f3460\",\n    strokeWidth: 3,\n  },\n});\n\nconst leftSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\", // Center children horizontally\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(leftSection);\n\nconst middleSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n  boxModel: {\n    padding: { top: 25, right: 25, bottom: 25, left: 25 },\n    border: { top: 3, right: 3, bottom: 3, left: 3 },\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 3,\n  },\n});\n\nmainContainer.addElement(middleSection);\n\nconst rightSection = new Container({\n  width: \"auto\", // Auto-size to content\n  height: \"auto\", // Auto-size to content\n  direction: \"vertical\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n  boxModel: {\n    padding: 20,\n    border: 2,\n  },\n  style: {\n    fill: \"#0f3460\",\n    stroke: \"#e94560\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(rightSection);\n\nartboard.addElement(mainContainer);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual representation containing a large title 'Function Graph Examples - K-12 & University Mathematics' at the top, followed by a description about function plotting with automatic remarkable point detection like roots and asymptotes. Below, arrange three columns. In the first column, show a quadratic function graph with a title 'Quadratic Function' and note its roots if any, an exponential and logarithmic graph with distinct colors, and a graph for absolute value functions. In the second column, include trigonometric function graphs for sine and cosine, a rational function with an asymptote note, and a quintic polynomial graph highlighting inflection points. In the third column, depict a cubic polynomial with extrema notes, a piecewise function graph, and a damped oscillation graph labeled as 'Exponentially damped sine wave.' Ensure each graph is 360x280 pixels, and use colors like #e74c3c for quadratic and #e84393 for rational function graphs."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Circle,\n  Columns,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainTitle = new Text({\n  content: \"Function Graph Examples - K-12 & University Mathematics\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainTitle.position({\n  relativeFrom: mainTitle.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainTitle);\n\nconst description = new Text({\n  content:\n    \"Demonstrating function plotting with automatic remarkable point detection (roots, extrema, inflection points, asymptotes)\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 1200,\n  textAlign: \"center\",\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: mainTitle.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 400,\n  height: \"auto\",\n  gutter: 30,\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n  columnSpacing: 20,\n  boxModel: { padding: 20 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(columns.container);\n\nconst quadraticTitle = new Text({\n  content: \"Quadratic Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst quadraticGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#e74c3c\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 5],\n  debug: false,\n});\n\nconst quadRoots = quadraticGraph.getRemarkablePoints(\"root\");\nconst quadNote = new Text({\n  content: quadRoots.length > 0 \n    ? `Roots: x = ${quadRoots.map(r => r.x.toFixed(2)).join(\", \")}`\n    : \"No roots found\",\n  fontSize: 11,\n  style: { fill: \"#c0392b\" },\n});\n\nconst col1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol1Container.addElement(quadraticTitle);\ncol1Container.addElement(quadraticGraph);\ncol1Container.addElement(quadNote);\n\ncolumns.getColumn(0).addElement(col1Container);\n\nconst trigTitle = new Text({\n  content: \"Trigonometric Functions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst trigGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.sin(x),\n      color: \"#3498db\",\n    },\n    {\n      fn: (x) => Math.cos(x),\n      color: \"#2ecc71\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [-2 * Math.PI, 2 * Math.PI],\n  range: [-1.5, 1.5],\n  debug: false,\n});\n\nconst col2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol2Container.addElement(trigTitle);\ncol2Container.addElement(trigGraph);\n\ncolumns.getColumn(1).addElement(col2Container);\n\nconst cubicTitle = new Text({\n  content: \"Cubic Polynomial\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst cubicGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => (x + 3) * (x - 1) * (x - 4) / 4,\n    color: \"#e67e22\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 6],\n  debug: false,\n});\n\nconst maxima = cubicGraph.getRemarkablePoints(\"local-maximum\");\nconst minima = cubicGraph.getRemarkablePoints(\"local-minimum\");\nconst extremaNote = new Text({\n  content: `Extrema detected: ${maxima.length} max, ${minima.length} min`,\n  fontSize: 11,\n  style: { fill: \"#e67e22\" },\n});\n\nconst col3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol3Container.addElement(cubicTitle);\ncol3Container.addElement(cubicGraph);\ncol3Container.addElement(extremaNote);\n\ncolumns.getColumn(2).addElement(col3Container);\n\n\nconst expLogTitle = new Text({\n  content: \"Exponential & Logarithmic\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst expLogGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.exp(x / 2),\n      color: \"#1abc9c\",\n    },\n    {\n      fn: (x) => Math.log(x),\n      color: \"#34495e\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [0.1, 5],\n  range: [-2, 6],\n  debug: false,\n});\n\nconst col4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol4Container.addElement(expLogTitle);\ncol4Container.addElement(expLogGraph);\n\ncolumns.getColumn(0).addElement(col4Container);\n\nconst rationalTitle = new Text({\n  content: \"Rational Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst rationalGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => 1 / (x - 2),\n    color: \"#e84393\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-3, 7],\n  range: [-5, 5],\n  debug: false,\n});\n\nconst asymptotes = rationalGraph.getRemarkablePoints(\"vertical-asymptote\");\nconst asymNote = new Text({\n  content: asymptotes.length > 0 \n    ? `Asymptote at x = ${asymptotes[0].x.toFixed(1)}`\n    : \"No asymptotes found\",\n  fontSize: 11,\n  style: { fill: \"#d63031\" },\n});\n\nconst col5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol5Container.addElement(rationalTitle);\ncol5Container.addElement(rationalGraph);\ncol5Container.addElement(asymNote);\n\ncolumns.getColumn(1).addElement(col5Container);\n\nconst piecewiseTitle = new Text({\n  content: \"Piecewise Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst piecewiseGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => {\n      if (x < -1) return x + 2;\n      if (x < 1) return x * x;\n      return 2 - x;\n    },\n    color: \"#6c5ce7\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-4, 4],\n  debug: false,\n});\n\nconst col6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol6Container.addElement(piecewiseTitle);\ncol6Container.addElement(piecewiseGraph);\n\ncolumns.getColumn(2).addElement(col6Container);\n\n\nconst absValueTitle = new Text({\n  content: \"Absolute Value Functions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst absValueGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.abs(x),\n      color: \"#00b894\",\n    },\n    {\n      fn: (x) => -Math.abs(x - 2) + 3,\n      color: \"#ff7675\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [-5, 7],\n  debug: false,\n});\n\nconst col7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol7Container.addElement(absValueTitle);\ncol7Container.addElement(absValueGraph);\n\ncolumns.getColumn(0).addElement(col7Container);\n\nconst quinticTitle = new Text({\n  content: \"Quintic Polynomial\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst quinticGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => 0.01 * x ** 5 - 0.1 * x ** 3 + x,\n    color: \"#fd79a8\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 5],\n  debug: false,\n});\n\nconst inflectionPoints = quinticGraph.getRemarkablePoints(\"inflection-point\");\nconst inflectionNote = new Text({\n  content: `${inflectionPoints.length} inflection points detected`,\n  fontSize: 11,\n  style: { fill: \"#fd79a8\" },\n});\n\nconst col8Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol8Container.addElement(quinticTitle);\ncol8Container.addElement(quinticGraph);\ncol8Container.addElement(inflectionNote);\n\ncolumns.getColumn(1).addElement(col8Container);\n\nconst sineWaveTitle = new Text({\n  content: \"Damped Oscillation\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst sineWaveGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => Math.sin(2 * x) * Math.exp(-x / 5),\n    color: \"#a29bfe\",\n  },\n  width: 360,\n  height: 280,\n  domain: [0, 10],\n  debug: false,\n});\n\nconst dampedNote = new Text({\n  content: \"Exponentially damped sine wave\",\n  fontSize: 11,\n  style: { fill: \"#6c5ce7\" },\n});\n\nconst col9Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol9Container.addElement(sineWaveTitle);\ncol9Container.addElement(sineWaveGraph);\ncol9Container.addElement(dampedNote);\n\ncolumns.getColumn(2).addElement(col9Container);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a series of mathematical function graphs showcasing various types of functions such as polynomial, trigonometric, logarithmic, and piecewise. Organize them into several columns, each containing a few graphs. Add titles and brief notes highlighting key features like roots or extrema for some graphs. Use different colors for each function to distinguish them visually, and ensure all graphs are of uniform size. Include a main title and a brief description at the top to introduce the visual layout."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Circle,\n  Columns,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainTitle = new Text({\n  content: \"Function Graph Examples - K-12 & University Mathematics\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainTitle.position({\n  relativeFrom: mainTitle.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainTitle);\n\nconst description = new Text({\n  content:\n    \"Demonstrating function plotting with automatic remarkable point detection (roots, extrema, inflection points, asymptotes)\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 1200,\n  textAlign: \"center\",\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: mainTitle.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 400,\n  height: \"auto\",\n  gutter: 30,\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n  columnSpacing: 20,\n  boxModel: { padding: 20 },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(columns.container);\n\nconst quadraticTitle = new Text({\n  content: \"Quadratic Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst quadraticGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#e74c3c\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 5],\n  debug: false,\n});\n\nconst quadRoots = quadraticGraph.getRemarkablePoints(\"root\");\nconst quadNote = new Text({\n  content: quadRoots.length > 0 \n    ? `Roots: x = ${quadRoots.map(r => r.x.toFixed(2)).join(\", \")}`\n    : \"No roots found\",\n  fontSize: 11,\n  style: { fill: \"#c0392b\" },\n});\n\nconst col1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol1Container.addElement(quadraticTitle);\ncol1Container.addElement(quadraticGraph);\ncol1Container.addElement(quadNote);\n\ncolumns.getColumn(0).addElement(col1Container);\n\nconst trigTitle = new Text({\n  content: \"Trigonometric Functions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst trigGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.sin(x),\n      color: \"#3498db\",\n    },\n    {\n      fn: (x) => Math.cos(x),\n      color: \"#2ecc71\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [-2 * Math.PI, 2 * Math.PI],\n  range: [-1.5, 1.5],\n  debug: false,\n});\n\nconst col2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol2Container.addElement(trigTitle);\ncol2Container.addElement(trigGraph);\n\ncolumns.getColumn(1).addElement(col2Container);\n\nconst cubicTitle = new Text({\n  content: \"Cubic Polynomial\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst cubicGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => (x + 3) * (x - 1) * (x - 4) / 4,\n    color: \"#e67e22\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 6],\n  debug: false,\n});\n\nconst maxima = cubicGraph.getRemarkablePoints(\"local-maximum\");\nconst minima = cubicGraph.getRemarkablePoints(\"local-minimum\");\nconst extremaNote = new Text({\n  content: `Extrema detected: ${maxima.length} max, ${minima.length} min`,\n  fontSize: 11,\n  style: { fill: \"#e67e22\" },\n});\n\nconst col3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol3Container.addElement(cubicTitle);\ncol3Container.addElement(cubicGraph);\ncol3Container.addElement(extremaNote);\n\ncolumns.getColumn(2).addElement(col3Container);\n\n\nconst expLogTitle = new Text({\n  content: \"Exponential & Logarithmic\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst expLogGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.exp(x / 2),\n      color: \"#1abc9c\",\n    },\n    {\n      fn: (x) => Math.log(x),\n      color: \"#34495e\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [0.1, 5],\n  range: [-2, 6],\n  debug: false,\n});\n\nconst col4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol4Container.addElement(expLogTitle);\ncol4Container.addElement(expLogGraph);\n\ncolumns.getColumn(0).addElement(col4Container);\n\nconst rationalTitle = new Text({\n  content: \"Rational Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst rationalGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => 1 / (x - 2),\n    color: \"#e84393\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-3, 7],\n  range: [-5, 5],\n  debug: false,\n});\n\nconst asymptotes = rationalGraph.getRemarkablePoints(\"vertical-asymptote\");\nconst asymNote = new Text({\n  content: asymptotes.length > 0 \n    ? `Asymptote at x = ${asymptotes[0].x.toFixed(1)}`\n    : \"No asymptotes found\",\n  fontSize: 11,\n  style: { fill: \"#d63031\" },\n});\n\nconst col5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol5Container.addElement(rationalTitle);\ncol5Container.addElement(rationalGraph);\ncol5Container.addElement(asymNote);\n\ncolumns.getColumn(1).addElement(col5Container);\n\nconst piecewiseTitle = new Text({\n  content: \"Piecewise Function\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst piecewiseGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => {\n      if (x < -1) return x + 2;\n      if (x < 1) return x * x;\n      return 2 - x;\n    },\n    color: \"#6c5ce7\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-4, 4],\n  debug: false,\n});\n\nconst col6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol6Container.addElement(piecewiseTitle);\ncol6Container.addElement(piecewiseGraph);\n\ncolumns.getColumn(2).addElement(col6Container);\n\n\nconst absValueTitle = new Text({\n  content: \"Absolute Value Functions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst absValueGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.abs(x),\n      color: \"#00b894\",\n    },\n    {\n      fn: (x) => -Math.abs(x - 2) + 3,\n      color: \"#ff7675\",\n    },\n  ],\n  width: 360,\n  height: 280,\n  domain: [-5, 7],\n  debug: false,\n});\n\nconst col7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol7Container.addElement(absValueTitle);\ncol7Container.addElement(absValueGraph);\n\ncolumns.getColumn(0).addElement(col7Container);\n\nconst quinticTitle = new Text({\n  content: \"Quintic Polynomial\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst quinticGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => 0.01 * x ** 5 - 0.1 * x ** 3 + x,\n    color: \"#fd79a8\",\n  },\n  width: 360,\n  height: 280,\n  domain: [-5, 5],\n  debug: false,\n});\n\nconst inflectionPoints = quinticGraph.getRemarkablePoints(\"inflection-point\");\nconst inflectionNote = new Text({\n  content: `${inflectionPoints.length} inflection points detected`,\n  fontSize: 11,\n  style: { fill: \"#fd79a8\" },\n});\n\nconst col8Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol8Container.addElement(quinticTitle);\ncol8Container.addElement(quinticGraph);\ncol8Container.addElement(inflectionNote);\n\ncolumns.getColumn(1).addElement(col8Container);\n\nconst sineWaveTitle = new Text({\n  content: \"Damped Oscillation\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst sineWaveGraph = new FunctionGraph({\n  functions: {\n    fn: (x) => Math.sin(2 * x) * Math.exp(-x / 5),\n    color: \"#a29bfe\",\n  },\n  width: 360,\n  height: 280,\n  domain: [0, 10],\n  debug: false,\n});\n\nconst dampedNote = new Text({\n  content: \"Exponentially damped sine wave\",\n  fontSize: 11,\n  style: { fill: \"#6c5ce7\" },\n});\n\nconst col9Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\ncol9Container.addElement(sineWaveTitle);\ncol9Container.addElement(sineWaveGraph);\ncol9Container.addElement(dampedNote);\n\ncolumns.getColumn(2).addElement(col9Container);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a two-column layout with the following specifications: In the first column, display a placeholder text 'Column 1 (empty)'. In the second column, add a graph of the function y = x^2 - 4. Mark the remarkable points like roots, y-intercept, and minima with red dots. In addition, draw bounding boxes and crosshairs around these points using different colors: red for the roots, blue for the y-intercept, and green for any additional roots. The entire layout should have a white background with a specific debug border pattern: dashed red lines for columns and a light red fill for each column. Add titles and descriptions above the columns, with the main title reading 'Remarkable Points Position Debug (New System)'."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Circle,\n  Rect,\n  Columns,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Remarkable Points Position Debug (New System)\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\nconst description = new Text({\n  content:\n    \"Graph is in a Columns layout (2 columns) in the second column with debug borders visible. Red dots = auto-rendered remarkable points | Colored boxes = manually positioned using getRemarkablePoint()\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 800,\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: title.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 350,\n  height: 550,\n  gutter: 20,\n  verticalAlignment: \"center\",\n  horizontalAlignment: \"center\",\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\",\n    fill: \"none\",\n  },\n  boxModel: { padding: 10 },\n  columnStyle: {\n    fill: \"rgba(231, 76, 60, 0.05)\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(columns.container);\n\nconst placeholder = new Text({\n  content: \"Column 1 (empty)\",\n  fontSize: 14,\n  style: { fill: \"#95a5a6\" },\n});\n\ncolumns.getColumn(0).addElement(placeholder);\n\nconst graph = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#3498db\",\n  },\n  width: 300,\n  height: 400,\n  domain: [-5, 5],\n  range: [-5, 6],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true, // Auto-render red dots\n  debug: true, // Show bounding box\n});\n\ncolumns.getColumn(1).addElement(graph);\n\nconsole.log(\"=== Debugging Remarkable Points (New System) ===\");\nconsole.log(\"Graph position:\", graph.getAbsolutePosition());\n\nconst roots = graph.getRemarkablePoints(\"root\");\nconst yIntercept = graph.getRemarkablePoints(\"y-intercept\");\nconst minima = graph.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Roots found:\", roots.length);\nconsole.log(\"Y-intercept found:\", yIntercept.length);\nconsole.log(\"Minima found:\", minima.length);\n\nif (roots.length > 0) {\n  console.log(\"\\n=== Root 0 ===\");\n  const rootPos = graph.getRemarkablePoint(\"root\", 0);\n  console.log(\"Root 0 position from getRemarkablePoint:\", rootPos);\n\n  if (rootPos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(231, 76, 60, 0.1)\",\n        stroke: \"#e74c3c\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Root 0 bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root 0\",\n      fontSize: 10,\n      style: { fill: \"#e74c3c\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (roots.length > 1) {\n  console.log(\"\\n=== Root 1 ===\");\n  const rootPos = graph.getRemarkablePoint(\"root\", 1);\n  console.log(\"Root 1 position from getRemarkablePoint:\", rootPos);\n\n  if (rootPos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(39, 174, 96, 0.1)\",\n        stroke: \"#27ae60\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Root 1 bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root 1\",\n      fontSize: 10,\n      style: { fill: \"#27ae60\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (yIntercept.length > 0) {\n  console.log(\"\\n=== Y-Intercept ===\");\n  const pos = graph.getRemarkablePoint(\"y-intercept\", 0);\n  console.log(\"Y-intercept position from getRemarkablePoint:\", pos);\n\n  if (pos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(52, 152, 219, 0.1)\",\n        stroke: \"#3498db\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Y-intercept bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#3498db\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#3498db\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Y-intercept\",\n      fontSize: 10,\n      style: { fill: \"#3498db\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconst note = new Text({\n  content:\n    \"Graph is in Columns layout column [1] (second column) - red dashed border shows column boundary. If working correctly: crosshairs and boxes should be centered on the red dots\",\n  fontSize: 11,\n  fontWeight: \"bold\",\n  style: { fill: \"#e74c3c\" },\n  maxWidth: 700,\n});\n\nnote.position({\n  relativeFrom: note.topLeft,\n  relativeTo: columns.container.bottomLeft,\n  x: 0,\n  y: 20,\n});\n\nartboard.addElement(note);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design an artboard with a multi-column layout, incorporating a graph in one of the columns. The graph should highlight several key points with distinct markers and labels. Use a variety of colors to differentiate these points. Include some descriptive text above the layout and ensure the overall style is clear with some borders for emphasis. The background should be light, and the layout should feel organized and visually balanced."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Circle,\n  Rect,\n  Columns,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Remarkable Points Position Debug (New System)\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\nconst description = new Text({\n  content:\n    \"Graph is in a Columns layout (2 columns) in the second column with debug borders visible. Red dots = auto-rendered remarkable points | Colored boxes = manually positioned using getRemarkablePoint()\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 800,\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: title.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst columns = new Columns({\n  count: 2,\n  columnWidth: 350,\n  height: 550,\n  gutter: 20,\n  verticalAlignment: \"center\",\n  horizontalAlignment: \"center\",\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    strokeDasharray: \"5,5\",\n    fill: \"none\",\n  },\n  boxModel: { padding: 10 },\n  columnStyle: {\n    fill: \"rgba(231, 76, 60, 0.05)\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n});\n\ncolumns.container.position({\n  relativeFrom: columns.container.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(columns.container);\n\nconst placeholder = new Text({\n  content: \"Column 1 (empty)\",\n  fontSize: 14,\n  style: { fill: \"#95a5a6\" },\n});\n\ncolumns.getColumn(0).addElement(placeholder);\n\nconst graph = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#3498db\",\n  },\n  width: 300,\n  height: 400,\n  domain: [-5, 5],\n  range: [-5, 6],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true, // Auto-render red dots\n  debug: true, // Show bounding box\n});\n\ncolumns.getColumn(1).addElement(graph);\n\nconsole.log(\"=== Debugging Remarkable Points (New System) ===\");\nconsole.log(\"Graph position:\", graph.getAbsolutePosition());\n\nconst roots = graph.getRemarkablePoints(\"root\");\nconst yIntercept = graph.getRemarkablePoints(\"y-intercept\");\nconst minima = graph.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Roots found:\", roots.length);\nconsole.log(\"Y-intercept found:\", yIntercept.length);\nconsole.log(\"Minima found:\", minima.length);\n\nif (roots.length > 0) {\n  console.log(\"\\n=== Root 0 ===\");\n  const rootPos = graph.getRemarkablePoint(\"root\", 0);\n  console.log(\"Root 0 position from getRemarkablePoint:\", rootPos);\n\n  if (rootPos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(231, 76, 60, 0.1)\",\n        stroke: \"#e74c3c\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Root 0 bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root 0\",\n      fontSize: 10,\n      style: { fill: \"#e74c3c\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (roots.length > 1) {\n  console.log(\"\\n=== Root 1 ===\");\n  const rootPos = graph.getRemarkablePoint(\"root\", 1);\n  console.log(\"Root 1 position from getRemarkablePoint:\", rootPos);\n\n  if (rootPos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(39, 174, 96, 0.1)\",\n        stroke: \"#27ae60\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Root 1 bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root 1\",\n      fontSize: 10,\n      style: { fill: \"#27ae60\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (yIntercept.length > 0) {\n  console.log(\"\\n=== Y-Intercept ===\");\n  const pos = graph.getRemarkablePoint(\"y-intercept\", 0);\n  console.log(\"Y-intercept position from getRemarkablePoint:\", pos);\n\n  if (pos) {\n    const bbox = new Rect({\n      width: 30,\n      height: 30,\n      style: {\n        fill: \"rgba(52, 152, 219, 0.1)\",\n        stroke: \"#3498db\",\n        strokeWidth: 2,\n      },\n    });\n\n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    console.log(\"Y-intercept bbox position after positioning:\", bbox.getAbsolutePosition());\n\n    artboard.addElement(bbox);\n\n    const hLine = new Rect({\n      width: 40,\n      height: 1,\n      style: { fill: \"#3498db\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 1,\n      height: 40,\n      style: { fill: \"#3498db\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Y-intercept\",\n      fontSize: 10,\n      style: { fill: \"#3498db\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 25,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconst note = new Text({\n  content:\n    \"Graph is in Columns layout column [1] (second column) - red dashed border shows column boundary. If working correctly: crosshairs and boxes should be centered on the red dots\",\n  fontSize: 11,\n  fontWeight: \"bold\",\n  style: { fill: \"#e74c3c\" },\n  maxWidth: 700,\n});\n\nnote.position({\n  relativeFrom: note.topLeft,\n  relativeTo: columns.container.bottomLeft,\n  x: 0,\n  y: 20,\n});\n\nartboard.addElement(note);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization with an auto-sized artboard that has a white background and padding of 40. Add a bold title at the top with the text 'Remarkable Points in Horizontal & Vertical Containers', font size 24, and color #2c3e50. Below it, include a smaller description with font size 12 and color #7f8c8d. Create a horizontal container with dashed stroke lines and spacing of 40, containing two vertical columns. The first column should have a vertical layout with a blue semi-transparent background, dashed blue stroke, and 15 spacing. Add a graph of y = x^2 - 4 with a width of 400 and height of 300, displaying remarkable points like roots and y-intercepts and debugging enabled. In the second column, place a graph of y = sin(2x) with similar dimensions and remarkable points, but using red colors. Add crosshairs at each remarkable point, and include labels like 'Root (G1)', 'Y-int (G1)', etc., in appropriate colors. At the bottom, add a bold red text summarizing the crosshair alignment with the red dots."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Rect,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Remarkable Points in Horizontal & Vertical Containers\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\nconst description = new Text({\n  content:\n    \"Testing remarkable point coordinate retrieval in different layout contexts. Red dots = auto-rendered | Crosshairs = manually positioned via getRemarkablePoint()\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 1320,\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: title.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst hstack = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 40,\n  style: {\n    fill: \"transparent\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 20 },\n});\n\nhstack.position({\n  relativeFrom: hstack.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(hstack);\n\nconst column1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  style: {\n    fill: \"rgba(52, 152, 219, 0.05)\",\n    stroke: \"#3498db\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 15 },\n});\n\nconst col1Title = new Text({\n  content: \"Column 1: Vertical Container\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ncolumn1.addElement(col1Title);\n\nconst graph1 = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#3498db\",\n  },\n  width: 400,\n  height: 300,\n  domain: [-5, 5],\n  range: [-5, 6],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  debug: true,\n});\n\ncolumn1.addElement(graph1);\n\nconst col1Note = new Text({\n  content: \"Graph in Vertical Container\",\n  fontSize: 11,\n  style: { fill: \"#7f8c8d\" },\n});\n\ncolumn1.addElement(col1Note);\n\nhstack.addElement(column1);\n\nconst column2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  style: {\n    fill: \"rgba(231, 76, 60, 0.05)\",\n    stroke: \"#e74c3c\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 15 },\n});\n\nconst col2Title = new Text({\n  content: \"Column 2: Vertical Container\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ncolumn2.addElement(col2Title);\n\nconst graph2 = new FunctionGraph({\n  functions: {\n    fn: (x) => Math.sin(x * 2),\n    color: \"#e74c3c\",\n  },\n  width: 400,\n  height: 300,\n  domain: [-Math.PI, Math.PI],\n  range: [-1.5, 1.5],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  debug: true,\n});\n\ncolumn2.addElement(graph2);\n\nconst col2Note = new Text({\n  content: \"Graph in Vertical Container (2nd column)\",\n  fontSize: 11,\n  style: { fill: \"#7f8c8d\" },\n});\n\ncolumn2.addElement(col2Note);\n\nhstack.addElement(column2);\n\nconsole.log(\"=== Layout Positions Debug (New System) ===\");\nconsole.log(\"HStack position:\", hstack.getAbsolutePosition());\nconsole.log(\"Column 1 position:\", column1.getAbsolutePosition());\nconsole.log(\"Column 2 position:\", column2.getAbsolutePosition());\nconsole.log(\"Graph1 position:\", graph1.getAbsolutePosition());\nconsole.log(\"Graph2 position:\", graph2.getAbsolutePosition());\n\nconsole.log(\"\\n=== Graph 1 Remarkable Points ===\");\nconst g1Roots = graph1.getRemarkablePoints(\"root\");\nconst g1YIntercept = graph1.getRemarkablePoints(\"y-intercept\");\nconst g1Minima = graph1.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Graph1 roots:\", g1Roots.length);\nconsole.log(\"Graph1 y-intercepts:\", g1YIntercept.length);\nconsole.log(\"Graph1 minima:\", g1Minima.length);\n\nif (g1Roots.length > 0) {\n  const rootPos = graph1.getRemarkablePoint(\"root\", 0);\n  console.log(\"Graph1 Root 0 position:\", rootPos);\n\n  if (rootPos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root (G1)\",\n      fontSize: 9,\n      style: { fill: \"#e74c3c\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (g1YIntercept.length > 0) {\n  const pos = graph1.getRemarkablePoint(\"y-intercept\", 0);\n  console.log(\"Graph1 Y-intercept position:\", pos);\n\n  if (pos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Y-int (G1)\",\n      fontSize: 9,\n      style: { fill: \"#27ae60\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconsole.log(\"\\n=== Graph 2 Remarkable Points ===\");\nconst g2Roots = graph2.getRemarkablePoints(\"root\");\nconst g2YIntercept = graph2.getRemarkablePoints(\"y-intercept\");\nconst g2Maxima = graph2.getRemarkablePoints(\"local-maximum\");\n\nconsole.log(\"Graph2 roots:\", g2Roots.length);\nconsole.log(\"Graph2 y-intercepts:\", g2YIntercept.length);\nconsole.log(\"Graph2 maxima:\", g2Maxima.length);\n\nif (g2Roots.length > 0) {\n  const rootPos = graph2.getRemarkablePoint(\"root\", 0);\n  console.log(\"Graph2 Root 0 position:\", rootPos);\n\n  if (rootPos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#9b59b6\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#9b59b6\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root (G2)\",\n      fontSize: 9,\n      style: { fill: \"#9b59b6\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (g2Maxima.length > 0) {\n  const pos = graph2.getRemarkablePoint(\"local-maximum\", 0);\n  console.log(\"Graph2 Maximum 0 position:\", pos);\n\n  if (pos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#f39c12\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#f39c12\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Max (G2)\",\n      fontSize: 9,\n      style: { fill: \"#f39c12\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconst summary = new Text({\n  content:\n    \"If working correctly: crosshairs should be centered on red dots in both graphs. Check console for position details.\",\n  fontSize: 11,\n  fontWeight: \"bold\",\n  style: { fill: \"#e74c3c\" },\n  maxWidth: 1320,\n});\n\nsummary.position({\n  relativeFrom: summary.topLeft,\n  relativeTo: hstack.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(summary);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a layout with a main artboard that auto-sizes itself. At the top, place a prominent title describing the layout's purpose. Below this, add a short description. Arrange two columns horizontally that each contain a graph with notable points like roots or maxima. Use different styles and colors for each column and ensure there are visual markers at significant points on the graphs. Finally, include a summary below the columns indicating the purpose of the markers."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Rect,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Remarkable Points in Horizontal & Vertical Containers\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\nconst description = new Text({\n  content:\n    \"Testing remarkable point coordinate retrieval in different layout contexts. Red dots = auto-rendered | Crosshairs = manually positioned via getRemarkablePoint()\",\n  fontSize: 12,\n  style: { fill: \"#7f8c8d\" },\n  maxWidth: 1320,\n});\n\ndescription.position({\n  relativeFrom: description.topLeft,\n  relativeTo: title.bottomLeft,\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(description);\n\nconst hstack = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 40,\n  style: {\n    fill: \"transparent\",\n    stroke: \"#95a5a6\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 20 },\n});\n\nhstack.position({\n  relativeFrom: hstack.topLeft,\n  relativeTo: description.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(hstack);\n\nconst column1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  style: {\n    fill: \"rgba(52, 152, 219, 0.05)\",\n    stroke: \"#3498db\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 15 },\n});\n\nconst col1Title = new Text({\n  content: \"Column 1: Vertical Container\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ncolumn1.addElement(col1Title);\n\nconst graph1 = new FunctionGraph({\n  functions: {\n    fn: (x) => x * x - 4,\n    color: \"#3498db\",\n  },\n  width: 400,\n  height: 300,\n  domain: [-5, 5],\n  range: [-5, 6],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  debug: true,\n});\n\ncolumn1.addElement(graph1);\n\nconst col1Note = new Text({\n  content: \"Graph in Vertical Container\",\n  fontSize: 11,\n  style: { fill: \"#7f8c8d\" },\n});\n\ncolumn1.addElement(col1Note);\n\nhstack.addElement(column1);\n\nconst column2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  style: {\n    fill: \"rgba(231, 76, 60, 0.05)\",\n    stroke: \"#e74c3c\",\n    strokeWidth: 1,\n    strokeDasharray: \"3,3\",\n  },\n  boxModel: { padding: 15 },\n});\n\nconst col2Title = new Text({\n  content: \"Column 2: Vertical Container\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\ncolumn2.addElement(col2Title);\n\nconst graph2 = new FunctionGraph({\n  functions: {\n    fn: (x) => Math.sin(x * 2),\n    color: \"#e74c3c\",\n  },\n  width: 400,\n  height: 300,\n  domain: [-Math.PI, Math.PI],\n  range: [-1.5, 1.5],\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  debug: true,\n});\n\ncolumn2.addElement(graph2);\n\nconst col2Note = new Text({\n  content: \"Graph in Vertical Container (2nd column)\",\n  fontSize: 11,\n  style: { fill: \"#7f8c8d\" },\n});\n\ncolumn2.addElement(col2Note);\n\nhstack.addElement(column2);\n\nconsole.log(\"=== Layout Positions Debug (New System) ===\");\nconsole.log(\"HStack position:\", hstack.getAbsolutePosition());\nconsole.log(\"Column 1 position:\", column1.getAbsolutePosition());\nconsole.log(\"Column 2 position:\", column2.getAbsolutePosition());\nconsole.log(\"Graph1 position:\", graph1.getAbsolutePosition());\nconsole.log(\"Graph2 position:\", graph2.getAbsolutePosition());\n\nconsole.log(\"\\n=== Graph 1 Remarkable Points ===\");\nconst g1Roots = graph1.getRemarkablePoints(\"root\");\nconst g1YIntercept = graph1.getRemarkablePoints(\"y-intercept\");\nconst g1Minima = graph1.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Graph1 roots:\", g1Roots.length);\nconsole.log(\"Graph1 y-intercepts:\", g1YIntercept.length);\nconsole.log(\"Graph1 minima:\", g1Minima.length);\n\nif (g1Roots.length > 0) {\n  const rootPos = graph1.getRemarkablePoint(\"root\", 0);\n  console.log(\"Graph1 Root 0 position:\", rootPos);\n\n  if (rootPos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#e74c3c\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root (G1)\",\n      fontSize: 9,\n      style: { fill: \"#e74c3c\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (g1YIntercept.length > 0) {\n  const pos = graph1.getRemarkablePoint(\"y-intercept\", 0);\n  console.log(\"Graph1 Y-intercept position:\", pos);\n\n  if (pos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#27ae60\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Y-int (G1)\",\n      fontSize: 9,\n      style: { fill: \"#27ae60\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconsole.log(\"\\n=== Graph 2 Remarkable Points ===\");\nconst g2Roots = graph2.getRemarkablePoints(\"root\");\nconst g2YIntercept = graph2.getRemarkablePoints(\"y-intercept\");\nconst g2Maxima = graph2.getRemarkablePoints(\"local-maximum\");\n\nconsole.log(\"Graph2 roots:\", g2Roots.length);\nconsole.log(\"Graph2 y-intercepts:\", g2YIntercept.length);\nconsole.log(\"Graph2 maxima:\", g2Maxima.length);\n\nif (g2Roots.length > 0) {\n  const rootPos = graph2.getRemarkablePoint(\"root\", 0);\n  console.log(\"Graph2 Root 0 position:\", rootPos);\n\n  if (rootPos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#9b59b6\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#9b59b6\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: rootPos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Root (G2)\",\n      fontSize: 9,\n      style: { fill: \"#9b59b6\" },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: rootPos,\n      x: 0,\n      y: -20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nif (g2Maxima.length > 0) {\n  const pos = graph2.getRemarkablePoint(\"local-maximum\", 0);\n  console.log(\"Graph2 Maximum 0 position:\", pos);\n\n  if (pos) {\n    const hLine = new Rect({\n      width: 30,\n      height: 2,\n      style: { fill: \"#f39c12\", stroke: \"none\" },\n    });\n\n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(hLine);\n\n    const vLine = new Rect({\n      width: 2,\n      height: 30,\n      style: { fill: \"#f39c12\", stroke: \"none\" },\n    });\n\n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(vLine);\n\n    const label = new Text({\n      content: \"Max (G2)\",\n      fontSize: 9,\n      style: { fill: \"#f39c12\" },\n    });\n\n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 20,\n    });\n\n    artboard.addElement(label);\n  }\n}\n\nconst summary = new Text({\n  content:\n    \"If working correctly: crosshairs should be centered on red dots in both graphs. Check console for position details.\",\n  fontSize: 11,\n  fontWeight: \"bold\",\n  style: { fill: \"#e74c3c\" },\n  maxWidth: 1320,\n});\n\nsummary.position({\n  relativeFrom: summary.topLeft,\n  relativeTo: hstack.bottomLeft,\n  x: 0,\n  y: 30,\n});\n\nartboard.addElement(summary);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background, 900 by 500 in size. In the center horizontally, place three circles in a row: a blue circle with a dark blue border on the left, a red circle with a darker red border in the center, and a green circle with a darker green border on the right. Draw a dashed purple curve from the blue circle to the red circle, and a solid orange curve from the red circle to the green circle. Add a blue arrow pointing from above the blue circle to above the red circle. Below the red circle, place a double-ended red arrow pointing to the green circle. Along the purple curve, add small purple dots evenly spaced."},{"role":"assistant","content":"import {\n  Artboard,\n  BezierCurve,\n  Arrow,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 900,\n  height: 500,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst circle1 = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\ncircle1.position({\n  relativeFrom: circle1.center,\n  relativeTo: artboard.contentBox.center,\n  x: -250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle1);\n\nconst circle2 = new Circle({\n  radius: 50,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\ncircle2.position({\n  relativeFrom: circle2.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 50,\n  style: { fill: \"#2ecc71\", stroke: \"#27ae60\", strokeWidth: 2 },\n});\n\ncircle3.position({\n  relativeFrom: circle3.center,\n  relativeTo: artboard.contentBox.center,\n  x: 250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle3);\n\nconst c1 = circle1.center;\nconst c2 = circle2.center;\nconst c3 = circle3.center;\n\nconst curve1 = new BezierCurve({\n  start: { x: c1.x + 50, y: c1.y },\n  end: { x: c2.x - 50, y: c2.y },\n  controlPoint1: { x: c1.x + 100, y: c1.y - 60 },\n  controlPoint2: { x: c2.x - 100, y: c2.y + 60 },\n  style: {\n    stroke: \"#9b59b6\",\n    strokeWidth: 3,\n    fill: \"none\",\n    strokeDasharray: \"8,4\",\n  },\n});\n\nartboard.addElement(curve1);\n\nconst curve2 = new BezierCurve({\n  start: { x: c2.x + 50, y: c2.y },\n  end: { x: c3.x - 50, y: c3.y },\n  controlPoint1: { x: c2.x + 100, y: c2.y + 60 },\n  controlPoint2: { x: c3.x - 100, y: c3.y - 60 },\n  style: {\n    stroke: \"#f39c12\",\n    strokeWidth: 3,\n    fill: \"none\",\n  },\n});\n\nartboard.addElement(curve2);\n\nconst arrow1 = new Arrow({\n  start: { x: c1.x, y: c1.y - 50 },\n  end: { x: c2.x, y: c2.y - 50 },\n  headStyle: \"triangle\",\n  headSize: 10,\n  style: {\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n    fill: \"#3498db\",\n  },\n});\n\nartboard.addElement(arrow1);\n\nconst arrow2 = new Arrow({\n  start: { x: c2.x, y: c2.y + 50 },\n  end: { x: c3.x, y: c3.y + 50 },\n  headStyle: \"line\",\n  headSize: 12,\n  doubleEnded: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n  },\n});\n\nartboard.addElement(arrow2);\n\nfor (let i = 0; i <= 8; i++) {\n  const t = i / 8;\n  const point = curve1.pointAt(t);\n  \n  const dot = new Circle({\n    radius: 3,\n    style: { fill: \"#9b59b6\", opacity: 0.7 },\n  });\n  \n  dot.position({\n    relativeFrom: dot.center,\n    relativeTo: point,\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(dot);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a scene on a light background with several colorful circles arranged in a line. Connect the circles with curved lines and add some arrows between them. Include a few highlights or details along one of the curves to enhance the visual effect."},{"role":"assistant","content":"import {\n  Artboard,\n  BezierCurve,\n  Arrow,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 900,\n  height: 500,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst circle1 = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\ncircle1.position({\n  relativeFrom: circle1.center,\n  relativeTo: artboard.contentBox.center,\n  x: -250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle1);\n\nconst circle2 = new Circle({\n  radius: 50,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\ncircle2.position({\n  relativeFrom: circle2.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle2);\n\nconst circle3 = new Circle({\n  radius: 50,\n  style: { fill: \"#2ecc71\", stroke: \"#27ae60\", strokeWidth: 2 },\n});\n\ncircle3.position({\n  relativeFrom: circle3.center,\n  relativeTo: artboard.contentBox.center,\n  x: 250,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(circle3);\n\nconst c1 = circle1.center;\nconst c2 = circle2.center;\nconst c3 = circle3.center;\n\nconst curve1 = new BezierCurve({\n  start: { x: c1.x + 50, y: c1.y },\n  end: { x: c2.x - 50, y: c2.y },\n  controlPoint1: { x: c1.x + 100, y: c1.y - 60 },\n  controlPoint2: { x: c2.x - 100, y: c2.y + 60 },\n  style: {\n    stroke: \"#9b59b6\",\n    strokeWidth: 3,\n    fill: \"none\",\n    strokeDasharray: \"8,4\",\n  },\n});\n\nartboard.addElement(curve1);\n\nconst curve2 = new BezierCurve({\n  start: { x: c2.x + 50, y: c2.y },\n  end: { x: c3.x - 50, y: c3.y },\n  controlPoint1: { x: c2.x + 100, y: c2.y + 60 },\n  controlPoint2: { x: c3.x - 100, y: c3.y - 60 },\n  style: {\n    stroke: \"#f39c12\",\n    strokeWidth: 3,\n    fill: \"none\",\n  },\n});\n\nartboard.addElement(curve2);\n\nconst arrow1 = new Arrow({\n  start: { x: c1.x, y: c1.y - 50 },\n  end: { x: c2.x, y: c2.y - 50 },\n  headStyle: \"triangle\",\n  headSize: 10,\n  style: {\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n    fill: \"#3498db\",\n  },\n});\n\nartboard.addElement(arrow1);\n\nconst arrow2 = new Arrow({\n  start: { x: c2.x, y: c2.y + 50 },\n  end: { x: c3.x, y: c3.y + 50 },\n  headStyle: \"line\",\n  headSize: 12,\n  doubleEnded: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n  },\n});\n\nartboard.addElement(arrow2);\n\nfor (let i = 0; i <= 8; i++) {\n  const t = i / 8;\n  const point = curve1.pointAt(t);\n  \n  const dot = new Circle({\n    radius: 3,\n    style: { fill: \"#9b59b6\", opacity: 0.7 },\n  });\n  \n  dot.position({\n    relativeFrom: dot.center,\n    relativeTo: point,\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(dot);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard that is 1200 pixels wide and 600 pixels tall with a light gray background. Place three triangles on the artboard: a right triangle with sides 120 and 90 in the bottom left, a light blue fill, and dark blue stroke; an equilateral triangle with a side length of 140, a light orange fill, and an orange stroke; and an isosceles triangle with an apex angle at the top, sides 120 and 100, a light purple fill, and a purple stroke. Label the vertices and sides of each triangle. Add a 90° angle mark on the right triangle and 60° angle marks on the equilateral triangle. Label the apex angle of the isosceles triangle with the symbol alpha. Include bold titles above each triangle describing their types and characteristics."},{"role":"assistant","content":"import {\n  Artboard,\n  Triangle,\n  Angle,\n  Container,\n  Text,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 1200,\n  height: 600,\n  style: { fill: \"#f8f9fa\" },\n});\n\nconst triangle1 = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\ntriangle1.position({\n  relativeFrom: triangle1.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 200,\n});\n\nconst vertexLabels1 = triangle1.createVertexLabels([\"$A$\", \"$B$\", \"$C$\"], 30, 18);\n\nconst sideLabels1 = triangle1.createSideLabels([\"$a$\", \"$b$\", \"$c$\"], { offset: 25, fontSize: 16 });\n\nconst verts1 = triangle1.absoluteVertices;\nconst angle1 = new Angle({\n  vertex: verts1[0], // Right angle vertex\n  startAngle: 0,\n  endAngle: 90,\n  radius: 35,\n  label: \"90°\",\n  labelFontSize: 14,\n  style: { stroke: \"#f44336\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle1);\nvertexLabels1.forEach(label => artboard.addElement(label));\nsideLabels1.forEach(label => artboard.addElement(label));\nartboard.addElement(angle1);\n\nconst title1 = new Text({\n  content: \"Right Triangle with Labels\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle1.position({\n  relativeTo: triangle1.boundingBoxTopLeft,\n  relativeFrom: title1.bottomCenter,\n  x: 60,\n  y: -30,\n});\nartboard.addElement(title1);\n\nconst triangle2 = new Triangle({\n  type: \"equilateral\",\n  a: 140,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntriangle2.position({\n  relativeFrom: triangle2.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 500,\n  y: 250,\n});\n\nconst vertexLabels2 = triangle2.createVertexLabels([\"$D$\", \"$E$\", \"$F$\"], 30, 18);\n\nconst sideLabels2 = triangle2.createSideLabels([\"$d$\", \"$e$\", \"$f$\"], { offset: 25, fontSize: 16 });\n\nconst verts2 = triangle2.absoluteVertices;\n\nconst angle2a = new Angle({\n  vertex: verts2[0], // Bottom-left\n  startAngle: 0,    // Horizontal right (toward bottom-right vertex)\n  endAngle: 60,     // 60° up toward top vertex\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nconst angle2b = new Angle({\n  vertex: verts2[1], // Bottom-right\n  startAngle: 120,  // Toward top vertex\n  endAngle: 180,    // Toward bottom-left vertex\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nconst angle2c = new Angle({\n  vertex: verts2[2], // Top\n  startAngle: 240,  // Toward bottom-left\n  endAngle: 300,    // Toward bottom-right\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nartboard.addElement(triangle2);\nvertexLabels2.forEach(label => artboard.addElement(label));\nsideLabels2.forEach(label => artboard.addElement(label));\nartboard.addElement(angle2a);\nartboard.addElement(angle2b);\nartboard.addElement(angle2c);\n\nconst title2 = new Text({\n  content: \"Equilateral Triangle (all angles 60°)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle2.position({\n  relativeTo: triangle2.boundingBoxTopLeft,\n  relativeFrom: title2.bottomCenter,\n  x: 70,\n  y: -40,\n});\nartboard.addElement(title2);\n\nconst triangle3 = new Triangle({\n  type: \"isosceles\",\n  a: 120,\n  b: 100,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\ntriangle3.position({\n  relativeFrom: triangle3.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 930,\n  y: 270,\n});\n\nconst vertexLabels3 = triangle3.createVertexLabels([\"$P$\", \"$Q$\", \"$R$\"], 30, 18);\n\nconst sideLabels3 = triangle3.createSideLabels([\"$p$\", \"$q$\", \"$q$\"], { offset: 25, fontSize: 16 });\n\nconst verts3 = triangle3.absoluteVertices;\nconst angle3 = new Angle({\n  vertex: verts3[2], // Top vertex (apex)\n  startAngle: 235,\n  endAngle: 305,\n  radius: 40,\n  label: \"$\\\\alpha$\",\n  labelFontSize: 14,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle3);\nvertexLabels3.forEach(label => artboard.addElement(label));\nsideLabels3.forEach(label => artboard.addElement(label));\nartboard.addElement(angle3);\n\nconst title3 = new Text({\n  content: \"Isosceles Triangle\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle3.position({\n  relativeTo: triangle3.boundingBoxTopLeft,\n  relativeFrom: title3.bottomCenter,\n  x: 60,\n  y: -35,\n});\nartboard.addElement(title3);\n\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw an artboard that includes several types of triangles, each with different colors and sizes. Add labels to the vertices and sides of each triangle, and mark some of the angles. Place descriptive titles near the triangles to indicate their types and some of their features."},{"role":"assistant","content":"import {\n  Artboard,\n  Triangle,\n  Angle,\n  Container,\n  Text,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 1200,\n  height: 600,\n  style: { fill: \"#f8f9fa\" },\n});\n\nconst triangle1 = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\ntriangle1.position({\n  relativeFrom: triangle1.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 200,\n});\n\nconst vertexLabels1 = triangle1.createVertexLabels([\"$A$\", \"$B$\", \"$C$\"], 30, 18);\n\nconst sideLabels1 = triangle1.createSideLabels([\"$a$\", \"$b$\", \"$c$\"], { offset: 25, fontSize: 16 });\n\nconst verts1 = triangle1.absoluteVertices;\nconst angle1 = new Angle({\n  vertex: verts1[0], // Right angle vertex\n  startAngle: 0,\n  endAngle: 90,\n  radius: 35,\n  label: \"90°\",\n  labelFontSize: 14,\n  style: { stroke: \"#f44336\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle1);\nvertexLabels1.forEach(label => artboard.addElement(label));\nsideLabels1.forEach(label => artboard.addElement(label));\nartboard.addElement(angle1);\n\nconst title1 = new Text({\n  content: \"Right Triangle with Labels\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle1.position({\n  relativeTo: triangle1.boundingBoxTopLeft,\n  relativeFrom: title1.bottomCenter,\n  x: 60,\n  y: -30,\n});\nartboard.addElement(title1);\n\nconst triangle2 = new Triangle({\n  type: \"equilateral\",\n  a: 140,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntriangle2.position({\n  relativeFrom: triangle2.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 500,\n  y: 250,\n});\n\nconst vertexLabels2 = triangle2.createVertexLabels([\"$D$\", \"$E$\", \"$F$\"], 30, 18);\n\nconst sideLabels2 = triangle2.createSideLabels([\"$d$\", \"$e$\", \"$f$\"], { offset: 25, fontSize: 16 });\n\nconst verts2 = triangle2.absoluteVertices;\n\nconst angle2a = new Angle({\n  vertex: verts2[0], // Bottom-left\n  startAngle: 0,    // Horizontal right (toward bottom-right vertex)\n  endAngle: 60,     // 60° up toward top vertex\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nconst angle2b = new Angle({\n  vertex: verts2[1], // Bottom-right\n  startAngle: 120,  // Toward top vertex\n  endAngle: 180,    // Toward bottom-left vertex\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nconst angle2c = new Angle({\n  vertex: verts2[2], // Top\n  startAngle: 240,  // Toward bottom-left\n  endAngle: 300,    // Toward bottom-right\n  radius: 35,\n  label: \"60°\",\n  labelFontSize: 12,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nartboard.addElement(triangle2);\nvertexLabels2.forEach(label => artboard.addElement(label));\nsideLabels2.forEach(label => artboard.addElement(label));\nartboard.addElement(angle2a);\nartboard.addElement(angle2b);\nartboard.addElement(angle2c);\n\nconst title2 = new Text({\n  content: \"Equilateral Triangle (all angles 60°)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle2.position({\n  relativeTo: triangle2.boundingBoxTopLeft,\n  relativeFrom: title2.bottomCenter,\n  x: 70,\n  y: -40,\n});\nartboard.addElement(title2);\n\nconst triangle3 = new Triangle({\n  type: \"isosceles\",\n  a: 120,\n  b: 100,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\ntriangle3.position({\n  relativeFrom: triangle3.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 930,\n  y: 270,\n});\n\nconst vertexLabels3 = triangle3.createVertexLabels([\"$P$\", \"$Q$\", \"$R$\"], 30, 18);\n\nconst sideLabels3 = triangle3.createSideLabels([\"$p$\", \"$q$\", \"$q$\"], { offset: 25, fontSize: 16 });\n\nconst verts3 = triangle3.absoluteVertices;\nconst angle3 = new Angle({\n  vertex: verts3[2], // Top vertex (apex)\n  startAngle: 235,\n  endAngle: 305,\n  radius: 40,\n  label: \"$\\\\alpha$\",\n  labelFontSize: 14,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle3);\nvertexLabels3.forEach(label => artboard.addElement(label));\nsideLabels3.forEach(label => artboard.addElement(label));\nartboard.addElement(angle3);\n\nconst title3 = new Text({\n  content: \"Isosceles Triangle\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n});\ntitle3.position({\n  relativeTo: triangle3.boundingBoxTopLeft,\n  relativeFrom: title3.bottomCenter,\n  x: 60,\n  y: -35,\n});\nartboard.addElement(title3);\n\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background, 1200 by 800 pixels in size. On it, draw a parallelogram with side lengths 140 and 80, an interior angle of 65 degrees, and color it light blue with a dark blue border. Position it 100 pixels right and 150 pixels down from the top-left corner. Label its vertices A, B, C, D and its sides a, b, c, d. Show external angles labeled alpha and beta at two of its vertices. Next, add a trapezoid with base lengths 140 and 80 and an angle of 70 degrees, colored light orange with a dark orange border, positioned 450 pixels right and 150 pixels down. Label its vertices P, Q, R, S and sides p, q, r, s, with external angles labeled gamma, delta, epsilon, and zeta. Then, draw a rhombus with side length 90 and an angle of 70 degrees, filled with light purple and with a dark purple border, located 850 pixels right and 150 pixels down, with vertices W, X, Y, Z and sides all labeled s. Show external angles labeled eta and theta at two of its vertices. Finally, add a rectangle with dimensions 140 by 90, filled light green with a dark green border, placed 250 pixels right and 450 pixels down, with vertices M, N, O, P and sides labeled w and h. Show its internal angles with right angle markers."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 1200,\n  height: 800,\n  style: { fill: \"#f8f9fa\" },\n});\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 140,\n  b: 80,\n  angle: 65,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 100,\n  y: 150,\n});\n\nconst paraVertexLabels = parallelogram.createVertexLabels([\"$A$\", \"$B$\", \"$C$\", \"$D$\"]);\nconst paraSideLabels = parallelogram.createSideLabels([\"$a$\", \"$b$\", \"$c$\", \"$d$\"]);\n\nconst paraExtAngle0 = parallelogram.showAngle(0, {\n  mode: 'external',\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: \"2\" },\n});\n\nconst paraExtAngle1 = parallelogram.showAngle(1, {\n  mode: 'external',\n  radius: 40,\n  label: \"β\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(parallelogram);\nparaVertexLabels.forEach((label) => artboard.addElement(label));\nparaSideLabels.forEach((label) => artboard.addElement(label));\nartboard.addElement(paraExtAngle0);\nartboard.addElement(paraExtAngle1);\n\nconst trapezoid = new Quadrilateral({\n  type: \"trapezoid\",\n  a: 140,\n  b: 80,\n  angle: 70,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntrapezoid.position({\n  relativeFrom: trapezoid.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 450,\n  y: 150,\n});\n\nconst trapVertexLabels = trapezoid.createVertexLabels([\"$P$\", \"$Q$\", \"$R$\", \"$S$\"]);\nconst trapSideLabels = trapezoid.createSideLabels([\"$p$\", \"$q$\", \"$r$\", \"$s$\"]);\n\nconst trapAngles = trapezoid.showAngles({\n  mode: 'external',\n  labels: [\"γ\", \"δ\", \"ε\", \"ζ\"],\n  radius: 35,\n  labelFontSize: 16,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nartboard.addElement(trapezoid);\ntrapVertexLabels.forEach((label) => artboard.addElement(label));\ntrapSideLabels.forEach((label) => artboard.addElement(label));\ntrapAngles.forEach((angle) => artboard.addElement(angle));\n\nconst rhombus = new Quadrilateral({\n  type: \"rhombus\",\n  a: 90,\n  angle: 70,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nrhombus.position({\n  relativeFrom: rhombus.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 850,\n  y: 150,\n});\n\nconst rhombusVertexLabels = rhombus.createVertexLabels([\"$W$\", \"$X$\", \"$Y$\", \"$Z$\"]);\nconst rhombusSideLabels = rhombus.createSideLabels([\"$s$\", \"$s$\", \"$s$\", \"$s$\"]);\n\nconst rhombusExtAngle1 = rhombus.showAngle(1, {\n  mode: 'external',\n  radius: 40,\n  label: \"η\",\n  labelFontSize: 16,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nconst rhombusExtAngle3 = rhombus.showAngle(3, {\n  mode: 'external',\n  radius: 40,\n  label: \"θ\",\n  labelFontSize: 16,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rhombus);\nrhombusVertexLabels.forEach((label) => artboard.addElement(label));\nrhombusSideLabels.forEach((label) => artboard.addElement(label));\nartboard.addElement(rhombusExtAngle1);\nartboard.addElement(rhombusExtAngle3);\n\nconst rectangle = new Quadrilateral({\n  type: \"rectangle\",\n  a: 140,\n  b: 90,\n  style: { fill: \"#e8f5e9\", stroke: \"#388e3c\", strokeWidth: \"2\" },\n});\n\nrectangle.position({\n  relativeFrom: rectangle.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 250,\n  y: 450,\n});\n\nconst rectVertexLabels = rectangle.createVertexLabels([\"$M$\", \"$N$\", \"$O$\", \"$P$\"]);\nconst rectSideLabels = rectangle.createSideLabels([\"$w$\", \"$h$\", \"$w$\", \"$h$\"]);\n\nconst rectAngles = rectangle.showAngles({\n  mode: 'internal',\n  radius: 25,\n  rightAngleMarker: 'square',\n  style: { stroke: \"#388e3c\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rectangle);\nrectVertexLabels.forEach((label) => artboard.addElement(label));\nrectSideLabels.forEach((label) => artboard.addElement(label));\nrectAngles.forEach((angle) => artboard.addElement(angle));\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a drawing featuring several different quadrilateral shapes. Include a parallelogram, trapezoid, rhombus, and rectangle, each filled with various light colors and outlined with matching darker shades. Label their vertices and sides, and show some angles at their corners. Arrange these shapes across a large canvas, spacing them apart and varying their positions. Use different styles for angles and labels to distinguish between the shapes."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 1200,\n  height: 800,\n  style: { fill: \"#f8f9fa\" },\n});\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 140,\n  b: 80,\n  angle: 65,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 100,\n  y: 150,\n});\n\nconst paraVertexLabels = parallelogram.createVertexLabels([\"$A$\", \"$B$\", \"$C$\", \"$D$\"]);\nconst paraSideLabels = parallelogram.createSideLabels([\"$a$\", \"$b$\", \"$c$\", \"$d$\"]);\n\nconst paraExtAngle0 = parallelogram.showAngle(0, {\n  mode: 'external',\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: \"2\" },\n});\n\nconst paraExtAngle1 = parallelogram.showAngle(1, {\n  mode: 'external',\n  radius: 40,\n  label: \"β\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(parallelogram);\nparaVertexLabels.forEach((label) => artboard.addElement(label));\nparaSideLabels.forEach((label) => artboard.addElement(label));\nartboard.addElement(paraExtAngle0);\nartboard.addElement(paraExtAngle1);\n\nconst trapezoid = new Quadrilateral({\n  type: \"trapezoid\",\n  a: 140,\n  b: 80,\n  angle: 70,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntrapezoid.position({\n  relativeFrom: trapezoid.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 450,\n  y: 150,\n});\n\nconst trapVertexLabels = trapezoid.createVertexLabels([\"$P$\", \"$Q$\", \"$R$\", \"$S$\"]);\nconst trapSideLabels = trapezoid.createSideLabels([\"$p$\", \"$q$\", \"$r$\", \"$s$\"]);\n\nconst trapAngles = trapezoid.showAngles({\n  mode: 'external',\n  labels: [\"γ\", \"δ\", \"ε\", \"ζ\"],\n  radius: 35,\n  labelFontSize: 16,\n  style: { stroke: \"#f57c00\", strokeWidth: \"1.5\" },\n});\n\nartboard.addElement(trapezoid);\ntrapVertexLabels.forEach((label) => artboard.addElement(label));\ntrapSideLabels.forEach((label) => artboard.addElement(label));\ntrapAngles.forEach((angle) => artboard.addElement(angle));\n\nconst rhombus = new Quadrilateral({\n  type: \"rhombus\",\n  a: 90,\n  angle: 70,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nrhombus.position({\n  relativeFrom: rhombus.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 850,\n  y: 150,\n});\n\nconst rhombusVertexLabels = rhombus.createVertexLabels([\"$W$\", \"$X$\", \"$Y$\", \"$Z$\"]);\nconst rhombusSideLabels = rhombus.createSideLabels([\"$s$\", \"$s$\", \"$s$\", \"$s$\"]);\n\nconst rhombusExtAngle1 = rhombus.showAngle(1, {\n  mode: 'external',\n  radius: 40,\n  label: \"η\",\n  labelFontSize: 16,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nconst rhombusExtAngle3 = rhombus.showAngle(3, {\n  mode: 'external',\n  radius: 40,\n  label: \"θ\",\n  labelFontSize: 16,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rhombus);\nrhombusVertexLabels.forEach((label) => artboard.addElement(label));\nrhombusSideLabels.forEach((label) => artboard.addElement(label));\nartboard.addElement(rhombusExtAngle1);\nartboard.addElement(rhombusExtAngle3);\n\nconst rectangle = new Quadrilateral({\n  type: \"rectangle\",\n  a: 140,\n  b: 90,\n  style: { fill: \"#e8f5e9\", stroke: \"#388e3c\", strokeWidth: \"2\" },\n});\n\nrectangle.position({\n  relativeFrom: rectangle.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 250,\n  y: 450,\n});\n\nconst rectVertexLabels = rectangle.createVertexLabels([\"$M$\", \"$N$\", \"$O$\", \"$P$\"]);\nconst rectSideLabels = rectangle.createSideLabels([\"$w$\", \"$h$\", \"$w$\", \"$h$\"]);\n\nconst rectAngles = rectangle.showAngles({\n  mode: 'internal',\n  radius: 25,\n  rightAngleMarker: 'square',\n  style: { stroke: \"#388e3c\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rectangle);\nrectVertexLabels.forEach((label) => artboard.addElement(label));\nrectSideLabels.forEach((label) => artboard.addElement(label));\nrectAngles.forEach((angle) => artboard.addElement(angle));\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a 900x700 white canvas. Add a bold title at the top that says 'Angle Debugging - Internal & External Angles'. Draw a light blue parallelogram with dimensions 200x120 and an internal angle of 70 degrees, positioned at (150, 150). Mark each vertex with a small red circle. Show the internal angles in green and the external angles in red, each with labels. Place the corner labels as $A$, $B$, $C$, and $D$. Also, display a legend at the bottom explaining the symbols. Next, add a rectangle with dimensions 150x100 in light orange with a bold orange border, positioned at (600, 250). For debugging, include a complete circle labeled '360°' at two opposite rectangle vertices. Add inward angles at each corner of this rectangle with a bold orange outline."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 900,\n  height: 700,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Angle Debugging - Internal & External Angles\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 200,\n  b: 120,\n  angle: 70,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 150,\n});\n\nartboard.addElement(parallelogram);\n\nconst verts = parallelogram.absoluteVertices;\n\nfor (let i = 0; i < 4; i++) {\n  const circle = new Circle({\n    radius: 6,\n    style: { fill: \"#f44336\", stroke: \"none\" },\n  });\n  circle.position({\n    relativeTo: verts[i],\n    relativeFrom: circle.center,\n  });\n  artboard.addElement(circle);\n}\n\nfor (let i = 0; i < 4; i++) {\n  const internalAngle = new Angle({\n    figure: parallelogram,\n    vertexIndex: i,\n    type: 'inward',\n    radius: 30,\n    label: `${parallelogram.getInternalAngleAt(i).toFixed(0)}°`,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1.5\" },\n    rightAngleMarker: 'arc', // Show arc even for 90° angles\n  });\n  artboard.addElement(internalAngle);\n}\n\nfor (let i = 0; i < 4; i++) {\n  const externalAngle = new Angle({\n    figure: parallelogram,\n    vertexIndex: i,\n    type: 'outward',\n    radius: 50,\n    label: `${parallelogram.getExternalAngleAt(i).toFixed(0)}°`,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"1.5\" },\n    rightAngleMarker: 'arc', // Show arc even for 90° angles\n  });\n  artboard.addElement(externalAngle);\n}\n\nconst vertexLabels = parallelogram.createVertexLabels([\"$A$\", \"$B$\", \"$C$\", \"$D$\"], 75, 18);\nvertexLabels.forEach(label => artboard.addElement(label));\n\nconst legend = new Text({\n  content: \"🔴 Red circles: vertex positions | 🟢 Green: internal angles | 🔴 Red: external angles\",\n  fontSize: 14,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 600,\n});\nartboard.addElement(legend);\n\nconst rect = new Quadrilateral({\n  type: \"rectangle\",\n  a: 150,\n  b: 100,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\nrect.position({\n  relativeFrom: rect.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 600,\n  y: 250,\n});\n\nartboard.addElement(rect);\n\nconst rectVerts = rect.absoluteVertices;\nconst debugCircle1 = new Angle({\n  vertex: rectVerts[0],\n  startAngle: 0,\n  endAngle: 360,\n  radius: 40,\n  label: \"360°\",\n  style: { stroke: \"#9b59b6\", strokeWidth: \"1\", strokeDasharray: \"3,3\" },\n});\n\nconst debugCircle2 = new Angle({\n  vertex: rectVerts[2],\n  startAngle: 0,\n  endAngle: 360,\n  radius: 40,\n  label: \"360°\",\n  style: { stroke: \"#9b59b6\", strokeWidth: \"1\", strokeDasharray: \"3,3\" },\n});\n\nartboard.addElement(debugCircle1);\nartboard.addElement(debugCircle2);\n\nfor (let i = 0; i < 4; i++) {\n  const angle = new Angle({\n    figure: rect,\n    vertexIndex: i,\n    type: 'inward',\n    radius: 20,\n    style: { stroke: \"#f57c00\", strokeWidth: \"2\" },\n  });\n  artboard.addElement(angle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a canvas with a title at the top. Add a shape like a quadrilateral with some angles highlighted using different colors and labels. Include a few circles at certain points for marking. Provide some labels near the corners of the shape. Add a legend to explain any symbols used. Additionally, include another rectangular shape elsewhere on the canvas, with some debugging elements near its corners."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 900,\n  height: 700,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Angle Debugging - Internal & External Angles\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 200,\n  b: 120,\n  angle: 70,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 150,\n  y: 150,\n});\n\nartboard.addElement(parallelogram);\n\nconst verts = parallelogram.absoluteVertices;\n\nfor (let i = 0; i < 4; i++) {\n  const circle = new Circle({\n    radius: 6,\n    style: { fill: \"#f44336\", stroke: \"none\" },\n  });\n  circle.position({\n    relativeTo: verts[i],\n    relativeFrom: circle.center,\n  });\n  artboard.addElement(circle);\n}\n\nfor (let i = 0; i < 4; i++) {\n  const internalAngle = new Angle({\n    figure: parallelogram,\n    vertexIndex: i,\n    type: 'inward',\n    radius: 30,\n    label: `${parallelogram.getInternalAngleAt(i).toFixed(0)}°`,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1.5\" },\n    rightAngleMarker: 'arc', // Show arc even for 90° angles\n  });\n  artboard.addElement(internalAngle);\n}\n\nfor (let i = 0; i < 4; i++) {\n  const externalAngle = new Angle({\n    figure: parallelogram,\n    vertexIndex: i,\n    type: 'outward',\n    radius: 50,\n    label: `${parallelogram.getExternalAngleAt(i).toFixed(0)}°`,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"1.5\" },\n    rightAngleMarker: 'arc', // Show arc even for 90° angles\n  });\n  artboard.addElement(externalAngle);\n}\n\nconst vertexLabels = parallelogram.createVertexLabels([\"$A$\", \"$B$\", \"$C$\", \"$D$\"], 75, 18);\nvertexLabels.forEach(label => artboard.addElement(label));\n\nconst legend = new Text({\n  content: \"🔴 Red circles: vertex positions | 🟢 Green: internal angles | 🔴 Red: external angles\",\n  fontSize: 14,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 600,\n});\nartboard.addElement(legend);\n\nconst rect = new Quadrilateral({\n  type: \"rectangle\",\n  a: 150,\n  b: 100,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\nrect.position({\n  relativeFrom: rect.boundingBoxTopLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 600,\n  y: 250,\n});\n\nartboard.addElement(rect);\n\nconst rectVerts = rect.absoluteVertices;\nconst debugCircle1 = new Angle({\n  vertex: rectVerts[0],\n  startAngle: 0,\n  endAngle: 360,\n  radius: 40,\n  label: \"360°\",\n  style: { stroke: \"#9b59b6\", strokeWidth: \"1\", strokeDasharray: \"3,3\" },\n});\n\nconst debugCircle2 = new Angle({\n  vertex: rectVerts[2],\n  startAngle: 0,\n  endAngle: 360,\n  radius: 40,\n  label: \"360°\",\n  style: { stroke: \"#9b59b6\", strokeWidth: \"1\", strokeDasharray: \"3,3\" },\n});\n\nartboard.addElement(debugCircle1);\nartboard.addElement(debugCircle2);\n\nfor (let i = 0; i < 4; i++) {\n  const angle = new Angle({\n    figure: rect,\n    vertexIndex: i,\n    type: 'inward',\n    radius: 20,\n    style: { stroke: \"#f57c00\", strokeWidth: \"2\" },\n  });\n  artboard.addElement(angle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization on an 800x600 white canvas with four labeled sections. In the first section, draw two intersecting lines with the colors blue and red, and mark the intersection with a green circle and label it with coordinates. In the second section, draw two parallel lines with the same colors and indicate with text that they do not intersect. In the third section, show two lines that intersect within their segments, mark the intersection with a green circle, and label it '✓ Within bounds'. In the fourth section, depict two lines that would intersect if extended, show the dash lines to their intersection, and highlight it with a green circle."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\n{\n  const title = new Text({\n    content: \"Line Intersections\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 20,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 40, y: 80 },\n    end: { x: 200, y: 180 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 40, y: 180 },\n    end: { x: 200, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2);\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n\n    const label = new Text({\n      content: `(${intersection.x.toFixed(0)}, ${intersection.y.toFixed(0)})`,\n      fontSize: 12,\n    });\n    artboard.addElement(label);\n    label.position({\n      relativeTo: { x: intersection.x, y: intersection.y - 15 },\n      relativeFrom: label.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\n{\n  const title = new Text({\n    content: \"Parallel Lines\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 280,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 300, y: 90 },\n    end: { x: 460, y: 110 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 300, y: 150 },\n    end: { x: 460, y: 170 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2);\n  const result = new Text({\n    content: intersections.length > 0 ? \"Intersection found\" : \"No intersection (parallel)\",\n    fontSize: 12,\n  });\n  result.position({\n    relativeTo: { x: 380, y: 130 },\n    relativeFrom: result.center,\n  });\n  artboard.addElement(result);\n}\n\n{\n  const title = new Text({\n    content: \"Segment Intersection\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 560,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 550, y: 60 },\n    end: { x: 690, y: 200 },\n    style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 600, y: 60 },\n    end: { x: 600, y: 200 },\n    style: { stroke: \"#f39c12\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2, false);\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n\n    const label = new Text({\n      content: \"✓ Within bounds\",\n      fontSize: 12,\n    });\n    artboard.addElement(label);\n    label.position({\n      relativeTo: { x: 620, y: 50 },\n      relativeFrom: label.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\n{\n  const title = new Text({\n    content: \"Extended Lines (Infinite)\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 20,\n    y: 280,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 50, y: 350 },\n    end: { x: 100, y: 400 },\n    style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 150, y: 350 },\n    end: { x: 100, y: 400 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2, true); // infinite=true\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const ext1 = new Line({\n      start: { x: line1.end.x, y: line1.end.y },\n      end: { x: intersection.x, y: intersection.y },\n      style: { stroke: \"#3498db\", strokeWidth: \"1\", strokeDasharray: \"5,5\", opacity: 0.5 },\n    });\n    \n    const ext2 = new Line({\n      start: { x: line2.end.x, y: line2.end.y },\n      end: { x: intersection.x, y: intersection.y },\n      style: { stroke: \"#e74c3c\", strokeWidth: \"1\", strokeDasharray: \"5,5\", opacity: 0.5 },\n    });\n\n    artboard.addElement(ext1);\n    artboard.addElement(ext2);\n\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a diagram with several sections showing different line arrangements. Use different colors for the lines in each section, and include labels for each section. In some sections, show lines that intersect and mark these intersections visually. Indicate when lines do not intersect or when their extension would meet. Include text for explanations or labels where needed."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\n{\n  const title = new Text({\n    content: \"Line Intersections\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 20,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 40, y: 80 },\n    end: { x: 200, y: 180 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 40, y: 180 },\n    end: { x: 200, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2);\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n\n    const label = new Text({\n      content: `(${intersection.x.toFixed(0)}, ${intersection.y.toFixed(0)})`,\n      fontSize: 12,\n    });\n    artboard.addElement(label);\n    label.position({\n      relativeTo: { x: intersection.x, y: intersection.y - 15 },\n      relativeFrom: label.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\n{\n  const title = new Text({\n    content: \"Parallel Lines\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 280,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 300, y: 90 },\n    end: { x: 460, y: 110 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 300, y: 150 },\n    end: { x: 460, y: 170 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2);\n  const result = new Text({\n    content: intersections.length > 0 ? \"Intersection found\" : \"No intersection (parallel)\",\n    fontSize: 12,\n  });\n  result.position({\n    relativeTo: { x: 380, y: 130 },\n    relativeFrom: result.center,\n  });\n  artboard.addElement(result);\n}\n\n{\n  const title = new Text({\n    content: \"Segment Intersection\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 560,\n    y: 0,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 550, y: 60 },\n    end: { x: 690, y: 200 },\n    style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 600, y: 60 },\n    end: { x: 600, y: 200 },\n    style: { stroke: \"#f39c12\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2, false);\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n\n    const label = new Text({\n      content: \"✓ Within bounds\",\n      fontSize: 12,\n    });\n    artboard.addElement(label);\n    label.position({\n      relativeTo: { x: 620, y: 50 },\n      relativeFrom: label.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\n{\n  const title = new Text({\n    content: \"Extended Lines (Infinite)\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 20,\n    y: 280,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 50, y: 350 },\n    end: { x: 100, y: 400 },\n    style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 150, y: 350 },\n    end: { x: 100, y: 400 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const intersections = line1.getIntersections(line2, true); // infinite=true\n  if (intersections.length > 0) {\n    const intersection = intersections[0];\n    const ext1 = new Line({\n      start: { x: line1.end.x, y: line1.end.y },\n      end: { x: intersection.x, y: intersection.y },\n      style: { stroke: \"#3498db\", strokeWidth: \"1\", strokeDasharray: \"5,5\", opacity: 0.5 },\n    });\n    \n    const ext2 = new Line({\n      start: { x: line2.end.x, y: line2.end.y },\n      end: { x: intersection.x, y: intersection.y },\n      style: { stroke: \"#e74c3c\", strokeWidth: \"1\", strokeDasharray: \"5,5\", opacity: 0.5 },\n    });\n\n    artboard.addElement(ext1);\n    artboard.addElement(ext2);\n\n    const marker = new Circle({\n      radius: 5,\n      style: { fill: \"#2ecc71\", stroke: \"none\" },\n    });\n    artboard.addElement(marker);\n    marker.position({\n      relativeTo: intersection,\n      relativeFrom: marker.center,\n      x: 0,\n      y: 0,\n    });\n  }\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization on a 1100x650 white canvas with padding of 40 units. Add a bold main title at the top left saying 'Angles from Lines - Ray-Based Selection (+,+ or +,- etc.)'. Below, create separate sections with titles and illustrations: 'Vertex Angle (+,+)' with two intersecting lines starting from (50, 130) forming an angle labeled '\\alpha'; 'Reflex Angle (-,-)' with lines forming an angle labeled '\\beta'; 'Crossing Lines (+,-)' with a right angle; 'Right Angle (Dot)' with a line intersection marked by a dot; 'Triangle Internal Angles (using figure API)' illustrating a right triangle with internal angles labeled; and '45° Angle (+,+)' with two lines forming a 45-degree angle. Use distinct colors like blue, red, green, purple, and orange for lines and angles. Position each group with clear visual separation and relevant titles."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 1100,\n  height: 650,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst mainTitle = new Text({\n  content: \"Angles from Lines - Ray-Based Selection (+,+ or +,- etc.)\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\nmainTitle.position({\n  relativeFrom: mainTitle.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(mainTitle);\n\n{\n  const title = new Text({\n    content: \"Vertex Angle (+,+)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 50,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 50, y: 130 },\n    end: { x: 200, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 50, y: 130 },\n    end: { x: 180, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    label: \"$\\\\alpha$\",\n    radius: 50,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Reflex Angle (-,-)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 300,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 300, y: 130 },\n    end: { x: 450, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 300, y: 130 },\n    end: { x: 430, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"-\",\n    ray2: \"-\",\n    label: \"$\\\\beta$\",\n    radius: 50,\n    style: { stroke: \"#9b59b6\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Crossing Lines (+,-)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 580,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 580, y: 130 },\n    end: { x: 680, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 630, y: 80 },\n    end: { x: 630, y: 180 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"-\",\n    radius: 20,\n    style: { stroke: \"#000000\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Right Angle (Dot)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 800,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 800, y: 130 },\n    end: { x: 900, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 850, y: 80 },\n    end: { x: 850, y: 180 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"-\",\n    label: \"90°\",\n    radius: 35,\n    rightAngleMarker: 'dot',\n    style: { stroke: \"#f39c12\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Triangle Internal Angles (using figure API)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 50,\n    y: 260,\n  });\n  artboard.addElement(title);\n\n  const triangle = new Triangle({\n    type: \"right\",\n    a: 180,\n    b: 140,\n    style: { stroke: \"#95a5a6\", strokeWidth: \"2\", fill: \"none\" },\n  });\n  \n  triangle.position({\n    relativeFrom: triangle.boundingBoxTopLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 80,\n    y: 330,\n  });\n  \n  artboard.addElement(triangle);\n\n  const angle0 = new Angle({\n    figure: triangle,\n    vertexIndex: 0,\n    type: 'inward',\n    label: \"$\\\\alpha$\",\n    radius: 30,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"1\" },\n  });\n\n  const angle1 = new Angle({\n    figure: triangle,\n    vertexIndex: 1,\n    type: 'inward',\n    label: \"$\\\\beta$\",\n    radius: 30,\n    style: { stroke: \"#3498db\", strokeWidth: \"1\" },\n  });\n\n  const angle2 = new Angle({\n    figure: triangle,\n    vertexIndex: 2,\n    type: 'inward',\n    radius: 25,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1\" },\n    rightAngleMarker: 'square',\n  });\n\n  artboard.addElement(angle0);\n  artboard.addElement(angle1);\n  artboard.addElement(angle2);\n}\n\n{\n  const title = new Text({\n    content: \"45° Angle (+,+)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 550,\n    y: 320,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 550, y: 420 },\n    end: { x: 700, y: 420 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 550, y: 420 },\n    end: { x: 656, y: 314 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    label: \"45°\",\n    radius: 60,\n    style: { stroke: \"#9b59b6\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a canvas with several sections showcasing different types of angles and line interactions. Use a variety of colors to differentiate the lines and angles. Include some sections where lines form simple angles, some where they form complex angles, and at least one where a triangle is shown with its internal angles labeled. Each section should have a descriptive title and the layout should organize these visual elements clearly across the canvas."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 1100,\n  height: 650,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst mainTitle = new Text({\n  content: \"Angles from Lines - Ray-Based Selection (+,+ or +,- etc.)\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\nmainTitle.position({\n  relativeFrom: mainTitle.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(mainTitle);\n\n{\n  const title = new Text({\n    content: \"Vertex Angle (+,+)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 50,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 50, y: 130 },\n    end: { x: 200, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 50, y: 130 },\n    end: { x: 180, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    label: \"$\\\\alpha$\",\n    radius: 50,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Reflex Angle (-,-)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 300,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 300, y: 130 },\n    end: { x: 450, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 300, y: 130 },\n    end: { x: 430, y: 80 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"-\",\n    ray2: \"-\",\n    label: \"$\\\\beta$\",\n    radius: 50,\n    style: { stroke: \"#9b59b6\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Crossing Lines (+,-)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 580,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 580, y: 130 },\n    end: { x: 680, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 630, y: 80 },\n    end: { x: 630, y: 180 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"-\",\n    radius: 20,\n    style: { stroke: \"#000000\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Right Angle (Dot)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 800,\n    y: 50,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 800, y: 130 },\n    end: { x: 900, y: 130 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 850, y: 80 },\n    end: { x: 850, y: 180 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"-\",\n    label: \"90°\",\n    radius: 35,\n    rightAngleMarker: 'dot',\n    style: { stroke: \"#f39c12\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\n{\n  const title = new Text({\n    content: \"Triangle Internal Angles (using figure API)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 50,\n    y: 260,\n  });\n  artboard.addElement(title);\n\n  const triangle = new Triangle({\n    type: \"right\",\n    a: 180,\n    b: 140,\n    style: { stroke: \"#95a5a6\", strokeWidth: \"2\", fill: \"none\" },\n  });\n  \n  triangle.position({\n    relativeFrom: triangle.boundingBoxTopLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 80,\n    y: 330,\n  });\n  \n  artboard.addElement(triangle);\n\n  const angle0 = new Angle({\n    figure: triangle,\n    vertexIndex: 0,\n    type: 'inward',\n    label: \"$\\\\alpha$\",\n    radius: 30,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"1\" },\n  });\n\n  const angle1 = new Angle({\n    figure: triangle,\n    vertexIndex: 1,\n    type: 'inward',\n    label: \"$\\\\beta$\",\n    radius: 30,\n    style: { stroke: \"#3498db\", strokeWidth: \"1\" },\n  });\n\n  const angle2 = new Angle({\n    figure: triangle,\n    vertexIndex: 2,\n    type: 'inward',\n    radius: 25,\n    style: { stroke: \"#2ecc71\", strokeWidth: \"1\" },\n    rightAngleMarker: 'square',\n  });\n\n  artboard.addElement(angle0);\n  artboard.addElement(angle1);\n  artboard.addElement(angle2);\n}\n\n{\n  const title = new Text({\n    content: \"45° Angle (+,+)\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n  });\n  title.position({\n    relativeFrom: title.topLeft,\n    relativeTo: artboard.contentBox.topLeft,\n    x: 550,\n    y: 320,\n  });\n  artboard.addElement(title);\n\n  const line1 = new Line({\n    start: { x: 550, y: 420 },\n    end: { x: 700, y: 420 },\n    style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n  });\n\n  const line2 = new Line({\n    start: { x: 550, y: 420 },\n    end: { x: 656, y: 314 },\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(line1);\n  artboard.addElement(line2);\n\n  const angle = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    label: \"45°\",\n    radius: 60,\n    style: { stroke: \"#9b59b6\", strokeWidth: \"1.5\" },\n  });\n  artboard.addElement(angle);\n}\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an 800 by 600 pixel white canvas with a 40-pixel padding. Draw two intersecting lines: the first from point (120, 350) to (500, 390) in blue with a 3-pixel stroke and the second from (310, 150) to (350, 420) in red with the same stroke width. Add a title 'Angle Debug - Two Crossing Lines' at the top left. Mark the intersection point with a 5-pixel radius black circle. Display an angle label '(+,+)' in red at the intersection with debugging symbols. Include a legend below the lines describing the ray selection and debugging symbols. Display line coordinates on the top right in a monospaced font."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst line1Start = { x: 120, y: 350 };\nconst line1End = { x: 500, y: 390 };\n\nconst line2Start = { x: 310, y: 150 };\nconst line2End = { x: 350, y: 420 };\n\nconst title = new Text({\n  content: \"Angle Debug - Two Crossing Lines\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst line1 = new Line({\n  start: line1Start,\n  end: line1End,\n  style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n});\n\nconst line2 = new Line({\n  start: line2Start,\n  end: line2End,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n});\n\nartboard.addElement(line1);\nartboard.addElement(line2);\n\nconst intersections = line1.getIntersections(line2, true);\nif (intersections.length > 0) {\n  const intersection = intersections[0];\n\n  const marker = new Circle({\n    radius: 5,\n    style: { fill: \"#000000\", stroke: \"none\" },\n  });\n  artboard.addElement(marker);\n  marker.position({\n    relativeTo: intersection,\n    relativeFrom: marker.center,\n    x: 0,\n    y: 0,\n  });\n\n  const anglePP = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    radius: 50,\n    label: \"(+,+)\",\n    labelFontSize: 14,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n    debug: true,\n  });\n  artboard.addElement(anglePP);\n}\n\nconst legend = new Text({\n  content:\n    \"Ray Selection: (+,+)=top-right  (-,+)=top-left  (-,-)=bottom-left  (+,-)=bottom-right\",\n  fontSize: 13,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 520,\n});\nartboard.addElement(legend);\n\nconst debugLegend = new Text({\n  content: \"Debug: 🔴 Arc start  🔵 Arc end  🟢 Bisector\",\n  fontSize: 12,\n  style: { fill: \"#666\" },\n});\ndebugLegend.position({\n  relativeFrom: debugLegend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 540,\n});\nartboard.addElement(debugLegend);\n\nconst info = new Text({\n  content: `Line1: (${line1Start.x},${line1Start.y}) → (${line1End.x},${line1End.y})\nLine2: (${line2Start.x},${line2Start.y}) → (${line2End.x},${line2End.y})`,\n  fontSize: 12,\n  fontFamily: \"monospace\",\n  style: { fill: \"#666\" },\n});\ninfo.position({\n  relativeFrom: info.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 550,\n  y: 50,\n});\nartboard.addElement(info);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a large white canvas with some padding and draw several intersecting lines in different colors. Include a title at the top and mark the intersection points with small circles. Add angle labels near the intersections and include some text below the lines that explain the layout and symbols used. Display some information about the lines on the canvas."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst line1Start = { x: 120, y: 350 };\nconst line1End = { x: 500, y: 390 };\n\nconst line2Start = { x: 310, y: 150 };\nconst line2End = { x: 350, y: 420 };\n\nconst title = new Text({\n  content: \"Angle Debug - Two Crossing Lines\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst line1 = new Line({\n  start: line1Start,\n  end: line1End,\n  style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n});\n\nconst line2 = new Line({\n  start: line2Start,\n  end: line2End,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n});\n\nartboard.addElement(line1);\nartboard.addElement(line2);\n\nconst intersections = line1.getIntersections(line2, true);\nif (intersections.length > 0) {\n  const intersection = intersections[0];\n\n  const marker = new Circle({\n    radius: 5,\n    style: { fill: \"#000000\", stroke: \"none\" },\n  });\n  artboard.addElement(marker);\n  marker.position({\n    relativeTo: intersection,\n    relativeFrom: marker.center,\n    x: 0,\n    y: 0,\n  });\n\n  const anglePP = new Angle({\n    between: [line1, line2],\n    ray1: \"+\",\n    ray2: \"+\",\n    radius: 50,\n    label: \"(+,+)\",\n    labelFontSize: 14,\n    style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n    debug: true,\n  });\n  artboard.addElement(anglePP);\n}\n\nconst legend = new Text({\n  content:\n    \"Ray Selection: (+,+)=top-right  (-,+)=top-left  (-,-)=bottom-left  (+,-)=bottom-right\",\n  fontSize: 13,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 520,\n});\nartboard.addElement(legend);\n\nconst debugLegend = new Text({\n  content: \"Debug: 🔴 Arc start  🔵 Arc end  🟢 Bisector\",\n  fontSize: 12,\n  style: { fill: \"#666\" },\n});\ndebugLegend.position({\n  relativeFrom: debugLegend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 540,\n});\nartboard.addElement(debugLegend);\n\nconst info = new Text({\n  content: `Line1: (${line1Start.x},${line1Start.y}) → (${line1End.x},${line1End.y})\nLine2: (${line2Start.x},${line2Start.y}) → (${line2End.x},${line2End.y})`,\n  fontSize: 12,\n  fontFamily: \"monospace\",\n  style: { fill: \"#666\" },\n});\ninfo.position({\n  relativeFrom: info.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 550,\n  y: 50,\n});\nartboard.addElement(info);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an 800x600 white canvas with a bold title 'Angles at a Vertex (Lines Meeting at a Point)' at the top left. Draw two lines starting from the same point at (300, 300): one going to (500, 180) in blue and the other to (520, 380) in red. Add a small black circle at the vertex. Illustrate two angles, labeled 'α' and 'β', between the lines with green and purple arcs respectively. Position an explanation text centered towards the bottom saying that angles at a vertex sum to 360°, and include a legend at the top left describing debugging markers."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Angles at a Vertex (Lines Meeting at a Point)\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst vertex = { x: 300, y: 300 };\nconst lineA = new Line({\n  start: vertex,\n  end: { x: 500, y: 180 },\n  style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n});\n\nconst lineB = new Line({\n  start: vertex,\n  end: { x: 520, y: 380 },\n  style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n});\n\nartboard.addElement(lineA);\nartboard.addElement(lineB);\n\nconst marker = new Circle({\n  radius: 5,\n  style: { fill: \"#000000\", stroke: \"none\" },\n});\nartboard.addElement(marker);\nmarker.position({\n  relativeTo: vertex,\n  relativeFrom: marker.center,\n});\n\nconst angleIn = new Angle({\n  between: [lineA, lineB],\n  ray1: \"+\",\n  ray2: \"+\",\n  radius: 70,\n  label: \"α\",\n  labelFontSize: 20,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n  debug: true,\n});\nartboard.addElement(angleIn);\n\nconst angleOut = new Angle({\n  between: [lineA, lineB],\n  ray1: \"-\",\n  ray2: \"-\",\n  radius: 100,\n  label: \"β\",\n  labelFontSize: 20,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n  debug: true,\n});\nartboard.addElement(angleOut);\n\nconst explanation = new Text({\n  content: \"When lines meet at a vertex (like polygon sides):\\n\\nα + β = 360°\\n\\nThis is different from crossing lines where\\nadjacent angles sum to 180°\",\n  fontSize: 16,\n  textAlign: \"center\",\n  style: { fill: \"#666\" },\n  lineHeight: 1.5,\n});\nexplanation.position({\n  relativeFrom: explanation.topCenter,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 300,\n  y: 450,\n});\nartboard.addElement(explanation);\n\nconst legend = new Text({\n  content: \"Debug: 🔴 Arc start  🔵 Arc end  🟢 Bisector & label position\",\n  fontSize: 12,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 40,\n});\nartboard.addElement(legend);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw a medium-sized canvas with a title about angles formed by intersecting lines. Include several lines meeting at one point with some angle markers around them. Add a small circle at the intersection. Provide a detailed explanation text beneath the lines about the sum of the angles at the meeting point. Include a legend describing any visual markers used in the illustration."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 800,\n  height: 600,\n  style: { fill: \"#ffffff\" },\n  boxModel: { padding: 40 },\n});\n\nconst title = new Text({\n  content: \"Angles at a Vertex (Lines Meeting at a Point)\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n});\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\nartboard.addElement(title);\n\nconst vertex = { x: 300, y: 300 };\nconst lineA = new Line({\n  start: vertex,\n  end: { x: 500, y: 180 },\n  style: { stroke: \"#3498db\", strokeWidth: \"3\" },\n});\n\nconst lineB = new Line({\n  start: vertex,\n  end: { x: 520, y: 380 },\n  style: { stroke: \"#e74c3c\", strokeWidth: \"3\" },\n});\n\nartboard.addElement(lineA);\nartboard.addElement(lineB);\n\nconst marker = new Circle({\n  radius: 5,\n  style: { fill: \"#000000\", stroke: \"none\" },\n});\nartboard.addElement(marker);\nmarker.position({\n  relativeTo: vertex,\n  relativeFrom: marker.center,\n});\n\nconst angleIn = new Angle({\n  between: [lineA, lineB],\n  ray1: \"+\",\n  ray2: \"+\",\n  radius: 70,\n  label: \"α\",\n  labelFontSize: 20,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n  debug: true,\n});\nartboard.addElement(angleIn);\n\nconst angleOut = new Angle({\n  between: [lineA, lineB],\n  ray1: \"-\",\n  ray2: \"-\",\n  radius: 100,\n  label: \"β\",\n  labelFontSize: 20,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n  debug: true,\n});\nartboard.addElement(angleOut);\n\nconst explanation = new Text({\n  content: \"When lines meet at a vertex (like polygon sides):\\n\\nα + β = 360°\\n\\nThis is different from crossing lines where\\nadjacent angles sum to 180°\",\n  fontSize: 16,\n  textAlign: \"center\",\n  style: { fill: \"#666\" },\n  lineHeight: 1.5,\n});\nexplanation.position({\n  relativeFrom: explanation.topCenter,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 300,\n  y: 450,\n});\nartboard.addElement(explanation);\n\nconst legend = new Text({\n  content: \"Debug: 🔴 Arc start  🔵 Arc end  🟢 Bisector & label position\",\n  fontSize: 12,\n});\nlegend.position({\n  relativeFrom: legend.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 40,\n});\nartboard.addElement(legend);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a right triangle with sides of 8 units along the base and 6 units along the height, and add an altitude from the right angle to the hypotenuse. Use a light blue fill with 30% opacity and a strong blue stroke for the triangle, and a dashed red stroke for the altitude. Label the vertices A, B, C, and D, where D is the foot of the altitude. Mark the angles at vertices A and D as right angles, and annotate the triangle with dimensions and a title 'Similar Triangles: Altitude to Hypotenuse'. Include the theorem statement and a geometric mean check verification in the visualization, and ensure all elements are centered on a light gray background."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Triangle,\n  Line,\n  Latex,\n  Circle,\n  Angle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 1000,\n  height: 700,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n  boxModel: { padding: 30 },\n});\n\n\nconst mainTriangle = new Triangle({\n  type: \"right\",\n  a: 240,  // Base BC = 8 units (scaled)\n  b: 180,  // Height AB = 6 units (scaled)\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#e3f2fd\",\n    fillOpacity: 0.3,\n    stroke: \"#1976d2\",\n    strokeWidth: 3,\n  },\n});\n\nmainTriangle.position({\n  relativeFrom: mainTriangle.center,\n  relativeTo: { x: 300, y: 250 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(mainTriangle);\n\nconst vertices = mainTriangle.vertices;\nconst A = vertices[0];  // Bottom left (right angle vertex)\nconst B = vertices[1];  // Bottom right\nconst C = vertices[2];  // Top left\n\n\n\nconst AC_dx = C.x - A.x;\nconst AC_dy = C.y - A.y;\nconst AC_length = Math.sqrt(AC_dx * AC_dx + AC_dy * AC_dy);\n\nconst AB_dx = B.x - A.x;\nconst AB_dy = B.y - A.y;\n\nconst projection = (AB_dx * AC_dx + AB_dy * AC_dy) / (AC_length * AC_length);\nconst D = {\n  x: A.x + projection * AC_dx,\n  y: A.y + projection * AC_dy,\n};\n\nconst altitude = new Line({\n  start: B,\n  end: D,\n  style: {\n    stroke: \"#d32f2f\",\n    strokeWidth: 2.5,\n    strokeDasharray: \"6,4\",\n  },\n});\n\ncontainer.addElement(altitude);\n\n\nconst AD = Math.sqrt((D.x - A.x) ** 2 + (D.y - A.y) ** 2);\nconst DC = Math.sqrt((C.x - D.x) ** 2 + (C.y - D.y) ** 2);\nconst BD = Math.sqrt((D.x - B.x) ** 2 + (D.y - B.y) ** 2);\nconst AB = Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2);\nconst BC = Math.sqrt((C.x - B.x) ** 2 + (C.y - B.y) ** 2);\n\nconsole.log(\"=== SIMILAR TRIANGLES ===\");\nconsole.log(\"Main triangle ABC - sides:\", Math.round(AB), Math.round(BC), Math.round(AC_length));\nconsole.log(\"Triangle ADB - altitude:\", Math.round(BD));\nconsole.log(\"Segments: AD =\", Math.round(AD), \", DC =\", Math.round(DC));\nconsole.log(\"Geometric mean check: BD² =\", Math.round(BD * BD), \", AD × DC =\", Math.round(AD * DC));\n\n\nconst vertexLabels = [\n  { point: A, label: \"A\", offset: { x: -25, y: 15 } },\n  { point: B, label: \"B\", offset: { x: 15, y: 15 } },\n  { point: C, label: \"C\", offset: { x: -15, y: -25 } },\n  { point: D, label: \"D\", offset: { x: 0, y: -25 } },\n];\n\nvertexLabels.forEach(({ point, label, offset }) => {\n  const dot = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#1976d2\",\n      stroke: \"#0d47a1\",\n      strokeWidth: 2,\n    },\n  });\n  \n  dot.position({\n    relativeFrom: dot.center,\n    relativeTo: point,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(dot);\n  \n  const text = new Latex({\n    content: `$\\\\mathbf{${label}}$`,\n    style: {\n      fontSize: \"18px\",\n      fontWeight: \"bold\",\n      fill: \"#0d47a1\",\n    },\n  });\n  \n  text.position({\n    relativeFrom: text.center,\n    relativeTo: point,\n    x: offset.x,\n    y: offset.y,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(text);\n});\n\n\nfunction calculateAngle(vertex, point1, point2) {\n  const angle1 = Math.atan2(point1.y - vertex.y, point1.x - vertex.x) * 180 / Math.PI;\n  const angle2 = Math.atan2(point2.y - vertex.y, point2.x - vertex.x) * 180 / Math.PI;\n  return { start: angle1, end: angle2 };\n}\n\nconst anglesA = calculateAngle(A, B, C);\nconst angleA = new Angle({\n  vertex: A,\n  startAngle: anglesA.start,\n  endAngle: anglesA.end,\n  radius: 25,\n  style: {\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n    fill: \"#c8e6c9\",\n    fillOpacity: 0.3,\n  },\n  showRightAngleSquare: true,\n});\ncontainer.addElement(angleA);\n\nconst anglesD = calculateAngle(D, B, A);\nconst angleD = new Angle({\n  vertex: D,\n  startAngle: anglesD.start,\n  endAngle: anglesD.end,\n  radius: 20,\n  style: {\n    stroke: \"#ff9800\",\n    strokeWidth: 2,\n    fill: \"#ffe0b2\",\n    fillOpacity: 0.3,\n  },\n  showRightAngleSquare: true,\n});\ncontainer.addElement(angleD);\n\n\nconst dimensions = [\n  {\n    label: `${Math.round(AB)}`,\n    midpoint: { x: (A.x + B.x) / 2, y: (A.y + B.y) / 2 },\n    offset: { x: 0, y: 25 },\n  },\n  {\n    label: `${Math.round(BC)}`,\n    midpoint: { x: (B.x + C.x) / 2, y: (B.y + C.y) / 2 },\n    offset: { x: 25, y: 0 },\n  },\n  {\n    label: `${Math.round(AC_length)}`,\n    midpoint: { x: (A.x + C.x) / 2, y: (A.y + C.y) / 2 },\n    offset: { x: -30, y: -10 },\n  },\n  {\n    label: `h=${Math.round(BD)}`,\n    midpoint: { x: (B.x + D.x) / 2, y: (B.y + D.y) / 2 },\n    offset: { x: 20, y: 0 },\n    color: \"#d32f2f\",\n  },\n];\n\ndimensions.forEach(({ label, midpoint, offset, color }) => {\n  const dimLabel = new Latex({\n    content: `$\\\\small ${label}$`,\n    style: {\n      fontSize: \"14px\",\n      fill: color || \"#424242\",\n      fontWeight: \"600\",\n    },\n  });\n  \n  dimLabel.position({\n    relativeFrom: dimLabel.center,\n    relativeTo: midpoint,\n    x: offset.x,\n    y: offset.y,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(dimLabel);\n});\n\n\nconst title = new Latex({\n  content: \"$\\\\text{Similar Triangles: Altitude to Hypotenuse}$\",\n  style: {\n    fontSize: \"22px\",\n    fontWeight: \"bold\",\n    fill: \"#1a237e\",\n  },\n});\n\ntitle.position({\n  relativeFrom: title.center,\n  relativeTo: { x: 300, y: 30 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(title);\n\nconst theorem = new Latex({\n  content: `$\\\\triangle ABC \\\\sim \\\\triangle ADB \\\\sim \\\\triangle BDC$`,\n  style: {\n    fontSize: \"16px\",\n    fill: \"#1565c0\",\n    fontWeight: \"600\",\n  },\n});\n\ntheorem.position({\n  relativeFrom: theorem.center,\n  relativeTo: { x: 300, y: 470 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(theorem);\n\nconst formula1 = new Latex({\n  content: `$h^2 = ${Math.round(AD)} \\\\times ${Math.round(DC)} = ${Math.round(AD * DC)}$`,\n  style: {\n    fontSize: \"15px\",\n    fill: \"#d32f2f\",\n    fontWeight: \"600\",\n  },\n});\n\nformula1.position({\n  relativeFrom: formula1.center,\n  relativeTo: { x: 300, y: 510 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(formula1);\n\nconst verification = new Latex({\n  content: `$\\\\text{Check: } ${Math.round(BD)}^2 = ${Math.round(BD * BD)} \\\\approx ${Math.round(AD * DC)}$ ✓`,\n  style: {\n    fontSize: \"14px\",\n    fill: \"#2e7d32\",\n    fontWeight: \"500\",\n  },\n});\n\nverification.position({\n  relativeFrom: verification.center,\n  relativeTo: { x: 300, y: 540 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(verification);\n\n\nconst anglesC = calculateAngle(C, A, B);\nconst angleC = new Angle({\n  vertex: C,\n  startAngle: anglesC.start,\n  endAngle: anglesC.end,\n  radius: 30,\n  style: {\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n    fill: \"#e1bee7\",\n    fillOpacity: 0.3,\n  },\n  label: \"$\\\\alpha$\",\n  labelDistance: 45,\n});\ncontainer.addElement(angleC);\n\nconst anglesB = calculateAngle(B, C, A);\nconst angleB = new Angle({\n  vertex: B,\n  startAngle: anglesB.start,\n  endAngle: anglesB.end,\n  radius: 30,\n  style: {\n    stroke: \"#f57c00\",\n    strokeWidth: 2,\n    fill: \"#ffe0b2\",\n    fillOpacity: 0.3,\n  },\n  label: \"$\\\\beta$\",\n  labelDistance: 45,\n});\ncontainer.addElement(angleB);\n\ncontainer.finalizeFreeformLayout();\n\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(container);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw a diagram featuring a large right triangle and add several lines to indicate an altitude. Use a few different colors for the shapes and labels, and ensure the vertices are marked with letters. Add some annotations around the triangle to explain the geometry, and place a title at the top of the image. The background should be light-colored, and the entire composition should be centered."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Triangle,\n  Line,\n  Latex,\n  Circle,\n  Angle,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: 1000,\n  height: 700,\n  backgroundColor: \"#f8f9fa\",\n  boxModel: { padding: 50 },\n});\n\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n  boxModel: { padding: 30 },\n});\n\n\nconst mainTriangle = new Triangle({\n  type: \"right\",\n  a: 240,  // Base BC = 8 units (scaled)\n  b: 180,  // Height AB = 6 units (scaled)\n  orientation: \"bottomLeft\",\n  style: {\n    fill: \"#e3f2fd\",\n    fillOpacity: 0.3,\n    stroke: \"#1976d2\",\n    strokeWidth: 3,\n  },\n});\n\nmainTriangle.position({\n  relativeFrom: mainTriangle.center,\n  relativeTo: { x: 300, y: 250 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(mainTriangle);\n\nconst vertices = mainTriangle.vertices;\nconst A = vertices[0];  // Bottom left (right angle vertex)\nconst B = vertices[1];  // Bottom right\nconst C = vertices[2];  // Top left\n\n\n\nconst AC_dx = C.x - A.x;\nconst AC_dy = C.y - A.y;\nconst AC_length = Math.sqrt(AC_dx * AC_dx + AC_dy * AC_dy);\n\nconst AB_dx = B.x - A.x;\nconst AB_dy = B.y - A.y;\n\nconst projection = (AB_dx * AC_dx + AB_dy * AC_dy) / (AC_length * AC_length);\nconst D = {\n  x: A.x + projection * AC_dx,\n  y: A.y + projection * AC_dy,\n};\n\nconst altitude = new Line({\n  start: B,\n  end: D,\n  style: {\n    stroke: \"#d32f2f\",\n    strokeWidth: 2.5,\n    strokeDasharray: \"6,4\",\n  },\n});\n\ncontainer.addElement(altitude);\n\n\nconst AD = Math.sqrt((D.x - A.x) ** 2 + (D.y - A.y) ** 2);\nconst DC = Math.sqrt((C.x - D.x) ** 2 + (C.y - D.y) ** 2);\nconst BD = Math.sqrt((D.x - B.x) ** 2 + (D.y - B.y) ** 2);\nconst AB = Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2);\nconst BC = Math.sqrt((C.x - B.x) ** 2 + (C.y - B.y) ** 2);\n\nconsole.log(\"=== SIMILAR TRIANGLES ===\");\nconsole.log(\"Main triangle ABC - sides:\", Math.round(AB), Math.round(BC), Math.round(AC_length));\nconsole.log(\"Triangle ADB - altitude:\", Math.round(BD));\nconsole.log(\"Segments: AD =\", Math.round(AD), \", DC =\", Math.round(DC));\nconsole.log(\"Geometric mean check: BD² =\", Math.round(BD * BD), \", AD × DC =\", Math.round(AD * DC));\n\n\nconst vertexLabels = [\n  { point: A, label: \"A\", offset: { x: -25, y: 15 } },\n  { point: B, label: \"B\", offset: { x: 15, y: 15 } },\n  { point: C, label: \"C\", offset: { x: -15, y: -25 } },\n  { point: D, label: \"D\", offset: { x: 0, y: -25 } },\n];\n\nvertexLabels.forEach(({ point, label, offset }) => {\n  const dot = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#1976d2\",\n      stroke: \"#0d47a1\",\n      strokeWidth: 2,\n    },\n  });\n  \n  dot.position({\n    relativeFrom: dot.center,\n    relativeTo: point,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(dot);\n  \n  const text = new Latex({\n    content: `$\\\\mathbf{${label}}$`,\n    style: {\n      fontSize: \"18px\",\n      fontWeight: \"bold\",\n      fill: \"#0d47a1\",\n    },\n  });\n  \n  text.position({\n    relativeFrom: text.center,\n    relativeTo: point,\n    x: offset.x,\n    y: offset.y,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(text);\n});\n\n\nfunction calculateAngle(vertex, point1, point2) {\n  const angle1 = Math.atan2(point1.y - vertex.y, point1.x - vertex.x) * 180 / Math.PI;\n  const angle2 = Math.atan2(point2.y - vertex.y, point2.x - vertex.x) * 180 / Math.PI;\n  return { start: angle1, end: angle2 };\n}\n\nconst anglesA = calculateAngle(A, B, C);\nconst angleA = new Angle({\n  vertex: A,\n  startAngle: anglesA.start,\n  endAngle: anglesA.end,\n  radius: 25,\n  style: {\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n    fill: \"#c8e6c9\",\n    fillOpacity: 0.3,\n  },\n  showRightAngleSquare: true,\n});\ncontainer.addElement(angleA);\n\nconst anglesD = calculateAngle(D, B, A);\nconst angleD = new Angle({\n  vertex: D,\n  startAngle: anglesD.start,\n  endAngle: anglesD.end,\n  radius: 20,\n  style: {\n    stroke: \"#ff9800\",\n    strokeWidth: 2,\n    fill: \"#ffe0b2\",\n    fillOpacity: 0.3,\n  },\n  showRightAngleSquare: true,\n});\ncontainer.addElement(angleD);\n\n\nconst dimensions = [\n  {\n    label: `${Math.round(AB)}`,\n    midpoint: { x: (A.x + B.x) / 2, y: (A.y + B.y) / 2 },\n    offset: { x: 0, y: 25 },\n  },\n  {\n    label: `${Math.round(BC)}`,\n    midpoint: { x: (B.x + C.x) / 2, y: (B.y + C.y) / 2 },\n    offset: { x: 25, y: 0 },\n  },\n  {\n    label: `${Math.round(AC_length)}`,\n    midpoint: { x: (A.x + C.x) / 2, y: (A.y + C.y) / 2 },\n    offset: { x: -30, y: -10 },\n  },\n  {\n    label: `h=${Math.round(BD)}`,\n    midpoint: { x: (B.x + D.x) / 2, y: (B.y + D.y) / 2 },\n    offset: { x: 20, y: 0 },\n    color: \"#d32f2f\",\n  },\n];\n\ndimensions.forEach(({ label, midpoint, offset, color }) => {\n  const dimLabel = new Latex({\n    content: `$\\\\small ${label}$`,\n    style: {\n      fontSize: \"14px\",\n      fill: color || \"#424242\",\n      fontWeight: \"600\",\n    },\n  });\n  \n  dimLabel.position({\n    relativeFrom: dimLabel.center,\n    relativeTo: midpoint,\n    x: offset.x,\n    y: offset.y,\n    boxReference: \"contentBox\",\n  });\n  \n  container.addElement(dimLabel);\n});\n\n\nconst title = new Latex({\n  content: \"$\\\\text{Similar Triangles: Altitude to Hypotenuse}$\",\n  style: {\n    fontSize: \"22px\",\n    fontWeight: \"bold\",\n    fill: \"#1a237e\",\n  },\n});\n\ntitle.position({\n  relativeFrom: title.center,\n  relativeTo: { x: 300, y: 30 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(title);\n\nconst theorem = new Latex({\n  content: `$\\\\triangle ABC \\\\sim \\\\triangle ADB \\\\sim \\\\triangle BDC$`,\n  style: {\n    fontSize: \"16px\",\n    fill: \"#1565c0\",\n    fontWeight: \"600\",\n  },\n});\n\ntheorem.position({\n  relativeFrom: theorem.center,\n  relativeTo: { x: 300, y: 470 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(theorem);\n\nconst formula1 = new Latex({\n  content: `$h^2 = ${Math.round(AD)} \\\\times ${Math.round(DC)} = ${Math.round(AD * DC)}$`,\n  style: {\n    fontSize: \"15px\",\n    fill: \"#d32f2f\",\n    fontWeight: \"600\",\n  },\n});\n\nformula1.position({\n  relativeFrom: formula1.center,\n  relativeTo: { x: 300, y: 510 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(formula1);\n\nconst verification = new Latex({\n  content: `$\\\\text{Check: } ${Math.round(BD)}^2 = ${Math.round(BD * BD)} \\\\approx ${Math.round(AD * DC)}$ ✓`,\n  style: {\n    fontSize: \"14px\",\n    fill: \"#2e7d32\",\n    fontWeight: \"500\",\n  },\n});\n\nverification.position({\n  relativeFrom: verification.center,\n  relativeTo: { x: 300, y: 540 },\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\ncontainer.addElement(verification);\n\n\nconst anglesC = calculateAngle(C, A, B);\nconst angleC = new Angle({\n  vertex: C,\n  startAngle: anglesC.start,\n  endAngle: anglesC.end,\n  radius: 30,\n  style: {\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n    fill: \"#e1bee7\",\n    fillOpacity: 0.3,\n  },\n  label: \"$\\\\alpha$\",\n  labelDistance: 45,\n});\ncontainer.addElement(angleC);\n\nconst anglesB = calculateAngle(B, C, A);\nconst angleB = new Angle({\n  vertex: B,\n  startAngle: anglesB.start,\n  endAngle: anglesB.end,\n  radius: 30,\n  style: {\n    stroke: \"#f57c00\",\n    strokeWidth: 2,\n    fill: \"#ffe0b2\",\n    fillOpacity: 0.3,\n  },\n  label: \"$\\\\beta$\",\n  labelDistance: 45,\n});\ncontainer.addElement(angleB);\n\ncontainer.finalizeFreeformLayout();\n\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n  boxReference: \"contentBox\",\n});\n\nartboard.addElement(container);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual layout with a title reading 'Challenge Problem: Function Intersection & Area' using a bold, dark blue font. Below the title, there should be a horizontal alignment with two main sections. On the left, display a white-background graph container with a light gray border. Inside, include text 'Given Functions:' in bold, dark blue, followed by two functions displayed as '-x^2 + 4' in red and 'x - 2' in blue. Render a graph showing these functions, marked with intersection points at (-3, -5) and (2, 0). Shade the area between the curves in light yellow, highlight the x-axis from -4 to 4, and y-axis from -5 to 5 with a grid and axes in dark gray. On the right, provide a solution explanation in a vertical layout, with steps for finding intersections, factoring, calculating y-coordinates, and estimating the area. Use distinct container colors for each step, like green for intersections, blue for solving, and yellow for area calculation, ensuring all text is readable and appropriately styled."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  FunctionGraph,\n  Text,\n  Latex,\n  Circle,\n  Line,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 50,\n  verticalAlignment: \"top\",\n  boxModel: { padding: 20 },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 60,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst title = new Text({\n  content: \"Challenge Problem: Function Intersection & Area\",\n  fontSize: 28,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\n\nconst graphContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  boxModel: { padding: 25 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(graphContainer);\n\nconst problemTitle = new Text({\n  content: \"Given Functions:\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#283593\" },\n});\n\ngraphContainer.addElement(problemTitle);\n\nconst function1Text = new Latex({\n  content: \"f(x) = -x^2 + 4\",\n  fontSize: 16,\n  style: { fill: \"#d32f2f\" },\n});\n\ngraphContainer.addElement(function1Text);\n\nconst function2Text = new Latex({\n  content: \"g(x) = x - 2\",\n  fontSize: 16,\n  style: { fill: \"#1976d2\" },\n});\n\ngraphContainer.addElement(function2Text);\n\nconst parabola = (x) => -x * x + 4;\nconst line = (x) => x - 2;\n\nconst tempGraph = new FunctionGraph({\n  functions: [\n    { fn: parabola },\n    { fn: line },\n  ],\n  width: 1,\n  height: 1,\n  domain: [-4, 4],\n});\n\nconst intersections = tempGraph.findIntersections(0, 1);\nconst intersectionXs = intersections.map(p => p.x).sort((a, b) => a - b);\n\nconst functionGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: parabola,\n      color: \"#d32f2f\",\n      strokeWidth: 3,\n    },\n    {\n      fn: line,\n      color: \"#1976d2\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 500,\n  height: 450,\n  domain: [-4, 4],\n  range: [-5, 5],\n  showGrid: true,\n  showAxes: true,\n  axisStyle: {\n    stroke: \"#424242\",\n    strokeWidth: 2,\n  },\n  gridStyle: {\n    stroke: \"#e0e0e0\",\n    strokeWidth: 1,\n  },\n  \n  shadedRegions: intersectionXs.length >= 2 ? [\n    {\n      topFunction: 0,  // Parabola is on top\n      bottomFunction: 1,  // Line is on bottom\n      domain: [intersectionXs[0], intersectionXs[1]],  // Computed, not hardcoded!\n      style: {\n        fill: \"#ffd54f\",\n        fillOpacity: 0.25,\n      },\n    },\n  ] : [],\n});\n\ngraphContainer.addElement(functionGraph);\n\nintersections.forEach((point, index) => {\n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#d84315\",\n      strokeWidth: 2,\n    },\n  });\n  \n  const pos = functionGraph.mathToAbsolutePosition(point.x, point.y);\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n});\n\nconst graphLabel = new Text({\n  content: \"The shaded region is bounded by both functions\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n  fontStyle: \"italic\",\n});\n\ngraphContainer.addElement(graphLabel);\n\n\nconst solutionContainer = new Container({\n  width: 650,\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  boxModel: { padding: 30 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(solutionContainer);\n\nconst solutionTitle = new Text({\n  content: \"Step-by-Step Solution\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#283593\" },\n});\n\nsolutionContainer.addElement(solutionTitle);\n\n\nconst step1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step1Container);\n\nconst step1Title = new Text({\n  content: \"Step 1: Find Intersection Points\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2e7d32\" },\n});\n\nstep1Container.addElement(step1Title);\n\nconst step1Text1 = new Text({\n  content: \"Set the functions equal to each other:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text1);\n\nconst step1Eq1 = new Latex({\n  content: \"-x^2 + 4 = x - 2\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq1);\n\nconst step1Text2 = new Text({\n  content: \"Rearrange to standard form:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text2);\n\nconst step1Eq2 = new Latex({\n  content: \"-x^2 - x + 6 = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq2);\n\nconst step1Text3 = new Text({\n  content: \"Or multiply by -1:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text3);\n\nconst step1Eq3 = new Latex({\n  content: \"x^2 + x - 6 = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq3);\n\n\nconst step2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step2Container);\n\nconst step2Title = new Text({\n  content: \"Step 2: Solve Using Factoring or Quadratic Formula\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#1565c0\" },\n});\n\nstep2Container.addElement(step2Title);\n\nconst step2Text1 = new Text({\n  content: \"Method 1: Factoring (find two numbers that multiply to -6 and add to 1)\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep2Container.addElement(step2Text1);\n\nconst step2Eq1 = new Latex({\n  content: \"(x + 3)(x - 2) = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep2Container.addElement(step2Eq1);\n\nconst step2Text2 = new Text({\n  content: \"Therefore:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep2Container.addElement(step2Text2);\n\nconst step2Eq2 = new Latex({\n  content: \"x = -3 \\\\text{ or } x = 2\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#d32f2f\" },\n});\n\nstep2Container.addElement(step2Eq2);\n\n\nconst step3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#ff9800\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step3Container);\n\nconst step3Title = new Text({\n  content: \"Step 3: Calculate Y-Coordinates\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#e65100\" },\n});\n\nstep3Container.addElement(step3Title);\n\nconst step3Text1 = new Text({\n  content: \"Substitute x-values into either function (we'll use g(x) = x - 2):\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep3Container.addElement(step3Text1);\n\nconst step3CalcsContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  horizontalAlignment: \"center\",\n});\n\nstep3Container.addElement(step3CalcsContainer);\n\nconst leftCalc = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n});\n\nstep3CalcsContainer.addElement(leftCalc);\n\nconst leftCalcEq1 = new Latex({\n  content: \"x = -3:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nleftCalc.addElement(leftCalcEq1);\n\nconst leftCalcEq2 = new Latex({\n  content: \"y = -3 - 2 = -5\",\n  fontSize: 14,\n  style: { fill: \"#1a237e\" },\n});\n\nleftCalc.addElement(leftCalcEq2);\n\nconst rightCalc = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n});\n\nstep3CalcsContainer.addElement(rightCalc);\n\nconst rightCalcEq1 = new Latex({\n  content: \"x = 2:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nrightCalc.addElement(rightCalcEq1);\n\nconst rightCalcEq2 = new Latex({\n  content: \"y = 2 - 2 = 0\",\n  fontSize: 14,\n  style: { fill: \"#1a237e\" },\n});\n\nrightCalc.addElement(rightCalcEq2);\n\nconst step3Result = new Latex({\n  content: \"\\\\text{Intersection points: } (-3, -5) \\\\text{ and } (2, 0)\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#d32f2f\", fontWeight: \"bold\" },\n});\n\nstep3Container.addElement(step3Result);\n\n\nconst step4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step4Container);\n\nconst step4Title = new Text({\n  content: \"Step 4: Estimate the Area (Challenge!)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#6a1b9a\" },\n});\n\nstep4Container.addElement(step4Title);\n\nconst step4Text1 = new Text({\n  content: \"The area between the curves can be estimated using geometry:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text1);\n\nconst step4Text2 = new Text({\n  content: \"• Width of region: 2 - (-3) = 5 units\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text2);\n\nconst step4Text3 = new Text({\n  content: \"• Maximum height: approximately 4.1 units (at x ≈ -0.5)\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text3);\n\nconst step4Text4 = new Text({\n  content: \"• Using the trapezoidal approximation:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text4);\n\nconst step4Eq = new Latex({\n  content: \"\\\\text{Area} \\\\approx \\\\frac{5 \\\\times 4.1}{2} \\\\approx 10.25 \\\\text{ square units}\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep4Container.addElement(step4Eq);\n\nconst step4Note = new Text({\n  content: \"Note: The exact area is 125/6 ≈ 20.83 square units (using calculus)\",\n  fontSize: 12,\n  style: { fill: \"#7b1fa2\" },\n  fontStyle: \"italic\",\n});\n\nstep4Container.addElement(step4Note);\n\n\nconst intersectionPoints = [\n  { x: -3, y: -3 - 2 }, // At x=-3: g(-3) = -3 - 2 = -5\n  { x: 2, y: 2 - 2 },   // At x=2: g(2) = 2 - 2 = 0\n];\n\nconsole.log(\"Marking intersection points:\", intersectionPoints);\n\nintersectionPoints.forEach((point, idx) => {\n  const screenPos = functionGraph.mathToAbsolutePosition(point.x, point.y);\n  \n  console.log(`Intersection ${idx} at math coords (${point.x}, ${point.y}) -> screen coords`, screenPos);\n  \n  const marker = new Circle({\n    radius: 8,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#bf360c\",\n      strokeWidth: 3,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: screenPos,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(marker);\n  \n  const label = new Latex({\n    content: `(${Math.round(point.x)}, ${Math.round(point.y)})`,\n    fontSize: 13,\n    style: {\n      fill: \"#bf360c\",\n      fontWeight: \"bold\",\n    },\n  });\n  \n  label.position({\n    relativeFrom: label.center,\n    relativeTo: screenPos,\n    x: idx === 0 ? -35 : 25,\n    y: -15,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(label);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a diagram illustrating a mathematical problem involving intersections and areas. Include a title at the top and below it, arrange the content horizontally. On the left, depict a graph with two functions and their intersection points. Shade the area between the curves. On the right, provide a step-by-step explanation of how the intersections are found and how the area is calculated. Use various colors to differentiate between sections and steps, and ensure text is clear and stands out against the background."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  FunctionGraph,\n  Text,\n  Latex,\n  Circle,\n  Line,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 50,\n  verticalAlignment: \"top\",\n  boxModel: { padding: 20 },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 60,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst title = new Text({\n  content: \"Challenge Problem: Function Intersection & Area\",\n  fontSize: 28,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\ntitle.position({\n  relativeFrom: title.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(title);\n\n\nconst graphContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  boxModel: { padding: 25 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(graphContainer);\n\nconst problemTitle = new Text({\n  content: \"Given Functions:\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#283593\" },\n});\n\ngraphContainer.addElement(problemTitle);\n\nconst function1Text = new Latex({\n  content: \"f(x) = -x^2 + 4\",\n  fontSize: 16,\n  style: { fill: \"#d32f2f\" },\n});\n\ngraphContainer.addElement(function1Text);\n\nconst function2Text = new Latex({\n  content: \"g(x) = x - 2\",\n  fontSize: 16,\n  style: { fill: \"#1976d2\" },\n});\n\ngraphContainer.addElement(function2Text);\n\nconst parabola = (x) => -x * x + 4;\nconst line = (x) => x - 2;\n\nconst tempGraph = new FunctionGraph({\n  functions: [\n    { fn: parabola },\n    { fn: line },\n  ],\n  width: 1,\n  height: 1,\n  domain: [-4, 4],\n});\n\nconst intersections = tempGraph.findIntersections(0, 1);\nconst intersectionXs = intersections.map(p => p.x).sort((a, b) => a - b);\n\nconst functionGraph = new FunctionGraph({\n  functions: [\n    {\n      fn: parabola,\n      color: \"#d32f2f\",\n      strokeWidth: 3,\n    },\n    {\n      fn: line,\n      color: \"#1976d2\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 500,\n  height: 450,\n  domain: [-4, 4],\n  range: [-5, 5],\n  showGrid: true,\n  showAxes: true,\n  axisStyle: {\n    stroke: \"#424242\",\n    strokeWidth: 2,\n  },\n  gridStyle: {\n    stroke: \"#e0e0e0\",\n    strokeWidth: 1,\n  },\n  \n  shadedRegions: intersectionXs.length >= 2 ? [\n    {\n      topFunction: 0,  // Parabola is on top\n      bottomFunction: 1,  // Line is on bottom\n      domain: [intersectionXs[0], intersectionXs[1]],  // Computed, not hardcoded!\n      style: {\n        fill: \"#ffd54f\",\n        fillOpacity: 0.25,\n      },\n    },\n  ] : [],\n});\n\ngraphContainer.addElement(functionGraph);\n\nintersections.forEach((point, index) => {\n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#d84315\",\n      strokeWidth: 2,\n    },\n  });\n  \n  const pos = functionGraph.mathToAbsolutePosition(point.x, point.y);\n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n});\n\nconst graphLabel = new Text({\n  content: \"The shaded region is bounded by both functions\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n  fontStyle: \"italic\",\n});\n\ngraphContainer.addElement(graphLabel);\n\n\nconst solutionContainer = new Container({\n  width: 650,\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 20,\n  boxModel: { padding: 30 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(solutionContainer);\n\nconst solutionTitle = new Text({\n  content: \"Step-by-Step Solution\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#283593\" },\n});\n\nsolutionContainer.addElement(solutionTitle);\n\n\nconst step1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step1Container);\n\nconst step1Title = new Text({\n  content: \"Step 1: Find Intersection Points\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2e7d32\" },\n});\n\nstep1Container.addElement(step1Title);\n\nconst step1Text1 = new Text({\n  content: \"Set the functions equal to each other:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text1);\n\nconst step1Eq1 = new Latex({\n  content: \"-x^2 + 4 = x - 2\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq1);\n\nconst step1Text2 = new Text({\n  content: \"Rearrange to standard form:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text2);\n\nconst step1Eq2 = new Latex({\n  content: \"-x^2 - x + 6 = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq2);\n\nconst step1Text3 = new Text({\n  content: \"Or multiply by -1:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep1Container.addElement(step1Text3);\n\nconst step1Eq3 = new Latex({\n  content: \"x^2 + x - 6 = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep1Container.addElement(step1Eq3);\n\n\nconst step2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step2Container);\n\nconst step2Title = new Text({\n  content: \"Step 2: Solve Using Factoring or Quadratic Formula\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#1565c0\" },\n});\n\nstep2Container.addElement(step2Title);\n\nconst step2Text1 = new Text({\n  content: \"Method 1: Factoring (find two numbers that multiply to -6 and add to 1)\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep2Container.addElement(step2Text1);\n\nconst step2Eq1 = new Latex({\n  content: \"(x + 3)(x - 2) = 0\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep2Container.addElement(step2Eq1);\n\nconst step2Text2 = new Text({\n  content: \"Therefore:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep2Container.addElement(step2Text2);\n\nconst step2Eq2 = new Latex({\n  content: \"x = -3 \\\\text{ or } x = 2\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#d32f2f\" },\n});\n\nstep2Container.addElement(step2Eq2);\n\n\nconst step3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#ff9800\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step3Container);\n\nconst step3Title = new Text({\n  content: \"Step 3: Calculate Y-Coordinates\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#e65100\" },\n});\n\nstep3Container.addElement(step3Title);\n\nconst step3Text1 = new Text({\n  content: \"Substitute x-values into either function (we'll use g(x) = x - 2):\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep3Container.addElement(step3Text1);\n\nconst step3CalcsContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  horizontalAlignment: \"center\",\n});\n\nstep3Container.addElement(step3CalcsContainer);\n\nconst leftCalc = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n});\n\nstep3CalcsContainer.addElement(leftCalc);\n\nconst leftCalcEq1 = new Latex({\n  content: \"x = -3:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nleftCalc.addElement(leftCalcEq1);\n\nconst leftCalcEq2 = new Latex({\n  content: \"y = -3 - 2 = -5\",\n  fontSize: 14,\n  style: { fill: \"#1a237e\" },\n});\n\nleftCalc.addElement(leftCalcEq2);\n\nconst rightCalc = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n});\n\nstep3CalcsContainer.addElement(rightCalc);\n\nconst rightCalcEq1 = new Latex({\n  content: \"x = 2:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nrightCalc.addElement(rightCalcEq1);\n\nconst rightCalcEq2 = new Latex({\n  content: \"y = 2 - 2 = 0\",\n  fontSize: 14,\n  style: { fill: \"#1a237e\" },\n});\n\nrightCalc.addElement(rightCalcEq2);\n\nconst step3Result = new Latex({\n  content: \"\\\\text{Intersection points: } (-3, -5) \\\\text{ and } (2, 0)\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#d32f2f\", fontWeight: \"bold\" },\n});\n\nstep3Container.addElement(step3Result);\n\n\nconst step4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 12,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nsolutionContainer.addElement(step4Container);\n\nconst step4Title = new Text({\n  content: \"Step 4: Estimate the Area (Challenge!)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#6a1b9a\" },\n});\n\nstep4Container.addElement(step4Title);\n\nconst step4Text1 = new Text({\n  content: \"The area between the curves can be estimated using geometry:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text1);\n\nconst step4Text2 = new Text({\n  content: \"• Width of region: 2 - (-3) = 5 units\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text2);\n\nconst step4Text3 = new Text({\n  content: \"• Maximum height: approximately 4.1 units (at x ≈ -0.5)\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text3);\n\nconst step4Text4 = new Text({\n  content: \"• Using the trapezoidal approximation:\",\n  fontSize: 14,\n  style: { fill: \"#424242\" },\n});\n\nstep4Container.addElement(step4Text4);\n\nconst step4Eq = new Latex({\n  content: \"\\\\text{Area} \\\\approx \\\\frac{5 \\\\times 4.1}{2} \\\\approx 10.25 \\\\text{ square units}\",\n  fontSize: 15,\n  displayMode: true,\n  style: { fill: \"#1a237e\" },\n});\n\nstep4Container.addElement(step4Eq);\n\nconst step4Note = new Text({\n  content: \"Note: The exact area is 125/6 ≈ 20.83 square units (using calculus)\",\n  fontSize: 12,\n  style: { fill: \"#7b1fa2\" },\n  fontStyle: \"italic\",\n});\n\nstep4Container.addElement(step4Note);\n\n\nconst intersectionPoints = [\n  { x: -3, y: -3 - 2 }, // At x=-3: g(-3) = -3 - 2 = -5\n  { x: 2, y: 2 - 2 },   // At x=2: g(2) = 2 - 2 = 0\n];\n\nconsole.log(\"Marking intersection points:\", intersectionPoints);\n\nintersectionPoints.forEach((point, idx) => {\n  const screenPos = functionGraph.mathToAbsolutePosition(point.x, point.y);\n  \n  console.log(`Intersection ${idx} at math coords (${point.x}, ${point.y}) -> screen coords`, screenPos);\n  \n  const marker = new Circle({\n    radius: 8,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#bf360c\",\n      strokeWidth: 3,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: screenPos,\n    x: 0,\n    y: 0,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(marker);\n  \n  const label = new Latex({\n    content: `(${Math.round(point.x)}, ${Math.round(point.y)})`,\n    fontSize: 13,\n    style: {\n      fill: \"#bf360c\",\n      fontWeight: \"bold\",\n    },\n  });\n  \n  label.position({\n    relativeFrom: label.center,\n    relativeTo: screenPos,\n    x: idx === 0 ? -35 : 25,\n    y: -15,\n    boxReference: \"contentBox\",\n  });\n  \n  artboard.addElement(label);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization with a white background featuring three examples of shaded regions between function curves. Start with a title 'Shaded Regions Between Curves' in bold, dark slate text, followed by a description in grey text about demonstrating area shading between curves. The first example should display a parabola in red and a straight line in blue, with the region between them shaded in light yellow. It should be inside a horizontal container with a sidebar providing setup details in orange and grey text. The second example is of two sine waves, one in purple and the other in teal, with two regions shaded in light lavender and turquoise respectively, inside a vertical container with padding. The third example shows a parabola with the area under it shaded orange, accompanied by markers and a label 'Minimum' at the local minimum, all inside a main vertical container. Include various colored markers for remarkable points and explanatory notes in green text."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Container,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Shaded Regions Between Curves\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainContainer.addElement(title);\n\nconst description = new Text({\n  content: \"Demonstrating area shading between function curves\",\n  fontSize: 14,\n  style: { fill: \"#7f8c8d\" },\n});\n\nmainContainer.addElement(description);\n\nconst howto = new Text({\n  content: \"Specify topFunction and bottomFunction indices, optional domain, and style\",\n  fontSize: 12,\n  style: { fill: \"#95a5a6\" },\n  fontStyle: \"italic\",\n});\n\nmainContainer.addElement(howto);\n\nconst example1Title = new Text({\n  content: \"Example 1: Parabola and Line (Inside Horizontal Container)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(example1Container);\n\nconst infoPanelLeft = new Container({\n  width: 200,\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#ff9800\",\n    strokeWidth: 1,\n  },\n});\n\nexample1Container.addElement(infoPanelLeft);\n\nconst infoTitle = new Text({\n  content: \"Test Setup\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#e65100\" },\n});\n\ninfoPanelLeft.addElement(infoTitle);\n\nconst infoText = new Text({\n  content: \"Graph is nested inside a horizontal container to test coordinate retrieval in complex layouts.\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n  maxWidth: 180,\n});\n\ninfoPanelLeft.addElement(infoText);\n\nconst graph1 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => -x * x + 4,  // Function 0: parabola\n      color: \"#e74c3c\",\n      strokeWidth: 3,\n    },\n    {\n      fn: (x) => x - 2,  // Function 1: line\n      color: \"#3498db\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [-4, 4],\n  range: [-6, 5],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // Parabola is on top\n      bottomFunction: 1,  // Line is on bottom\n      domain: [-3, 2],  // Shade between intersection points\n      style: {\n        fill: \"#ffd54f\",\n        fillOpacity: 0.3,\n      },\n    },\n  ],\n});\n\nexample1Container.addElement(graph1);\n\nconst roots1 = graph1.getRemarkablePoints(\"root\");\nconsole.log(\"Graph 1 - Roots found:\", roots1.length);\n\nroots1.forEach((root, idx) => {\n  const pos = graph1.getRemarkablePoint(\"root\", idx);\n  if (pos) {\n    console.log(`Root ${idx} at:`, pos, \"math coords:\", root.x, root.y);\n    \n    const hLine = new Rect({\n      width: 40,\n      height: 2,\n      style: { fill: \"#ff5722\", stroke: \"none\" },\n    });\n    \n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(hLine);\n    \n    const vLine = new Rect({\n      width: 2,\n      height: 40,\n      style: { fill: \"#ff5722\", stroke: \"none\" },\n    });\n    \n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(vLine);\n    \n    const marker = new Circle({\n      radius: 6,\n      style: {\n        fill: \"none\",\n        stroke: \"#ff5722\",\n        strokeWidth: 3,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nconst example2Title = new Text({\n  content: \"Example 2: Two Sine Waves (Inside Container with Padding)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 25 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(example2Container);\n\nconst graph2Note = new Text({\n  content: \"Nested in vertical container with 25px padding on all sides\",\n  fontSize: 11,\n  fontStyle: \"italic\",\n  style: { fill: \"#616161\" },\n});\n\nexample2Container.addElement(graph2Note);\n\nconst graph2 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.sin(x),  // Function 0\n      color: \"#9b59b6\",\n      strokeWidth: 3,\n    },\n    {\n      fn: (x) => Math.sin(x - Math.PI / 2),  // Function 1 (cosine)\n      color: \"#1abc9c\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [0, 2 * Math.PI],\n  range: [-1.5, 1.5],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // sin(x) is on top in this region\n      bottomFunction: 1,  // cos(x) is on bottom\n      domain: [0, Math.PI * 3 / 4],  // First region\n      style: {\n        fill: \"#e8daef\",\n        fillOpacity: 0.4,\n      },\n    },\n    {\n      topFunction: 1,  // cos(x) is on top in this region\n      bottomFunction: 0,  // sin(x) is on bottom\n      domain: [Math.PI * 3 / 4, Math.PI * 7 / 4],  // Second region\n      style: {\n        fill: \"#d1f2eb\",\n        fillOpacity: 0.4,\n      },\n    },\n  ],\n});\n\nexample2Container.addElement(graph2);\n\nconst maxima2 = graph2.getRemarkablePoints(\"local-maximum\");\nconst minima2 = graph2.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Graph 2 - Maxima found:\", maxima2.length, \"Minima found:\", minima2.length);\n\nmaxima2.forEach((max, idx) => {\n  const pos = graph2.getRemarkablePoint(\"local-maximum\", idx);\n  if (pos) {\n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"rgba(255, 87, 34, 0.3)\",\n        stroke: \"#ff5722\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nminima2.forEach((min, idx) => {\n  const pos = graph2.getRemarkablePoint(\"local-minimum\", idx);\n  if (pos) {\n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"rgba(33, 150, 243, 0.3)\",\n        stroke: \"#2196f3\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nconst example3Title = new Text({\n  content: \"Example 3: Area Under Curve\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst graph3 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => x * x - 4,  // Function 0\n      color: \"#e67e22\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [-3, 3],\n  range: [-5, 6],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // The parabola\n      domain: [-2, 2],  // Between the roots\n      style: {\n        fill: \"#f39c12\",\n        fillOpacity: 0.3,\n      },\n    },\n  ],\n});\n\nmainContainer.addElement(graph3);\n\nconst minima3 = graph3.getRemarkablePoints(\"local-minimum\");\nconsole.log(\"Graph 3 - Minima found:\", minima3.length);\n\nif (minima3.length > 0) {\n  const pos = graph3.getRemarkablePoint(\"local-minimum\", 0);\n  if (pos) {\n    const bbox = new Rect({\n      width: 40,\n      height: 40,\n      style: {\n        fill: \"rgba(52, 152, 219, 0.2)\",\n        stroke: \"#3498db\",\n        strokeWidth: 2,\n      },\n    });\n    \n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(bbox);\n    \n    const label = new Text({\n      content: \"Minimum\",\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#3498db\" },\n    });\n    \n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 25,\n    });\n    \n    artboard.addElement(label);\n  }\n}\n\nconst debugNote = new Text({\n  content: \"✓ All colored markers show remarkable points retrieved via getRemarkablePoint() API\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#27ae60\" },\n});\n\nmainContainer.addElement(debugNote);\n\nconst debugNote2 = new Text({\n  content: \"✓ Graphs are nested in containers with padding to test coordinate transformation\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#27ae60\" },\n});\n\nmainContainer.addElement(debugNote2);\n\nconst debugNote3 = new Text({\n  content: \"Red dots = auto-rendered remarkable points. Colored markers = manually positioned using API.\",\n  fontSize: 11,\n  fontStyle: \"italic\",\n  style: { fill: \"#7f8c8d\" },\n});\n\nmainContainer.addElement(debugNote3);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a visualization that includes several graphs with shaded areas between curves. Use various colors for the different lines and shaded regions. Feature some informative sections with text explanations. Arrange the graphs in containers with different orientations and spacing to show distinctions in layout. Incorporate various markers to highlight interesting points on the graphs and include annotations for clarity."},{"role":"assistant","content":"import {\n  Artboard,\n  FunctionGraph,\n  Text,\n  Container,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Shaded Regions Between Curves\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainContainer.addElement(title);\n\nconst description = new Text({\n  content: \"Demonstrating area shading between function curves\",\n  fontSize: 14,\n  style: { fill: \"#7f8c8d\" },\n});\n\nmainContainer.addElement(description);\n\nconst howto = new Text({\n  content: \"Specify topFunction and bottomFunction indices, optional domain, and style\",\n  fontSize: 12,\n  style: { fill: \"#95a5a6\" },\n  fontStyle: \"italic\",\n});\n\nmainContainer.addElement(howto);\n\nconst example1Title = new Text({\n  content: \"Example 1: Parabola and Line (Inside Horizontal Container)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(example1Container);\n\nconst infoPanelLeft = new Container({\n  width: 200,\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#ff9800\",\n    strokeWidth: 1,\n  },\n});\n\nexample1Container.addElement(infoPanelLeft);\n\nconst infoTitle = new Text({\n  content: \"Test Setup\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#e65100\" },\n});\n\ninfoPanelLeft.addElement(infoTitle);\n\nconst infoText = new Text({\n  content: \"Graph is nested inside a horizontal container to test coordinate retrieval in complex layouts.\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n  maxWidth: 180,\n});\n\ninfoPanelLeft.addElement(infoText);\n\nconst graph1 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => -x * x + 4,  // Function 0: parabola\n      color: \"#e74c3c\",\n      strokeWidth: 3,\n    },\n    {\n      fn: (x) => x - 2,  // Function 1: line\n      color: \"#3498db\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [-4, 4],\n  range: [-6, 5],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // Parabola is on top\n      bottomFunction: 1,  // Line is on bottom\n      domain: [-3, 2],  // Shade between intersection points\n      style: {\n        fill: \"#ffd54f\",\n        fillOpacity: 0.3,\n      },\n    },\n  ],\n});\n\nexample1Container.addElement(graph1);\n\nconst roots1 = graph1.getRemarkablePoints(\"root\");\nconsole.log(\"Graph 1 - Roots found:\", roots1.length);\n\nroots1.forEach((root, idx) => {\n  const pos = graph1.getRemarkablePoint(\"root\", idx);\n  if (pos) {\n    console.log(`Root ${idx} at:`, pos, \"math coords:\", root.x, root.y);\n    \n    const hLine = new Rect({\n      width: 40,\n      height: 2,\n      style: { fill: \"#ff5722\", stroke: \"none\" },\n    });\n    \n    hLine.position({\n      relativeFrom: hLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(hLine);\n    \n    const vLine = new Rect({\n      width: 2,\n      height: 40,\n      style: { fill: \"#ff5722\", stroke: \"none\" },\n    });\n    \n    vLine.position({\n      relativeFrom: vLine.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(vLine);\n    \n    const marker = new Circle({\n      radius: 6,\n      style: {\n        fill: \"none\",\n        stroke: \"#ff5722\",\n        strokeWidth: 3,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nconst example2Title = new Text({\n  content: \"Example 2: Two Sine Waves (Inside Container with Padding)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 25 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(example2Container);\n\nconst graph2Note = new Text({\n  content: \"Nested in vertical container with 25px padding on all sides\",\n  fontSize: 11,\n  fontStyle: \"italic\",\n  style: { fill: \"#616161\" },\n});\n\nexample2Container.addElement(graph2Note);\n\nconst graph2 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => Math.sin(x),  // Function 0\n      color: \"#9b59b6\",\n      strokeWidth: 3,\n    },\n    {\n      fn: (x) => Math.sin(x - Math.PI / 2),  // Function 1 (cosine)\n      color: \"#1abc9c\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [0, 2 * Math.PI],\n  range: [-1.5, 1.5],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // sin(x) is on top in this region\n      bottomFunction: 1,  // cos(x) is on bottom\n      domain: [0, Math.PI * 3 / 4],  // First region\n      style: {\n        fill: \"#e8daef\",\n        fillOpacity: 0.4,\n      },\n    },\n    {\n      topFunction: 1,  // cos(x) is on top in this region\n      bottomFunction: 0,  // sin(x) is on bottom\n      domain: [Math.PI * 3 / 4, Math.PI * 7 / 4],  // Second region\n      style: {\n        fill: \"#d1f2eb\",\n        fillOpacity: 0.4,\n      },\n    },\n  ],\n});\n\nexample2Container.addElement(graph2);\n\nconst maxima2 = graph2.getRemarkablePoints(\"local-maximum\");\nconst minima2 = graph2.getRemarkablePoints(\"local-minimum\");\n\nconsole.log(\"Graph 2 - Maxima found:\", maxima2.length, \"Minima found:\", minima2.length);\n\nmaxima2.forEach((max, idx) => {\n  const pos = graph2.getRemarkablePoint(\"local-maximum\", idx);\n  if (pos) {\n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"rgba(255, 87, 34, 0.3)\",\n        stroke: \"#ff5722\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nminima2.forEach((min, idx) => {\n  const pos = graph2.getRemarkablePoint(\"local-minimum\", idx);\n  if (pos) {\n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"rgba(33, 150, 243, 0.3)\",\n        stroke: \"#2196f3\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n  }\n});\n\nconst example3Title = new Text({\n  content: \"Example 3: Area Under Curve\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#34495e\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst graph3 = new FunctionGraph({\n  functions: [\n    {\n      fn: (x) => x * x - 4,  // Function 0\n      color: \"#e67e22\",\n      strokeWidth: 3,\n    },\n  ],\n  width: 600,\n  height: 400,\n  domain: [-3, 3],\n  range: [-5, 6],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,  // Auto-render remarkable points\n  \n  shadedRegions: [\n    {\n      topFunction: 0,  // The parabola\n      domain: [-2, 2],  // Between the roots\n      style: {\n        fill: \"#f39c12\",\n        fillOpacity: 0.3,\n      },\n    },\n  ],\n});\n\nmainContainer.addElement(graph3);\n\nconst minima3 = graph3.getRemarkablePoints(\"local-minimum\");\nconsole.log(\"Graph 3 - Minima found:\", minima3.length);\n\nif (minima3.length > 0) {\n  const pos = graph3.getRemarkablePoint(\"local-minimum\", 0);\n  if (pos) {\n    const bbox = new Rect({\n      width: 40,\n      height: 40,\n      style: {\n        fill: \"rgba(52, 152, 219, 0.2)\",\n        stroke: \"#3498db\",\n        strokeWidth: 2,\n      },\n    });\n    \n    bbox.position({\n      relativeFrom: bbox.center,\n      relativeTo: pos,\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(bbox);\n    \n    const label = new Text({\n      content: \"Minimum\",\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#3498db\" },\n    });\n    \n    label.position({\n      relativeFrom: label.topCenter,\n      relativeTo: pos,\n      x: 0,\n      y: 25,\n    });\n    \n    artboard.addElement(label);\n  }\n}\n\nconst debugNote = new Text({\n  content: \"✓ All colored markers show remarkable points retrieved via getRemarkablePoint() API\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#27ae60\" },\n});\n\nmainContainer.addElement(debugNote);\n\nconst debugNote2 = new Text({\n  content: \"✓ Graphs are nested in containers with padding to test coordinate transformation\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#27ae60\" },\n});\n\nmainContainer.addElement(debugNote2);\n\nconst debugNote3 = new Text({\n  content: \"Red dots = auto-rendered remarkable points. Colored markers = manually positioned using API.\",\n  fontSize: 11,\n  fontStyle: \"italic\",\n  style: { fill: \"#7f8c8d\" },\n});\n\nmainContainer.addElement(debugNote3);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a 3x3 grid of graphs showcasing various trigonometric functions. Each cell should have a title at the top in bold with specific colors for each graph: sin(x) in blue, cos(x) in green, tan(x) in orange, csc(x) in purple, sec(x) in teal, cot(x) in pink, sin(2x) in light blue, sin(x) × cos(x) in yellow, and sin³(x) in dark orange. The domain and range vary for each function, and red dots should indicate roots, maxima, minima, asymptotes, and inflection points. Include a title at the top in dark blue and a subtitle explaining the red dots. Also, add a legend at the bottom explaining the types of remarkable points with horizontal layout, light gray background, and a border."},{"role":"assistant","content":"import {\n  Artboard,\n  Grid,\n  FunctionGraph,\n  Text,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Trigonometry: Remarkable Points Showcase\",\n  fontSize: 28,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Red dots show auto-detected remarkable points: roots, maxima, minima, asymptotes, and inflection points\",\n  fontSize: 14,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\nconst grid = new Grid({\n  rows: 3,\n  columns: 3,\n  width: 1200,\n  height: 1050,\n  cellWidth: 380,\n  cellHeight: 330,\n  gutter: 10,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 1,\n  },\n});\n\nmainContainer.addElement(grid.container);\n\nfunction createTrigCell(row, col, title, fn, color, domain, range, note) {\n  const cell = grid.getCell(row, col);\n  \n  const titleText = new Text({\n    content: title,\n    fontSize: 16,\n    fontWeight: \"bold\",\n    style: { fill: color },\n  });\n  \n  titleText.position({\n    relativeFrom: titleText.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: -140, // Position near top of cell\n  });\n  \n  cell.addElement(titleText);\n  \n  const graph = new FunctionGraph({\n    functions: {\n      fn: fn,\n      color: color,\n      strokeWidth: 2.5,\n    },\n    width: 340,\n    height: 240,\n    domain: domain,\n    range: range,\n    showGrid: true,\n    showAxes: true,\n    detectRemarkablePoints: true,\n    showRemarkablePoints: true,\n    remarkablePointStyle: {\n      fill: \"#e74c3c\",\n      stroke: \"#c0392b\",\n      strokeWidth: 2,\n    },\n  });\n  \n  graph.position({\n    relativeFrom: graph.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: -10, // Center of cell\n  });\n  \n  cell.addElement(graph);\n  \n  const noteText = new Text({\n    content: note,\n    fontSize: 10,\n    style: { fill: \"#7f8c8d\" },\n    fontStyle: \"italic\",\n    maxWidth: 340,\n  });\n  \n  noteText.position({\n    relativeFrom: noteText.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: 140, // Position near bottom of cell\n  });\n  \n  cell.addElement(noteText);\n}\n\n\ncreateTrigCell(\n  0, 0,\n  \"sin(x)\",\n  (x) => Math.sin(x),\n  \"#1976d2\",\n  [-Math.PI * 2, Math.PI * 2],\n  [-1.5, 1.5],\n  \"Max at π/2, Min at 3π/2, Roots at nπ\"\n);\n\ncreateTrigCell(\n  0, 1,\n  \"cos(x)\",\n  (x) => Math.cos(x),\n  \"#2ecc71\",\n  [-Math.PI * 2, Math.PI * 2],\n  [-1.5, 1.5],\n  \"Max at 0, 2π, Min at π, Roots at π/2 + nπ\"\n);\n\ncreateTrigCell(\n  0, 2,\n  \"tan(x)\",\n  (x) => Math.tan(x),\n  \"#e67e22\",\n  [-Math.PI, Math.PI],\n  [-4, 4],\n  \"Asymptotes at ±π/2, Roots at nπ\"\n);\n\n\ncreateTrigCell(\n  1, 0,\n  \"csc(x) = 1/sin(x)\",\n  (x) => 1 / Math.sin(x),\n  \"#9b59b6\",\n  [0.1, Math.PI * 2 - 0.1],\n  [-4, 4],\n  \"Asymptotes at nπ (zeros of sin)\"\n);\n\ncreateTrigCell(\n  1, 1,\n  \"sec(x) = 1/cos(x)\",\n  (x) => 1 / Math.cos(x),\n  \"#1abc9c\",\n  [-Math.PI / 2 + 0.2, Math.PI / 2 - 0.2],\n  [-6, 6],\n  \"Asymptotes at π/2 + nπ (zeros of cos)\"\n);\n\ncreateTrigCell(\n  1, 2,\n  \"cot(x) = 1/tan(x)\",\n  (x) => 1 / Math.tan(x),\n  \"#e84393\",\n  [0.1, Math.PI - 0.1],\n  [-4, 4],\n  \"Asymptotes at nπ (zeros of tan)\"\n);\n\n\ncreateTrigCell(\n  2, 0,\n  \"sin(2x)\",\n  (x) => Math.sin(2 * x),\n  \"#3498db\",\n  [-Math.PI, Math.PI],\n  [-1.5, 1.5],\n  \"Double frequency: 4 extrema in [-π, π]\"\n);\n\ncreateTrigCell(\n  2, 1,\n  \"sin(x) × cos(x)\",\n  (x) => Math.sin(x) * Math.cos(x),\n  \"#f39c12\",\n  [-Math.PI, Math.PI],\n  [-0.6, 0.6],\n  \"= sin(2x)/2, extrema at π/4 + nπ/2\"\n);\n\ncreateTrigCell(\n  2, 2,\n  \"sin³(x)\",\n  (x) => Math.pow(Math.sin(x), 3),\n  \"#d35400\",\n  [-Math.PI, Math.PI],\n  [-1.2, 1.2],\n  \"Cubic power: sharper peaks, inflection points\"\n);\n\n\nconst legendTitle = new Text({\n  content: \"Remarkable Point Types:\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainContainer.addElement(legendTitle);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 40,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#bdc3c7\",\n    strokeWidth: 1,\n  },\n});\n\nmainContainer.addElement(legendContainer);\n\nconst legendItems = [\n  { label: \"🔴 Roots\", desc: \"f(x) = 0 (x-intercepts)\" },\n  { label: \"🔴 Maxima\", desc: \"Local maximum points\" },\n  { label: \"🔴 Minima\", desc: \"Local minimum points\" },\n  { label: \"🔴 Asymptotes\", desc: \"f(x) → ±∞\" },\n  { label: \"🔴 Inflection\", desc: \"Concavity change\" },\n];\n\nlegendItems.forEach(item => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"vertical\",\n    spacing: 5,\n  });\n  \n  const itemLabel = new Text({\n    content: item.label,\n    fontSize: 13,\n    fontWeight: \"bold\",\n    style: { fill: \"#2c3e50\" },\n  });\n  \n  itemContainer.addElement(itemLabel);\n  \n  const itemDesc = new Text({\n    content: item.desc,\n    fontSize: 11,\n    style: { fill: \"#7f8c8d\" },\n  });\n  \n  itemContainer.addElement(itemDesc);\n  \n  legendContainer.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw several graphs of trigonometric functions in a grid layout. Each graph should have a descriptive title above it and use different colors. Highlight important points like maximums and minimums on the graphs. Include a main title and subtitle at the top, and a legend at the bottom that explains the highlighted points. Use a consistent style and color scheme throughout the visualization."},{"role":"assistant","content":"import {\n  Artboard,\n  Grid,\n  FunctionGraph,\n  Text,\n  Container,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Trigonometry: Remarkable Points Showcase\",\n  fontSize: 28,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Red dots show auto-detected remarkable points: roots, maxima, minima, asymptotes, and inflection points\",\n  fontSize: 14,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\nconst grid = new Grid({\n  rows: 3,\n  columns: 3,\n  width: 1200,\n  height: 1050,\n  cellWidth: 380,\n  cellHeight: 330,\n  gutter: 10,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 1,\n  },\n});\n\nmainContainer.addElement(grid.container);\n\nfunction createTrigCell(row, col, title, fn, color, domain, range, note) {\n  const cell = grid.getCell(row, col);\n  \n  const titleText = new Text({\n    content: title,\n    fontSize: 16,\n    fontWeight: \"bold\",\n    style: { fill: color },\n  });\n  \n  titleText.position({\n    relativeFrom: titleText.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: -140, // Position near top of cell\n  });\n  \n  cell.addElement(titleText);\n  \n  const graph = new FunctionGraph({\n    functions: {\n      fn: fn,\n      color: color,\n      strokeWidth: 2.5,\n    },\n    width: 340,\n    height: 240,\n    domain: domain,\n    range: range,\n    showGrid: true,\n    showAxes: true,\n    detectRemarkablePoints: true,\n    showRemarkablePoints: true,\n    remarkablePointStyle: {\n      fill: \"#e74c3c\",\n      stroke: \"#c0392b\",\n      strokeWidth: 2,\n    },\n  });\n  \n  graph.position({\n    relativeFrom: graph.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: -10, // Center of cell\n  });\n  \n  cell.addElement(graph);\n  \n  const noteText = new Text({\n    content: note,\n    fontSize: 10,\n    style: { fill: \"#7f8c8d\" },\n    fontStyle: \"italic\",\n    maxWidth: 340,\n  });\n  \n  noteText.position({\n    relativeFrom: noteText.center,\n    relativeTo: cell.contentBox.center,\n    x: 0,\n    y: 140, // Position near bottom of cell\n  });\n  \n  cell.addElement(noteText);\n}\n\n\ncreateTrigCell(\n  0, 0,\n  \"sin(x)\",\n  (x) => Math.sin(x),\n  \"#1976d2\",\n  [-Math.PI * 2, Math.PI * 2],\n  [-1.5, 1.5],\n  \"Max at π/2, Min at 3π/2, Roots at nπ\"\n);\n\ncreateTrigCell(\n  0, 1,\n  \"cos(x)\",\n  (x) => Math.cos(x),\n  \"#2ecc71\",\n  [-Math.PI * 2, Math.PI * 2],\n  [-1.5, 1.5],\n  \"Max at 0, 2π, Min at π, Roots at π/2 + nπ\"\n);\n\ncreateTrigCell(\n  0, 2,\n  \"tan(x)\",\n  (x) => Math.tan(x),\n  \"#e67e22\",\n  [-Math.PI, Math.PI],\n  [-4, 4],\n  \"Asymptotes at ±π/2, Roots at nπ\"\n);\n\n\ncreateTrigCell(\n  1, 0,\n  \"csc(x) = 1/sin(x)\",\n  (x) => 1 / Math.sin(x),\n  \"#9b59b6\",\n  [0.1, Math.PI * 2 - 0.1],\n  [-4, 4],\n  \"Asymptotes at nπ (zeros of sin)\"\n);\n\ncreateTrigCell(\n  1, 1,\n  \"sec(x) = 1/cos(x)\",\n  (x) => 1 / Math.cos(x),\n  \"#1abc9c\",\n  [-Math.PI / 2 + 0.2, Math.PI / 2 - 0.2],\n  [-6, 6],\n  \"Asymptotes at π/2 + nπ (zeros of cos)\"\n);\n\ncreateTrigCell(\n  1, 2,\n  \"cot(x) = 1/tan(x)\",\n  (x) => 1 / Math.tan(x),\n  \"#e84393\",\n  [0.1, Math.PI - 0.1],\n  [-4, 4],\n  \"Asymptotes at nπ (zeros of tan)\"\n);\n\n\ncreateTrigCell(\n  2, 0,\n  \"sin(2x)\",\n  (x) => Math.sin(2 * x),\n  \"#3498db\",\n  [-Math.PI, Math.PI],\n  [-1.5, 1.5],\n  \"Double frequency: 4 extrema in [-π, π]\"\n);\n\ncreateTrigCell(\n  2, 1,\n  \"sin(x) × cos(x)\",\n  (x) => Math.sin(x) * Math.cos(x),\n  \"#f39c12\",\n  [-Math.PI, Math.PI],\n  [-0.6, 0.6],\n  \"= sin(2x)/2, extrema at π/4 + nπ/2\"\n);\n\ncreateTrigCell(\n  2, 2,\n  \"sin³(x)\",\n  (x) => Math.pow(Math.sin(x), 3),\n  \"#d35400\",\n  [-Math.PI, Math.PI],\n  [-1.2, 1.2],\n  \"Cubic power: sharper peaks, inflection points\"\n);\n\n\nconst legendTitle = new Text({\n  content: \"Remarkable Point Types:\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nmainContainer.addElement(legendTitle);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 40,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#bdc3c7\",\n    strokeWidth: 1,\n  },\n});\n\nmainContainer.addElement(legendContainer);\n\nconst legendItems = [\n  { label: \"🔴 Roots\", desc: \"f(x) = 0 (x-intercepts)\" },\n  { label: \"🔴 Maxima\", desc: \"Local maximum points\" },\n  { label: \"🔴 Minima\", desc: \"Local minimum points\" },\n  { label: \"🔴 Asymptotes\", desc: \"f(x) → ±∞\" },\n  { label: \"🔴 Inflection\", desc: \"Concavity change\" },\n];\n\nlegendItems.forEach(item => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"vertical\",\n    spacing: 5,\n  });\n  \n  const itemLabel = new Text({\n    content: item.label,\n    fontSize: 13,\n    fontWeight: \"bold\",\n    style: { fill: \"#2c3e50\" },\n  });\n  \n  itemContainer.addElement(itemLabel);\n  \n  const itemDesc = new Text({\n    content: item.desc,\n    fontSize: 11,\n    style: { fill: \"#7f8c8d\" },\n  });\n  \n  itemContainer.addElement(itemDesc);\n  \n  legendContainer.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and padding of 40. Add a vertical main container with spacing of 40. Inside, display a title 'Vertical Bar Chart: Monthly Sales Data' in bold blue font, size 24. Add four examples: 1. A basic vertical bar chart titled '1. Basic Vertical Bar Chart' with data for each month from January to June, blue bars, and notable points detection. 2. A chart titled '2. With Remarkable Points & Custom Annotations', showing product data with green bars and highlight remarkable points using orange and brown. 3. A chart titled '3. Custom Colors Per Bar (Performance Status)' where bars are colored green, orange, or red based on value, including a legend explaining the colors. 4. A chart titled '4. Highlighting Specific Data Points' depicting daily data for a week with a star and 'Peak Day!' annotation on Friday's data using an orange circle with dashed lines."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Vertical Bar Chart: Monthly Sales Data\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Basic Vertical Bar Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst basicChart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n    { label: \"Apr\", value: 67 },\n    { label: \"May\", value: 73 },\n    { label: \"Jun\", value: 81 },\n  ],\n  orientation: \"vertical\",\n  width: 600,\n  height: 350,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nmainContainer.addElement(basicChart);\n\n\nconst example2Title = new Text({\n  content: \"2. With Remarkable Points & Custom Annotations\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst annotatedChart = new BarChart({\n  data: [\n    { label: \"Product A\", value: 125 },\n    { label: \"Product B\", value: 89 },\n    { label: \"Product C\", value: 156 },\n    { label: \"Product D\", value: 67 },\n    { label: \"Product E\", value: 142 },\n    { label: \"Product F\", value: 98 },\n  ],\n  orientation: \"vertical\",\n  width: 700,\n  height: 400,\n  barColor: \"#4caf50\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  remarkablePointStyle: {\n    fill: \"#ff5722\",\n    stroke: \"#d84315\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(annotatedChart);\n\nconst remarkablePoints = annotatedChart.getRemarkablePoints();\n\nremarkablePoints.forEach((point) => {\n  if (point.type === \"maximum\" || point.type === \"minimum\") {\n    const pos = annotatedChart.getRemarkablePointPosition(point);\n\n    const label = new Text({\n      content: point.type === \"maximum\" ? \"Best Seller!\" : \"Needs Attention\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: {\n        fill: point.type === \"maximum\" ? \"#2e7d32\" : \"#c62828\",\n      },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 0,\n      y: -15,\n    });\n\n    artboard.addElement(label);\n\n    const line = new Line({\n      start: { x: 0, y: 0 },\n      end: { x: 0, y: 5 },\n      style: {\n        stroke: point.type === \"maximum\" ? \"#2e7d32\" : \"#c62828\",\n        strokeWidth: \"2\",\n      },\n    });\n\n    line.position({\n      relativeFrom: line.start,\n      relativeTo: { x: pos.x, y: pos.y - 10 },\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(line);\n  }\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Custom Colors Per Bar (Performance Status)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst coloredChart = new BarChart({\n  data: [\n    { label: \"Q1\", value: 85, color: \"#4caf50\" }, // Green - Good\n    { label: \"Q2\", value: 92, color: \"#4caf50\" }, // Green - Good\n    { label: \"Q3\", value: 67, color: \"#ff9800\" }, // Orange - Warning\n    { label: \"Q4\", value: 45, color: \"#f44336\" }, // Red - Critical\n  ],\n  orientation: \"vertical\",\n  width: 500,\n  height: 350,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  gridLineCount: 4,\n  chartPadding: {\n    top: 30,\n    right: 30,\n    bottom: 50,\n    left: 70,\n  },\n});\n\nmainContainer.addElement(coloredChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legendContainer);\n\nconst legendItems = [\n  { color: \"#4caf50\", label: \"Good (≥80)\" },\n  { color: \"#ff9800\", label: \"Warning (60-79)\" },\n  { color: \"#f44336\", label: \"Critical (<60)\" },\n];\n\nlegendItems.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legendContainer.addElement(itemContainer);\n});\n\n\nconst example4Title = new Text({\n  content: \"4. Highlighting Specific Data Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example4Title);\n\nconst highlightChart = new BarChart({\n  data: [\n    { label: \"Mon\", value: 34 },\n    { label: \"Tue\", value: 42 },\n    { label: \"Wed\", value: 51 },\n    { label: \"Thu\", value: 38 },\n    { label: \"Fri\", value: 65 },\n    { label: \"Sat\", value: 28 },\n    { label: \"Sun\", value: 31 },\n  ],\n  orientation: \"vertical\",\n  width: 750,\n  height: 350,\n  barColor: \"#9e9e9e\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  detectRemarkablePoints: false,\n});\n\nmainContainer.addElement(highlightChart);\n\nconst bars = highlightChart.getBars();\nconst fridayBar = bars[4]; // Index 4 is Friday\n\nif (fridayBar) {\n  const star = new Text({\n    content: \"⭐\",\n    fontSize: 28,\n  });\n\n  star.position({\n    relativeFrom: star.center,\n    relativeTo: fridayBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -25,\n  });\n\n  artboard.addElement(star);\n\n  const annotation = new Text({\n    content: \"Peak Day!\",\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#ff6f00\" },\n  });\n\n  annotation.position({\n    relativeFrom: annotation.center,\n    relativeTo: fridayBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -50,\n  });\n\n  artboard.addElement(annotation);\n\n  const highlight = new Circle({\n    radius: 30,\n    style: {\n      fill: \"none\",\n      stroke: \"#ff6f00\",\n      strokeWidth: 3,\n      strokeDasharray: \"5,5\",\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.center,\n    relativeTo: fridayBar.center,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n}\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization containing several vertical bar charts with different styles and annotations. Include some titles and labels for each chart and have grids, axes, and legends where needed. Use various colors to differentiate the bars and highlight certain data points with symbols or annotations. Ensure there's a noticeable difference between data with varying significance or performance statuses. Make sure to include sections that identify and highlight peak or remarkable data visually."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Vertical Bar Chart: Monthly Sales Data\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Basic Vertical Bar Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst basicChart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n    { label: \"Apr\", value: 67 },\n    { label: \"May\", value: 73 },\n    { label: \"Jun\", value: 81 },\n  ],\n  orientation: \"vertical\",\n  width: 600,\n  height: 350,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nmainContainer.addElement(basicChart);\n\n\nconst example2Title = new Text({\n  content: \"2. With Remarkable Points & Custom Annotations\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst annotatedChart = new BarChart({\n  data: [\n    { label: \"Product A\", value: 125 },\n    { label: \"Product B\", value: 89 },\n    { label: \"Product C\", value: 156 },\n    { label: \"Product D\", value: 67 },\n    { label: \"Product E\", value: 142 },\n    { label: \"Product F\", value: 98 },\n  ],\n  orientation: \"vertical\",\n  width: 700,\n  height: 400,\n  barColor: \"#4caf50\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  remarkablePointStyle: {\n    fill: \"#ff5722\",\n    stroke: \"#d84315\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.addElement(annotatedChart);\n\nconst remarkablePoints = annotatedChart.getRemarkablePoints();\n\nremarkablePoints.forEach((point) => {\n  if (point.type === \"maximum\" || point.type === \"minimum\") {\n    const pos = annotatedChart.getRemarkablePointPosition(point);\n\n    const label = new Text({\n      content: point.type === \"maximum\" ? \"Best Seller!\" : \"Needs Attention\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: {\n        fill: point.type === \"maximum\" ? \"#2e7d32\" : \"#c62828\",\n      },\n    });\n\n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 0,\n      y: -15,\n    });\n\n    artboard.addElement(label);\n\n    const line = new Line({\n      start: { x: 0, y: 0 },\n      end: { x: 0, y: 5 },\n      style: {\n        stroke: point.type === \"maximum\" ? \"#2e7d32\" : \"#c62828\",\n        strokeWidth: \"2\",\n      },\n    });\n\n    line.position({\n      relativeFrom: line.start,\n      relativeTo: { x: pos.x, y: pos.y - 10 },\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n\n    artboard.addElement(line);\n  }\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Custom Colors Per Bar (Performance Status)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst coloredChart = new BarChart({\n  data: [\n    { label: \"Q1\", value: 85, color: \"#4caf50\" }, // Green - Good\n    { label: \"Q2\", value: 92, color: \"#4caf50\" }, // Green - Good\n    { label: \"Q3\", value: 67, color: \"#ff9800\" }, // Orange - Warning\n    { label: \"Q4\", value: 45, color: \"#f44336\" }, // Red - Critical\n  ],\n  orientation: \"vertical\",\n  width: 500,\n  height: 350,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  gridLineCount: 4,\n  chartPadding: {\n    top: 30,\n    right: 30,\n    bottom: 50,\n    left: 70,\n  },\n});\n\nmainContainer.addElement(coloredChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legendContainer);\n\nconst legendItems = [\n  { color: \"#4caf50\", label: \"Good (≥80)\" },\n  { color: \"#ff9800\", label: \"Warning (60-79)\" },\n  { color: \"#f44336\", label: \"Critical (<60)\" },\n];\n\nlegendItems.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legendContainer.addElement(itemContainer);\n});\n\n\nconst example4Title = new Text({\n  content: \"4. Highlighting Specific Data Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example4Title);\n\nconst highlightChart = new BarChart({\n  data: [\n    { label: \"Mon\", value: 34 },\n    { label: \"Tue\", value: 42 },\n    { label: \"Wed\", value: 51 },\n    { label: \"Thu\", value: 38 },\n    { label: \"Fri\", value: 65 },\n    { label: \"Sat\", value: 28 },\n    { label: \"Sun\", value: 31 },\n  ],\n  orientation: \"vertical\",\n  width: 750,\n  height: 350,\n  barColor: \"#9e9e9e\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  detectRemarkablePoints: false,\n});\n\nmainContainer.addElement(highlightChart);\n\nconst bars = highlightChart.getBars();\nconst fridayBar = bars[4]; // Index 4 is Friday\n\nif (fridayBar) {\n  const star = new Text({\n    content: \"⭐\",\n    fontSize: 28,\n  });\n\n  star.position({\n    relativeFrom: star.center,\n    relativeTo: fridayBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -25,\n  });\n\n  artboard.addElement(star);\n\n  const annotation = new Text({\n    content: \"Peak Day!\",\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#ff6f00\" },\n  });\n\n  annotation.position({\n    relativeFrom: annotation.center,\n    relativeTo: fridayBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -50,\n  });\n\n  artboard.addElement(annotation);\n\n  const highlight = new Circle({\n    radius: 30,\n    style: {\n      fill: \"none\",\n      stroke: \"#ff6f00\",\n      strokeWidth: 3,\n      strokeDasharray: \"5,5\",\n    },\n  });\n\n  highlight.position({\n    relativeFrom: highlight.center,\n    relativeTo: fridayBar.center,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(highlight);\n}\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and some padding. Add a vertical layout container with spacing between items. Display a main title 'Horizontal Bar Charts: Country Statistics' in a bold, dark blue font. Include a subtitle in a smaller, dark gray font explaining the chart's orientation. Create four sections with titles. The first section is '1. Population by Country (millions)' with a horizontal bar chart comparing the populations of 'United States', 'Brazil', 'Japan', 'Germany', and 'United Kingdom'. Use blue bars and include grid lines and axes, but don't display value labels. The second section is '2. Technology Adoption Rate (%) with Remarkable Points'. Show a horizontal bar chart with categories like 'Artificial Intelligence', 'Cloud Computing', and others, using teal bars. Highlight the maximum and minimum values with badges. The third section is '3. Project Completion Status' with a chart of task completion rates using various colors. Add a vertical dashed line to indicate a 75% target. Finally, the fourth section '4. Revenue Comparison (with percentage change)' shows a chart with purple bars for different product lines, and add percentage change badges next to each bar, using green for positive and red for negative changes."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Horizontal Bar Charts: Country Statistics\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Horizontal orientation is ideal for comparing categories with long labels\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\n\nconst example1Title = new Text({\n  content: \"1. Population by Country (millions)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst populationChart = new BarChart({\n  data: [\n    { label: \"United States\", value: 331 },\n    { label: \"Brazil\", value: 213 },\n    { label: \"Japan\", value: 126 },\n    { label: \"Germany\", value: 83 },\n    { label: \"United Kingdom\", value: 67 },\n  ],\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  barColor: \"#3f51b5\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  chartPadding: {\n    top: 20,\n    right: 80,\n    bottom: 40,\n    left: 150,\n  },\n});\n\nmainContainer.addElement(populationChart);\n\n\nconst example2Title = new Text({\n  content: \"2. Technology Adoption Rate (%) with Remarkable Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst techChart = new BarChart({\n  data: [\n    { label: \"Artificial Intelligence\", value: 67 },\n    { label: \"Cloud Computing\", value: 89 },\n    { label: \"Internet of Things\", value: 54 },\n    { label: \"Blockchain\", value: 23 },\n    { label: \"5G Networks\", value: 45 },\n    { label: \"Quantum Computing\", value: 8 },\n  ],\n  orientation: \"horizontal\",\n  width: 750,\n  height: 400,\n  barColor: \"#009688\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  remarkablePointStyle: {\n    fill: \"#ff5722\",\n    stroke: \"#d84315\",\n    strokeWidth: 2,\n  },\n  chartPadding: {\n    top: 30,\n    right: 100,\n    bottom: 50,\n    left: 180,\n  },\n});\n\nmainContainer.addElement(techChart);\n\nconst remarkablePoints = techChart.getRemarkablePoints();\n\nremarkablePoints.forEach((point) => {\n  if (point.type === \"maximum\") {\n    const pos = techChart.getRemarkablePointPosition(point);\n\n    const badge = new Container({\n      width: \"auto\",\n      height: \"auto\",\n      direction: \"horizontal\",\n      spacing: 5,\n      boxModel: { padding: 5 },\n      style: {\n        fill: \"#c8e6c9\",\n        stroke: \"#388e3c\",\n        strokeWidth: 2,\n      },\n    });\n\n    const badgeText = new Text({\n      content: \"🏆 Most Adopted\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#1b5e20\" },\n    });\n\n    badge.addElement(badgeText);\n\n    badge.position({\n      relativeFrom: badge.centerLeft,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 15,\n      y: 0,\n    });\n\n    artboard.addElement(badge);\n  } else if (point.type === \"minimum\") {\n    const pos = techChart.getRemarkablePointPosition(point);\n\n    const badge = new Container({\n      width: \"auto\",\n      height: \"auto\",\n      direction: \"horizontal\",\n      spacing: 5,\n      boxModel: { padding: 5 },\n      style: {\n        fill: \"#ffecb3\",\n        stroke: \"#f57c00\",\n        strokeWidth: 2,\n      },\n    });\n\n    const badgeText = new Text({\n      content: \"💡 Emerging Tech\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#e65100\" },\n    });\n\n    badge.addElement(badgeText);\n\n    badge.position({\n      relativeFrom: badge.centerLeft,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 15,\n      y: 0,\n    });\n\n    artboard.addElement(badge);\n  }\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Project Completion Status\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst projectData = [\n  { label: \"Frontend Development\", value: 92, color: \"#4caf50\" },\n  { label: \"Backend API\", value: 78, color: \"#ff9800\" },\n  { label: \"Database Migration\", value: 100, color: \"#4caf50\" },\n  { label: \"Testing & QA\", value: 45, color: \"#f44336\" },\n  { label: \"Documentation\", value: 67, color: \"#ff9800\" },\n];\n\nconst projectChart = new BarChart({\n  data: projectData,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 20,\n    right: 100,\n    bottom: 40,\n    left: 180,\n  },\n});\n\nmainContainer.addElement(projectChart);\n\nconst bars = projectChart.getBars();\nif (bars.length > 0) {\n  const absPos = projectChart.getAbsolutePosition();\n  const chartBox = projectChart.bbox;\n\n  const thresholdValue = 75;\n  const maxValue = 100;\n  const chartPaddingLeft = 180;\n  const chartPaddingRight = 100;\n  const plotWidth = 700 - chartPaddingLeft - chartPaddingRight;\n  const thresholdX = absPos.x + chartPaddingLeft + (thresholdValue / maxValue) * plotWidth;\n\n  const chartPaddingTop = 20;\n  const chartPaddingBottom = 40;\n  const plotHeight = 350 - chartPaddingTop - chartPaddingBottom;\n\n  const thresholdLine = new Rect({\n    width: 2,\n    height: plotHeight,\n    style: {\n      fill: \"#1976d2\",\n      stroke: \"none\",\n      strokeDasharray: \"5,5\",\n    },\n  });\n\n  thresholdLine.position({\n    relativeFrom: thresholdLine.topLeft,\n    relativeTo: { x: thresholdX, y: absPos.y + chartPaddingTop },\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(thresholdLine);\n\n  const thresholdLabel = new Text({\n    content: \"Target: 75%\",\n    fontSize: 11,\n    fontWeight: \"bold\",\n    style: { fill: \"#1976d2\" },\n  });\n\n  thresholdLabel.position({\n    relativeFrom: thresholdLabel.bottomCenter,\n    relativeTo: { x: thresholdX, y: absPos.y },\n    boxReference: \"artboard\",\n    x: 0,\n    y: 15,\n  });\n\n  artboard.addElement(thresholdLabel);\n}\n\n\nconst example4Title = new Text({\n  content: \"4. Revenue Comparison (with percentage change)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example4Title);\n\nconst revenueData = [\n  { label: \"Product Line A\", value: 2.4 },\n  { label: \"Product Line B\", value: 1.8 },\n  { label: \"Product Line C\", value: 3.2 },\n  { label: \"Product Line D\", value: 0.9 },\n];\n\nconst revenueChart = new BarChart({\n  data: revenueData,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 300,\n  barColor: \"#673ab7\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 20,\n    right: 120,\n    bottom: 40,\n    left: 150,\n  },\n});\n\nmainContainer.addElement(revenueChart);\n\nconst revenueChanges = [\"+12%\", \"-5%\", \"+18%\", \"-8%\"];\nconst revenueBars = revenueChart.getBars();\n\nrevenueBars.forEach((bar, index) => {\n  const change = revenueChanges[index];\n  const isPositive = change.startsWith(\"+\");\n\n  const badge = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 3,\n    boxModel: { padding: 4 },\n    style: {\n      fill: isPositive ? \"#e8f5e9\" : \"#ffebee\",\n      stroke: isPositive ? \"#4caf50\" : \"#f44336\",\n      strokeWidth: 1.5,\n    },\n  });\n\n  const badgeText = new Text({\n    content: change,\n    fontSize: 10,\n    fontWeight: \"bold\",\n    style: { fill: isPositive ? \"#2e7d32\" : \"#c62828\" },\n  });\n\n  badge.addElement(badgeText);\n\n  badge.position({\n    relativeFrom: badge.center,\n    relativeTo: bar.center,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(badge);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a canvas with a soft color background and space around the edges. Arrange a series of diverse charts and titles vertically. Use a primary heading and a smaller secondary heading. Include multiple horizontal bar charts showing different data categories, such as country statistics, technology trends, and project progress. Highlight important data points with markers or badges. Use a mix of colors for the bars, and add a line to indicate a specific target level in one of the charts. Provide some visual cues next to the bars to show additional information about changes."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Horizontal Bar Charts: Country Statistics\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Horizontal orientation is ideal for comparing categories with long labels\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\n\nconst example1Title = new Text({\n  content: \"1. Population by Country (millions)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst populationChart = new BarChart({\n  data: [\n    { label: \"United States\", value: 331 },\n    { label: \"Brazil\", value: 213 },\n    { label: \"Japan\", value: 126 },\n    { label: \"Germany\", value: 83 },\n    { label: \"United Kingdom\", value: 67 },\n  ],\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  barColor: \"#3f51b5\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  chartPadding: {\n    top: 20,\n    right: 80,\n    bottom: 40,\n    left: 150,\n  },\n});\n\nmainContainer.addElement(populationChart);\n\n\nconst example2Title = new Text({\n  content: \"2. Technology Adoption Rate (%) with Remarkable Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst techChart = new BarChart({\n  data: [\n    { label: \"Artificial Intelligence\", value: 67 },\n    { label: \"Cloud Computing\", value: 89 },\n    { label: \"Internet of Things\", value: 54 },\n    { label: \"Blockchain\", value: 23 },\n    { label: \"5G Networks\", value: 45 },\n    { label: \"Quantum Computing\", value: 8 },\n  ],\n  orientation: \"horizontal\",\n  width: 750,\n  height: 400,\n  barColor: \"#009688\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: true,\n  remarkablePointStyle: {\n    fill: \"#ff5722\",\n    stroke: \"#d84315\",\n    strokeWidth: 2,\n  },\n  chartPadding: {\n    top: 30,\n    right: 100,\n    bottom: 50,\n    left: 180,\n  },\n});\n\nmainContainer.addElement(techChart);\n\nconst remarkablePoints = techChart.getRemarkablePoints();\n\nremarkablePoints.forEach((point) => {\n  if (point.type === \"maximum\") {\n    const pos = techChart.getRemarkablePointPosition(point);\n\n    const badge = new Container({\n      width: \"auto\",\n      height: \"auto\",\n      direction: \"horizontal\",\n      spacing: 5,\n      boxModel: { padding: 5 },\n      style: {\n        fill: \"#c8e6c9\",\n        stroke: \"#388e3c\",\n        strokeWidth: 2,\n      },\n    });\n\n    const badgeText = new Text({\n      content: \"🏆 Most Adopted\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#1b5e20\" },\n    });\n\n    badge.addElement(badgeText);\n\n    badge.position({\n      relativeFrom: badge.centerLeft,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 15,\n      y: 0,\n    });\n\n    artboard.addElement(badge);\n  } else if (point.type === \"minimum\") {\n    const pos = techChart.getRemarkablePointPosition(point);\n\n    const badge = new Container({\n      width: \"auto\",\n      height: \"auto\",\n      direction: \"horizontal\",\n      spacing: 5,\n      boxModel: { padding: 5 },\n      style: {\n        fill: \"#ffecb3\",\n        stroke: \"#f57c00\",\n        strokeWidth: 2,\n      },\n    });\n\n    const badgeText = new Text({\n      content: \"💡 Emerging Tech\",\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#e65100\" },\n    });\n\n    badge.addElement(badgeText);\n\n    badge.position({\n      relativeFrom: badge.centerLeft,\n      relativeTo: { x: pos.x, y: pos.y },\n      boxReference: \"artboard\",\n      x: 15,\n      y: 0,\n    });\n\n    artboard.addElement(badge);\n  }\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Project Completion Status\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst projectData = [\n  { label: \"Frontend Development\", value: 92, color: \"#4caf50\" },\n  { label: \"Backend API\", value: 78, color: \"#ff9800\" },\n  { label: \"Database Migration\", value: 100, color: \"#4caf50\" },\n  { label: \"Testing & QA\", value: 45, color: \"#f44336\" },\n  { label: \"Documentation\", value: 67, color: \"#ff9800\" },\n];\n\nconst projectChart = new BarChart({\n  data: projectData,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: true,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 20,\n    right: 100,\n    bottom: 40,\n    left: 180,\n  },\n});\n\nmainContainer.addElement(projectChart);\n\nconst bars = projectChart.getBars();\nif (bars.length > 0) {\n  const absPos = projectChart.getAbsolutePosition();\n  const chartBox = projectChart.bbox;\n\n  const thresholdValue = 75;\n  const maxValue = 100;\n  const chartPaddingLeft = 180;\n  const chartPaddingRight = 100;\n  const plotWidth = 700 - chartPaddingLeft - chartPaddingRight;\n  const thresholdX = absPos.x + chartPaddingLeft + (thresholdValue / maxValue) * plotWidth;\n\n  const chartPaddingTop = 20;\n  const chartPaddingBottom = 40;\n  const plotHeight = 350 - chartPaddingTop - chartPaddingBottom;\n\n  const thresholdLine = new Rect({\n    width: 2,\n    height: plotHeight,\n    style: {\n      fill: \"#1976d2\",\n      stroke: \"none\",\n      strokeDasharray: \"5,5\",\n    },\n  });\n\n  thresholdLine.position({\n    relativeFrom: thresholdLine.topLeft,\n    relativeTo: { x: thresholdX, y: absPos.y + chartPaddingTop },\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(thresholdLine);\n\n  const thresholdLabel = new Text({\n    content: \"Target: 75%\",\n    fontSize: 11,\n    fontWeight: \"bold\",\n    style: { fill: \"#1976d2\" },\n  });\n\n  thresholdLabel.position({\n    relativeFrom: thresholdLabel.bottomCenter,\n    relativeTo: { x: thresholdX, y: absPos.y },\n    boxReference: \"artboard\",\n    x: 0,\n    y: 15,\n  });\n\n  artboard.addElement(thresholdLabel);\n}\n\n\nconst example4Title = new Text({\n  content: \"4. Revenue Comparison (with percentage change)\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example4Title);\n\nconst revenueData = [\n  { label: \"Product Line A\", value: 2.4 },\n  { label: \"Product Line B\", value: 1.8 },\n  { label: \"Product Line C\", value: 3.2 },\n  { label: \"Product Line D\", value: 0.9 },\n];\n\nconst revenueChart = new BarChart({\n  data: revenueData,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 300,\n  barColor: \"#673ab7\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 20,\n    right: 120,\n    bottom: 40,\n    left: 150,\n  },\n});\n\nmainContainer.addElement(revenueChart);\n\nconst revenueChanges = [\"+12%\", \"-5%\", \"+18%\", \"-8%\"];\nconst revenueBars = revenueChart.getBars();\n\nrevenueBars.forEach((bar, index) => {\n  const change = revenueChanges[index];\n  const isPositive = change.startsWith(\"+\");\n\n  const badge = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 3,\n    boxModel: { padding: 4 },\n    style: {\n      fill: isPositive ? \"#e8f5e9\" : \"#ffebee\",\n      stroke: isPositive ? \"#4caf50\" : \"#f44336\",\n      strokeWidth: 1.5,\n    },\n  });\n\n  const badgeText = new Text({\n    content: change,\n    fontSize: 10,\n    fontWeight: \"bold\",\n    style: { fill: isPositive ? \"#2e7d32\" : \"#c62828\" },\n  });\n\n  badge.addElement(badgeText);\n\n  badge.position({\n    relativeFrom: badge.center,\n    relativeTo: bar.center,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(badge);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a series of tests with bar charts. The first test should place a vertical bar chart inside a container with 20px padding and a blue border. The bar chart should have four categories labeled A, B, C, and D with respective values of 30, 45, 25, and 55, and the bars should be colored blue. The second test should feature two vertical bar charts side-by-side in a horizontal layout, with a 20px space between them. The first chart displays Q1, Q2, Q3 with values of 120, 150, 135, and purple bars; the second chart shows Jan, Feb, Mar with values of 85, 92, 78, and green bars. The third test involves a 2x2 grid with four bar charts. Ensure the charts in the grid have distinct colors and orientations, with specific labels and values as provided in the data. The final test should nest a bar chart within containers of different colors and paddings, with an outer blue container and an inner pink container, showcasing values for Alpha, Beta, Gamma, and Delta with a pink color for the bars."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Grid,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 30 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"BarChart Positioning Tests\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Verifying that BarCharts respect Container positioning\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\n\nconst test1Title = new Text({\n  content: \"Test 1: BarChart in Container with Padding\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test1Title);\n\nconst paddedContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#1976d2\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(paddedContainer);\n\nconst containerLabel = new Text({\n  content: \"Container with 20px padding (blue border)\",\n  fontSize: 12,\n  style: { fill: \"#1565c0\" },\n});\n\npaddedContainer.addElement(containerLabel);\n\nconst chart1 = new BarChart({\n  data: [\n    { label: \"A\", value: 30 },\n    { label: \"B\", value: 45 },\n    { label: \"C\", value: 25 },\n    { label: \"D\", value: 55 },\n  ],\n  orientation: \"vertical\",\n  width: 400,\n  height: 250,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n});\n\npaddedContainer.addElement(chart1);\n\n\nconst test2Title = new Text({\n  content: \"Test 2: Multiple Charts in Horizontal Layout\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test2Title);\n\nconst horizontalContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#7b1fa2\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(horizontalContainer);\n\nconst chart2a = new BarChart({\n  data: [\n    { label: \"Q1\", value: 120 },\n    { label: \"Q2\", value: 150 },\n    { label: \"Q3\", value: 135 },\n  ],\n  orientation: \"vertical\",\n  width: 280,\n  height: 220,\n  barColor: \"#9c27b0\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: {\n    top: 20,\n    right: 20,\n    bottom: 35,\n    left: 50,\n  },\n});\n\nhorizontalContainer.addElement(chart2a);\n\nconst chart2b = new BarChart({\n  data: [\n    { label: \"Jan\", value: 85 },\n    { label: \"Feb\", value: 92 },\n    { label: \"Mar\", value: 78 },\n  ],\n  orientation: \"vertical\",\n  width: 280,\n  height: 220,\n  barColor: \"#4caf50\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: {\n    top: 20,\n    right: 20,\n    bottom: 35,\n    left: 50,\n  },\n});\n\nhorizontalContainer.addElement(chart2b);\n\n\nconst test3Title = new Text({\n  content: \"Test 3: Charts in 2x2 Grid\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test3Title);\n\nconst grid = new Grid({\n  rows: 2,\n  columns: 2,\n  width: 800,\n  height: 480,\n  cellWidth: 390,\n  cellHeight: 230,\n  gutter: 20,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#e65100\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(grid.container);\n\nconst gridChart1 = new BarChart({\n  data: [\n    { label: \"Mon\", value: 12 },\n    { label: \"Tue\", value: 15 },\n    { label: \"Wed\", value: 18 },\n  ],\n  orientation: \"vertical\",\n  width: 350,\n  height: 180,\n  barColor: \"#ff5722\",\n  showGrid: false,\n  showAxes: true,\n  showValueLabels: true,\n  chartPadding: { top: 15, right: 15, bottom: 30, left: 40 },\n});\n\ngridChart1.position({\n  relativeFrom: gridChart1.center,\n  relativeTo: grid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 0).addElement(gridChart1);\n\nconst gridChart2 = new BarChart({\n  data: [\n    { label: \"Red\", value: 8 },\n    { label: \"Blue\", value: 12 },\n    { label: \"Green\", value: 6 },\n  ],\n  orientation: \"horizontal\",\n  width: 350,\n  height: 180,\n  barColor: \"#03a9f4\",\n  showGrid: false,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: { top: 15, right: 60, bottom: 30, left: 80 },\n});\n\ngridChart2.position({\n  relativeFrom: gridChart2.center,\n  relativeTo: grid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 1).addElement(gridChart2);\n\nconst gridChart3 = new BarChart({\n  data: [\n    { label: \"X\", value: 42, color: \"#e91e63\" },\n    { label: \"Y\", value: 35, color: \"#9c27b0\" },\n    { label: \"Z\", value: 50, color: \"#3f51b5\" },\n  ],\n  orientation: \"vertical\",\n  width: 350,\n  height: 180,\n  showGrid: true,\n  showAxes: true,\n  chartPadding: { top: 15, right: 15, bottom: 30, left: 40 },\n});\n\ngridChart3.position({\n  relativeFrom: gridChart3.center,\n  relativeTo: grid.getCell(1, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 0).addElement(gridChart3);\n\nconst gridChart4 = new BarChart({\n  data: [\n    { label: \"Low\", value: 15 },\n    { label: \"Medium\", value: 40 },\n    { label: \"High\", value: 25 },\n  ],\n  orientation: \"horizontal\",\n  width: 350,\n  height: 180,\n  barColor: \"#8bc34a\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: { top: 15, right: 60, bottom: 30, left: 80 },\n});\n\ngridChart4.position({\n  relativeFrom: gridChart4.center,\n  relativeTo: grid.getCell(1, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 1).addElement(gridChart4);\n\n\nconst test4Title = new Text({\n  content: \"Test 4: Chart in Nested Containers\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test4Title);\n\nconst outerContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8eaf6\",\n    stroke: \"#3f51b5\",\n    strokeWidth: \"3\",\n  },\n});\n\nmainContainer.addElement(outerContainer);\n\nconst outerLabel = new Text({\n  content: \"Outer Container (thick blue border, 20px padding)\",\n  fontSize: 11,\n  style: { fill: \"#283593\" },\n});\n\nouterContainer.addElement(outerLabel);\n\nconst innerContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#c2185b\",\n    strokeWidth: \"2\",\n  },\n});\n\nouterContainer.addElement(innerContainer);\n\nconst innerLabel = new Text({\n  content: \"Inner Container (pink border, 15px padding)\",\n  fontSize: 11,\n  style: { fill: \"#880e4f\" },\n});\n\ninnerContainer.addElement(innerLabel);\n\nconst nestedChart = new BarChart({\n  data: [\n    { label: \"Alpha\", value: 65 },\n    { label: \"Beta\", value: 78 },\n    { label: \"Gamma\", value: 52 },\n    { label: \"Delta\", value: 89 },\n  ],\n  orientation: \"vertical\",\n  width: 500,\n  height: 250,\n  barColor: \"#e91e63\",\n  showGrid: true,\n  showAxes: true,\n  showValueLabels: true,\n});\n\ninnerContainer.addElement(nestedChart);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a visual test suite with several different bar chart configurations. Start with a chart inside a padded container, then show a few charts in a row next to each other. Include a grid layout with some charts having different orientations and place a chart inside nested containers with varied colors. Use various category labels, values, and colors for the charts to distinguish each test."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Grid,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 30 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"BarChart Positioning Tests\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\nconst subtitle = new Text({\n  content: \"Verifying that BarCharts respect Container positioning\",\n  fontSize: 13,\n  style: { fill: \"#616161\" },\n});\n\nmainContainer.addElement(subtitle);\n\n\nconst test1Title = new Text({\n  content: \"Test 1: BarChart in Container with Padding\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test1Title);\n\nconst paddedContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#1976d2\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(paddedContainer);\n\nconst containerLabel = new Text({\n  content: \"Container with 20px padding (blue border)\",\n  fontSize: 12,\n  style: { fill: \"#1565c0\" },\n});\n\npaddedContainer.addElement(containerLabel);\n\nconst chart1 = new BarChart({\n  data: [\n    { label: \"A\", value: 30 },\n    { label: \"B\", value: 45 },\n    { label: \"C\", value: 25 },\n    { label: \"D\", value: 55 },\n  ],\n  orientation: \"vertical\",\n  width: 400,\n  height: 250,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n});\n\npaddedContainer.addElement(chart1);\n\n\nconst test2Title = new Text({\n  content: \"Test 2: Multiple Charts in Horizontal Layout\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test2Title);\n\nconst horizontalContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#7b1fa2\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(horizontalContainer);\n\nconst chart2a = new BarChart({\n  data: [\n    { label: \"Q1\", value: 120 },\n    { label: \"Q2\", value: 150 },\n    { label: \"Q3\", value: 135 },\n  ],\n  orientation: \"vertical\",\n  width: 280,\n  height: 220,\n  barColor: \"#9c27b0\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: {\n    top: 20,\n    right: 20,\n    bottom: 35,\n    left: 50,\n  },\n});\n\nhorizontalContainer.addElement(chart2a);\n\nconst chart2b = new BarChart({\n  data: [\n    { label: \"Jan\", value: 85 },\n    { label: \"Feb\", value: 92 },\n    { label: \"Mar\", value: 78 },\n  ],\n  orientation: \"vertical\",\n  width: 280,\n  height: 220,\n  barColor: \"#4caf50\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: {\n    top: 20,\n    right: 20,\n    bottom: 35,\n    left: 50,\n  },\n});\n\nhorizontalContainer.addElement(chart2b);\n\n\nconst test3Title = new Text({\n  content: \"Test 3: Charts in 2x2 Grid\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test3Title);\n\nconst grid = new Grid({\n  rows: 2,\n  columns: 2,\n  width: 800,\n  height: 480,\n  cellWidth: 390,\n  cellHeight: 230,\n  gutter: 20,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#e65100\",\n    strokeWidth: \"2\",\n  },\n});\n\nmainContainer.addElement(grid.container);\n\nconst gridChart1 = new BarChart({\n  data: [\n    { label: \"Mon\", value: 12 },\n    { label: \"Tue\", value: 15 },\n    { label: \"Wed\", value: 18 },\n  ],\n  orientation: \"vertical\",\n  width: 350,\n  height: 180,\n  barColor: \"#ff5722\",\n  showGrid: false,\n  showAxes: true,\n  showValueLabels: true,\n  chartPadding: { top: 15, right: 15, bottom: 30, left: 40 },\n});\n\ngridChart1.position({\n  relativeFrom: gridChart1.center,\n  relativeTo: grid.getCell(0, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 0).addElement(gridChart1);\n\nconst gridChart2 = new BarChart({\n  data: [\n    { label: \"Red\", value: 8 },\n    { label: \"Blue\", value: 12 },\n    { label: \"Green\", value: 6 },\n  ],\n  orientation: \"horizontal\",\n  width: 350,\n  height: 180,\n  barColor: \"#03a9f4\",\n  showGrid: false,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: { top: 15, right: 60, bottom: 30, left: 80 },\n});\n\ngridChart2.position({\n  relativeFrom: gridChart2.center,\n  relativeTo: grid.getCell(0, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(0, 1).addElement(gridChart2);\n\nconst gridChart3 = new BarChart({\n  data: [\n    { label: \"X\", value: 42, color: \"#e91e63\" },\n    { label: \"Y\", value: 35, color: \"#9c27b0\" },\n    { label: \"Z\", value: 50, color: \"#3f51b5\" },\n  ],\n  orientation: \"vertical\",\n  width: 350,\n  height: 180,\n  showGrid: true,\n  showAxes: true,\n  chartPadding: { top: 15, right: 15, bottom: 30, left: 40 },\n});\n\ngridChart3.position({\n  relativeFrom: gridChart3.center,\n  relativeTo: grid.getCell(1, 0).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 0).addElement(gridChart3);\n\nconst gridChart4 = new BarChart({\n  data: [\n    { label: \"Low\", value: 15 },\n    { label: \"Medium\", value: 40 },\n    { label: \"High\", value: 25 },\n  ],\n  orientation: \"horizontal\",\n  width: 350,\n  height: 180,\n  barColor: \"#8bc34a\",\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  chartPadding: { top: 15, right: 60, bottom: 30, left: 80 },\n});\n\ngridChart4.position({\n  relativeFrom: gridChart4.center,\n  relativeTo: grid.getCell(1, 1).contentBox.center,\n  x: 0,\n  y: 0,\n});\n\ngrid.getCell(1, 1).addElement(gridChart4);\n\n\nconst test4Title = new Text({\n  content: \"Test 4: Chart in Nested Containers\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(test4Title);\n\nconst outerContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8eaf6\",\n    stroke: \"#3f51b5\",\n    strokeWidth: \"3\",\n  },\n});\n\nmainContainer.addElement(outerContainer);\n\nconst outerLabel = new Text({\n  content: \"Outer Container (thick blue border, 20px padding)\",\n  fontSize: 11,\n  style: { fill: \"#283593\" },\n});\n\nouterContainer.addElement(outerLabel);\n\nconst innerContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 8,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#c2185b\",\n    strokeWidth: \"2\",\n  },\n});\n\nouterContainer.addElement(innerContainer);\n\nconst innerLabel = new Text({\n  content: \"Inner Container (pink border, 15px padding)\",\n  fontSize: 11,\n  style: { fill: \"#880e4f\" },\n});\n\ninnerContainer.addElement(innerLabel);\n\nconst nestedChart = new BarChart({\n  data: [\n    { label: \"Alpha\", value: 65 },\n    { label: \"Beta\", value: 78 },\n    { label: \"Gamma\", value: 52 },\n    { label: \"Delta\", value: 89 },\n  ],\n  orientation: \"vertical\",\n  width: 500,\n  height: 250,\n  barColor: \"#e91e63\",\n  showGrid: true,\n  showAxes: true,\n  showValueLabels: true,\n});\n\ninnerContainer.addElement(nestedChart);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light grey background and padding of 40 pixels. Place a vertical red line at the center with a width of 2 pixels and a height of 600 pixels, intersecting with a horizontal red line that's 800 pixels wide and 2 pixels tall. At the intersection, add a small red circle with a radius of 5 pixels. Position three badges around the center: one with a blue theme labeled 'Test Badge' positioned 20 pixels to the right and 80 pixels up, another with a purple theme labeled 'Centered Badge' directly at the center, and a third with an orange theme labeled 'Right Badge' 20 pixels to the left and 80 pixels down. Include labels that describe badge positions, and highlight actual reference points with small green markers. Add a debug text in the top-left corner showing the width and height of the first badge."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Text,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst referenceX = 400;\nconst referenceY = 300;\n\nconst refLineV = new Rect({\n  width: 2,\n  height: 600,\n  style: { fill: \"#ff0000\" },\n});\n\nrefLineV.position({\n  relativeFrom: refLineV.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refLineV);\n\nconst refLineH = new Rect({\n  width: 800,\n  height: 2,\n  style: { fill: \"#ff0000\" },\n});\n\nrefLineH.position({\n  relativeFrom: refLineH.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refLineH);\n\nconst refCircle = new Circle({\n  radius: 5,\n  style: { fill: \"#ff0000\" },\n});\n\nrefCircle.position({\n  relativeFrom: refCircle.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refCircle);\n\n\nconst badge1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#1976d2\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText1 = new Text({\n  content: \"Test Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#1565c0\" },\n});\n\nbadge1.addElement(badgeText1);\n\nbadge1.position({\n  relativeFrom: badge1.centerLeft,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 20, // 20px to the right\n  y: -80, // Up\n});\n\nartboard.addElement(badge1);\n\nconst label1 = new Text({\n  content: \"centerLeft (should be to the right)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel1.position({\n  relativeFrom: label1.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: -120,\n});\n\nartboard.addElement(label1);\n\n\nconst badge2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#7b1fa2\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText2 = new Text({\n  content: \"Centered Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#4a148c\" },\n});\n\nbadge2.addElement(badgeText2);\n\nbadge2.position({\n  relativeFrom: badge2.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(badge2);\n\nconst label2 = new Text({\n  content: \"center (should be centered)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel2.position({\n  relativeFrom: label2.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 40,\n});\n\nartboard.addElement(label2);\n\n\nconst badge3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#e65100\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText3 = new Text({\n  content: \"Right Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#bf360c\" },\n});\n\nbadge3.addElement(badgeText3);\n\nbadge3.position({\n  relativeFrom: badge3.centerRight,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: -20, // 20px to the left\n  y: 80, // Down\n});\n\nartboard.addElement(badge3);\n\nconst label3 = new Text({\n  content: \"centerRight (should be to the left)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel3.position({\n  relativeFrom: label3.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 120,\n});\n\nartboard.addElement(label3);\n\n\nconst debugText = new Text({\n  content: `Badge1 dimensions: width=${badge1.width.toFixed(1)}, height=${badge1.height.toFixed(1)}`,\n  fontSize: 10,\n  style: { fill: \"#666666\" },\n});\n\ndebugText.position({\n  relativeFrom: debugText.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 10,\n  y: 10,\n});\n\nartboard.addElement(debugText);\n\nconst centerLeftPos = badge1.centerLeft;\nconst centerLeftMarker = new Circle({\n  radius: 4,\n  style: { fill: \"#00ff00\", stroke: \"#008800\", strokeWidth: \"2\" },\n});\n\ncenterLeftMarker.position({\n  relativeFrom: centerLeftMarker.center,\n  relativeTo: centerLeftPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(centerLeftMarker);\n\nconst centerLeftLabel = new Text({\n  content: \"actual centerLeft\",\n  fontSize: 9,\n  style: { fill: \"#008800\" },\n});\n\ncenterLeftLabel.position({\n  relativeFrom: centerLeftLabel.bottomLeft,\n  relativeTo: centerLeftPos,\n  boxReference: \"artboard\",\n  x: 8,\n  y: -5,\n});\n\nartboard.addElement(centerLeftLabel);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a canvas with a soft background. Add intersecting horizontal and vertical lines in the center and place a small circle at the intersection. Arrange several badges with different colors and labels around the central point, ensuring they are slightly offset in various directions. Each badge should have a label indicating its supposed position. Include markers at specific spots to show exact reference points. Display some debug text on the top-left to show dimensions."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Text,\n  Circle,\n  Rect,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#f5f5f5\",\n  boxModel: { padding: 40 },\n});\n\nconst referenceX = 400;\nconst referenceY = 300;\n\nconst refLineV = new Rect({\n  width: 2,\n  height: 600,\n  style: { fill: \"#ff0000\" },\n});\n\nrefLineV.position({\n  relativeFrom: refLineV.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refLineV);\n\nconst refLineH = new Rect({\n  width: 800,\n  height: 2,\n  style: { fill: \"#ff0000\" },\n});\n\nrefLineH.position({\n  relativeFrom: refLineH.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refLineH);\n\nconst refCircle = new Circle({\n  radius: 5,\n  style: { fill: \"#ff0000\" },\n});\n\nrefCircle.position({\n  relativeFrom: refCircle.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(refCircle);\n\n\nconst badge1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#1976d2\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText1 = new Text({\n  content: \"Test Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#1565c0\" },\n});\n\nbadge1.addElement(badgeText1);\n\nbadge1.position({\n  relativeFrom: badge1.centerLeft,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 20, // 20px to the right\n  y: -80, // Up\n});\n\nartboard.addElement(badge1);\n\nconst label1 = new Text({\n  content: \"centerLeft (should be to the right)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel1.position({\n  relativeFrom: label1.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: -120,\n});\n\nartboard.addElement(label1);\n\n\nconst badge2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#7b1fa2\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText2 = new Text({\n  content: \"Centered Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#4a148c\" },\n});\n\nbadge2.addElement(badgeText2);\n\nbadge2.position({\n  relativeFrom: badge2.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(badge2);\n\nconst label2 = new Text({\n  content: \"center (should be centered)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel2.position({\n  relativeFrom: label2.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 40,\n});\n\nartboard.addElement(label2);\n\n\nconst badge3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 5,\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#fff3e0\",\n    stroke: \"#e65100\",\n    strokeWidth: \"2\",\n  },\n});\n\nconst badgeText3 = new Text({\n  content: \"Right Badge\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#bf360c\" },\n});\n\nbadge3.addElement(badgeText3);\n\nbadge3.position({\n  relativeFrom: badge3.centerRight,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: -20, // 20px to the left\n  y: 80, // Down\n});\n\nartboard.addElement(badge3);\n\nconst label3 = new Text({\n  content: \"centerRight (should be to the left)\",\n  fontSize: 11,\n  style: { fill: \"#424242\" },\n});\n\nlabel3.position({\n  relativeFrom: label3.center,\n  relativeTo: { x: referenceX, y: referenceY },\n  boxReference: \"artboard\",\n  x: 0,\n  y: 120,\n});\n\nartboard.addElement(label3);\n\n\nconst debugText = new Text({\n  content: `Badge1 dimensions: width=${badge1.width.toFixed(1)}, height=${badge1.height.toFixed(1)}`,\n  fontSize: 10,\n  style: { fill: \"#666666\" },\n});\n\ndebugText.position({\n  relativeFrom: debugText.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 10,\n  y: 10,\n});\n\nartboard.addElement(debugText);\n\nconst centerLeftPos = badge1.centerLeft;\nconst centerLeftMarker = new Circle({\n  radius: 4,\n  style: { fill: \"#00ff00\", stroke: \"#008800\", strokeWidth: \"2\" },\n});\n\ncenterLeftMarker.position({\n  relativeFrom: centerLeftMarker.center,\n  relativeTo: centerLeftPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(centerLeftMarker);\n\nconst centerLeftLabel = new Text({\n  content: \"actual centerLeft\",\n  fontSize: 9,\n  style: { fill: \"#008800\" },\n});\n\ncenterLeftLabel.position({\n  relativeFrom: centerLeftLabel.bottomLeft,\n  relativeTo: centerLeftPos,\n  boxReference: \"artboard\",\n  x: 8,\n  y: -5,\n});\n\nartboard.addElement(centerLeftLabel);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light grey background and add five examples of charts. The first example is a pie chart for sales data with categories Electronics, Clothing, Food, and Books, highlighting the largest category. The second is a donut chart with the same sales data, showing the total sales in the center. The third is a donut chart showing market share for Company A, B, C, and Others, marking the majority share. The fourth is a budget breakdown donut chart with a legend, using specific colors for Salaries, Marketing, R&D, and Operations. The fifth example is a donut chart with four equal slices labeled North, East, South, and West, with markers for slice positions and cardinal directions around the chart."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  DonutChart,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst salesData = [\n  { label: \"Electronics\", value: 45 },\n  { label: \"Clothing\", value: 30 },\n  { label: \"Food\", value: 15 },\n  { label: \"Books\", value: 10 },\n];\n\nconst marketShareData = [\n  { label: \"Company A\", value: 52 },\n  { label: \"Company B\", value: 28 },\n  { label: \"Company C\", value: 12 },\n  { label: \"Others\", value: 8 },\n];\n\nconst budgetData = [\n  { label: \"Salaries\", value: 60, color: \"#FF6384\" },\n  { label: \"Marketing\", value: 20, color: \"#36A2EB\" },\n  { label: \"R&D\", value: 15, color: \"#FFCE56\" },\n  { label: \"Operations\", value: 5, color: \"#4BC0C0\" },\n];\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Pie Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst pieChart = new DonutChart({\n  data: salesData,\n  width: 300,\n  height: 300,\n  innerRadius: 0, // Pie chart\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nexample1Container.addElement(pieChart);\n\nconst maxPoint = pieChart.getRemarkablePoints(\"maximum\")[0];\nif (maxPoint) {\n  const maxLabel = new Text({\n    content: `Largest: ${maxPoint.label} (${maxPoint.percentage.toFixed(1)}%)`,\n    fontSize: 14,\n    style: { fill: \"#2e7d32\" },\n    fontWeight: \"bold\",\n  });\n  \n  example1Container.addElement(maxLabel);\n}\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 350,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Donut Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst donutChart = new DonutChart({\n  data: salesData,\n  width: 300,\n  height: 300,\n  innerRadius: \"50%\", // Donut with 50% inner radius\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nexample2Container.addElement(donutChart);\n\nconst centerLabel = new Text({\n  content: \"Total Sales\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nconst totalValue = salesData.reduce((sum, d) => sum + d.value, 0);\nconst centerValue = new Text({\n  content: `${totalValue}`,\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nconst centerPos = donutChart.getCenterPosition();\n\ncenterLabel.position({\n  relativeFrom: centerLabel.center,\n  relativeTo: centerPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: -15,\n});\n\ncenterValue.position({\n  relativeFrom: centerValue.center,\n  relativeTo: centerPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(centerLabel);\nartboard.addElement(centerValue);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 700,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Market Share\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst marketChart = new DonutChart({\n  data: marketShareData,\n  width: 300,\n  height: 300,\n  innerRadius: \"60%\",\n  showLabels: true,\n  detectRemarkablePoints: true,\n  startAngle: 0, // Start from right\n});\n\nexample3Container.addElement(marketChart);\n\nconst majorityPoint = marketChart.getRemarkablePoints(\"majority\")[0];\nif (majorityPoint) {\n  const majoritySlice = marketChart.getSlice(majorityPoint.index);\n  if (majoritySlice) {\n    const markerPos = majoritySlice.outerMidpoint;\n    \n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"#4caf50\",\n        stroke: \"#2e7d32\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: markerPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n    \n    const annotation = new Text({\n      content: \"Majority\",\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#2e7d32\" },\n    });\n    \n    const annotationPos = majoritySlice.externalLabelPosition;\n    annotation.position({\n      relativeFrom: annotation.center,\n      relativeTo: annotationPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(annotation);\n  }\n}\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 420,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Budget Breakdown\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst budgetChart = new DonutChart({\n  data: budgetData,\n  width: 300,\n  height: 300,\n  innerRadius: \"40%\",\n  showLabels: true,\n  detectRemarkablePoints: true,\n  sliceStyle: {\n    strokeWidth: 3,\n  },\n  labelStyle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n  },\n});\n\nexample4Container.addElement(budgetChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#bdbdbd\",\n    strokeWidth: 1,\n  },\n});\n\nlegendContainer.position({\n  relativeFrom: legendContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 350,\n  y: 420 + 50,\n});\n\nartboard.addElement(legendContainer);\n\nconst legendTitle = new Text({\n  content: \"Legend\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nlegendContainer.addElement(legendTitle);\n\nbudgetData.forEach((item, index) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 10,\n    horizontalAlignment: \"left\",\n  });\n  \n  legendContainer.addElement(legendItem);\n  \n  const colorBox = new Circle({\n    radius: 8,\n    style: {\n      fill: item.color,\n      stroke: \"none\",\n    },\n  });\n  \n  legendItem.addElement(colorBox);\n  \n  const slice = budgetChart.getSlice(index);\n  const labelText = new Text({\n    content: `${item.label}: ${item.value}% (${slice?.percentage.toFixed(1)}%)`,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(labelText);\n});\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 700,\n  y: 420,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Slice Positions\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst positionChart = new DonutChart({\n  data: [\n    { label: \"North\", value: 25 },\n    { label: \"East\", value: 25 },\n    { label: \"South\", value: 25 },\n    { label: \"West\", value: 25 },\n  ],\n  width: 300,\n  height: 300,\n  innerRadius: \"45%\",\n  showLabels: false,\n  detectRemarkablePoints: false,\n  startAngle: -135, // Start at -135° so midpoint of first slice is at -90° (top/North)\n  colors: [\"#e53935\", \"#fb8c00\", \"#43a047\", \"#1e88e5\"],\n  cornerRadius: 8, // Add rounded corners\n});\n\nexample5Container.addElement(positionChart);\n\npositionChart.getAllSlices().forEach((slice, index) => {\n  const outerMarker = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#ffffff\",\n      stroke: \"#000000\",\n      strokeWidth: 2,\n    },\n  });\n  \n  outerMarker.position({\n    relativeFrom: outerMarker.center,\n    relativeTo: slice.outerMidpoint,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(outerMarker);\n  \n  const externalLabel = new Text({\n    content: slice.label,\n    fontSize: 14,\n    fontWeight: \"bold\",\n    style: { fill: \"#1a237e\" },\n  });\n  \n  externalLabel.position({\n    relativeFrom: externalLabel.center,\n    relativeTo: slice.externalLabelPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(externalLabel);\n  \n  const sliceCenterPos = positionChart.getCenterPosition();\n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: 0, y: 0 },\n    style: {\n      stroke: \"#9e9e9e\",\n      strokeWidth: \"1\",\n      strokeDasharray: \"4 2\",\n    },\n  });\n  \n  line.position({\n    relativeFrom: line.start,\n    relativeTo: sliceCenterPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  line.end.x = slice.outerMidpoint.x - sliceCenterPos.x;\n  line.end.y = slice.outerMidpoint.y - sliceCenterPos.y;\n  \n  artboard.addElement(line);\n});\n\nconst chartCenter = positionChart.getCenterPosition();\nconst outerRadius = 135; // Approximate outer radius\n\nconst cardinalDirections = [\n  { angle: -90, label: \"↑ Top\", color: \"#e53935\" },\n  { angle: 0, label: \"→ Right\", color: \"#fb8c00\" },\n  { angle: 90, label: \"↓ Bottom\", color: \"#43a047\" },\n  { angle: 180, label: \"← Left\", color: \"#1e88e5\" },\n];\n\ncardinalDirections.forEach(({ angle, label, color }) => {\n  const angleRad = (angle * Math.PI) / 180;\n  const distance = outerRadius + 35;\n  \n  const marker = new Circle({\n    radius: 3,\n    style: {\n      fill: color,\n      stroke: \"none\",\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: chartCenter,\n    boxReference: \"artboard\",\n    x: distance * Math.cos(angleRad),\n    y: distance * Math.sin(angleRad),\n  });\n  \n  artboard.addElement(marker);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with some charts to display different types of data. Include examples of circular charts like pie charts and donut charts. Highlight notable data points in each chart, and use labels to annotate key information. Add legends or markers where needed to differentiate parts of the charts. Use various colors to make the charts visually distinct and engaging."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  DonutChart,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst salesData = [\n  { label: \"Electronics\", value: 45 },\n  { label: \"Clothing\", value: 30 },\n  { label: \"Food\", value: 15 },\n  { label: \"Books\", value: 10 },\n];\n\nconst marketShareData = [\n  { label: \"Company A\", value: 52 },\n  { label: \"Company B\", value: 28 },\n  { label: \"Company C\", value: 12 },\n  { label: \"Others\", value: 8 },\n];\n\nconst budgetData = [\n  { label: \"Salaries\", value: 60, color: \"#FF6384\" },\n  { label: \"Marketing\", value: 20, color: \"#36A2EB\" },\n  { label: \"R&D\", value: 15, color: \"#FFCE56\" },\n  { label: \"Operations\", value: 5, color: \"#4BC0C0\" },\n];\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Pie Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst pieChart = new DonutChart({\n  data: salesData,\n  width: 300,\n  height: 300,\n  innerRadius: 0, // Pie chart\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nexample1Container.addElement(pieChart);\n\nconst maxPoint = pieChart.getRemarkablePoints(\"maximum\")[0];\nif (maxPoint) {\n  const maxLabel = new Text({\n    content: `Largest: ${maxPoint.label} (${maxPoint.percentage.toFixed(1)}%)`,\n    fontSize: 14,\n    style: { fill: \"#2e7d32\" },\n    fontWeight: \"bold\",\n  });\n  \n  example1Container.addElement(maxLabel);\n}\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 350,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Donut Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst donutChart = new DonutChart({\n  data: salesData,\n  width: 300,\n  height: 300,\n  innerRadius: \"50%\", // Donut with 50% inner radius\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nexample2Container.addElement(donutChart);\n\nconst centerLabel = new Text({\n  content: \"Total Sales\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nconst totalValue = salesData.reduce((sum, d) => sum + d.value, 0);\nconst centerValue = new Text({\n  content: `${totalValue}`,\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nconst centerPos = donutChart.getCenterPosition();\n\ncenterLabel.position({\n  relativeFrom: centerLabel.center,\n  relativeTo: centerPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: -15,\n});\n\ncenterValue.position({\n  relativeFrom: centerValue.center,\n  relativeTo: centerPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 10,\n});\n\nartboard.addElement(centerLabel);\nartboard.addElement(centerValue);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 700,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Market Share\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst marketChart = new DonutChart({\n  data: marketShareData,\n  width: 300,\n  height: 300,\n  innerRadius: \"60%\",\n  showLabels: true,\n  detectRemarkablePoints: true,\n  startAngle: 0, // Start from right\n});\n\nexample3Container.addElement(marketChart);\n\nconst majorityPoint = marketChart.getRemarkablePoints(\"majority\")[0];\nif (majorityPoint) {\n  const majoritySlice = marketChart.getSlice(majorityPoint.index);\n  if (majoritySlice) {\n    const markerPos = majoritySlice.outerMidpoint;\n    \n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"#4caf50\",\n        stroke: \"#2e7d32\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: markerPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n    \n    const annotation = new Text({\n      content: \"Majority\",\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#2e7d32\" },\n    });\n    \n    const annotationPos = majoritySlice.externalLabelPosition;\n    annotation.position({\n      relativeFrom: annotation.center,\n      relativeTo: annotationPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(annotation);\n  }\n}\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 420,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Budget Breakdown\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst budgetChart = new DonutChart({\n  data: budgetData,\n  width: 300,\n  height: 300,\n  innerRadius: \"40%\",\n  showLabels: true,\n  detectRemarkablePoints: true,\n  sliceStyle: {\n    strokeWidth: 3,\n  },\n  labelStyle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n  },\n});\n\nexample4Container.addElement(budgetChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#bdbdbd\",\n    strokeWidth: 1,\n  },\n});\n\nlegendContainer.position({\n  relativeFrom: legendContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 350,\n  y: 420 + 50,\n});\n\nartboard.addElement(legendContainer);\n\nconst legendTitle = new Text({\n  content: \"Legend\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nlegendContainer.addElement(legendTitle);\n\nbudgetData.forEach((item, index) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 10,\n    horizontalAlignment: \"left\",\n  });\n  \n  legendContainer.addElement(legendItem);\n  \n  const colorBox = new Circle({\n    radius: 8,\n    style: {\n      fill: item.color,\n      stroke: \"none\",\n    },\n  });\n  \n  legendItem.addElement(colorBox);\n  \n  const slice = budgetChart.getSlice(index);\n  const labelText = new Text({\n    content: `${item.label}: ${item.value}% (${slice?.percentage.toFixed(1)}%)`,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(labelText);\n});\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 700,\n  y: 420,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Slice Positions\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst positionChart = new DonutChart({\n  data: [\n    { label: \"North\", value: 25 },\n    { label: \"East\", value: 25 },\n    { label: \"South\", value: 25 },\n    { label: \"West\", value: 25 },\n  ],\n  width: 300,\n  height: 300,\n  innerRadius: \"45%\",\n  showLabels: false,\n  detectRemarkablePoints: false,\n  startAngle: -135, // Start at -135° so midpoint of first slice is at -90° (top/North)\n  colors: [\"#e53935\", \"#fb8c00\", \"#43a047\", \"#1e88e5\"],\n  cornerRadius: 8, // Add rounded corners\n});\n\nexample5Container.addElement(positionChart);\n\npositionChart.getAllSlices().forEach((slice, index) => {\n  const outerMarker = new Circle({\n    radius: 5,\n    style: {\n      fill: \"#ffffff\",\n      stroke: \"#000000\",\n      strokeWidth: 2,\n    },\n  });\n  \n  outerMarker.position({\n    relativeFrom: outerMarker.center,\n    relativeTo: slice.outerMidpoint,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(outerMarker);\n  \n  const externalLabel = new Text({\n    content: slice.label,\n    fontSize: 14,\n    fontWeight: \"bold\",\n    style: { fill: \"#1a237e\" },\n  });\n  \n  externalLabel.position({\n    relativeFrom: externalLabel.center,\n    relativeTo: slice.externalLabelPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(externalLabel);\n  \n  const sliceCenterPos = positionChart.getCenterPosition();\n  const line = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: 0, y: 0 },\n    style: {\n      stroke: \"#9e9e9e\",\n      strokeWidth: \"1\",\n      strokeDasharray: \"4 2\",\n    },\n  });\n  \n  line.position({\n    relativeFrom: line.start,\n    relativeTo: sliceCenterPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  line.end.x = slice.outerMidpoint.x - sliceCenterPos.x;\n  line.end.y = slice.outerMidpoint.y - sliceCenterPos.y;\n  \n  artboard.addElement(line);\n});\n\nconst chartCenter = positionChart.getCenterPosition();\nconst outerRadius = 135; // Approximate outer radius\n\nconst cardinalDirections = [\n  { angle: -90, label: \"↑ Top\", color: \"#e53935\" },\n  { angle: 0, label: \"→ Right\", color: \"#fb8c00\" },\n  { angle: 90, label: \"↓ Bottom\", color: \"#43a047\" },\n  { angle: 180, label: \"← Left\", color: \"#1e88e5\" },\n];\n\ncardinalDirections.forEach(({ angle, label, color }) => {\n  const angleRad = (angle * Math.PI) / 180;\n  const distance = outerRadius + 35;\n  \n  const marker = new Circle({\n    radius: 3,\n    style: {\n      fill: color,\n      stroke: \"none\",\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: chartCenter,\n    boxReference: \"artboard\",\n    x: distance * Math.cos(angleRad),\n    y: distance * Math.sin(angleRad),\n  });\n  \n  artboard.addElement(marker);\n});\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and six examples of different chart types. The first is a simple line chart titled 'Example 1: Simple Line Chart' with a series showing temperature data. Highlight the maximum temperature with an orange circle and label it. The second is a multiple series line chart titled 'Example 2: Multiple Series' with data for Products A, B, and C, each in different colors (blue, red, green) and a legend underneath. The third is a smooth area chart titled 'Example 3: Smooth Area Chart' showing revenue with smooth purple lines and area fill. The fourth is a line chart titled 'Example 4: Remarkable Points' that automatically detects and marks local maxima and minima with green and red markers respectively. The fifth is a sine and cosine wave chart titled 'Example 5: Wave Functions' with zero crossings marked in orange. The last example, 'Example 6: Custom Annotations,' displays a growth line chart where specific data points are annotated with custom labels."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  LineChart,\n  Text,\n  Circle,\n  Line,\n  Arrow,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Simple Line Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst simpleLineChart = new LineChart({\n  series: [{\n    name: \"Temperature\",\n    data: [\n      { x: 0, y: 20 },\n      { x: 1, y: 22 },\n      { x: 2, y: 25 },\n      { x: 3, y: 23 },\n      { x: 4, y: 27 },\n      { x: 5, y: 30 },\n      { x: 6, y: 28 },\n      { x: 7, y: 26 },\n    ],\n    color: \"#2196f3\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nexample1Container.addElement(simpleLineChart);\n\nconst maxPoints = simpleLineChart.getRemarkablePoints(\"maximum\");\nif (maxPoints.length > 0) {\n  const maxPoint = maxPoints[0];\n  const maxPos = simpleLineChart.getRemarkablePointPosition(maxPoint);\n  \n  const maxMarker = new Circle({\n    radius: 8,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#d84315\",\n      strokeWidth: 2,\n    },\n  });\n  \n  maxMarker.position({\n    relativeFrom: maxMarker.center,\n    relativeTo: maxPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(maxMarker);\n  \n  const maxLabel = new Text({\n    content: `Max: ${maxPoint.y.toFixed(1)}°C`,\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#d84315\" },\n  });\n  \n  maxLabel.position({\n    relativeFrom: maxLabel.bottomCenter,\n    relativeTo: maxPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -15,\n  });\n  \n  artboard.addElement(maxLabel);\n}\n\nconst desc1 = new Text({\n  content: \"Single series with markers and maximum point highlighted\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample1Container.addElement(desc1);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Multiple Series\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst multiSeriesChart = new LineChart({\n  series: [\n    {\n      name: \"Product A\",\n      data: [\n        { x: 1, y: 30 },\n        { x: 2, y: 35 },\n        { x: 3, y: 32 },\n        { x: 4, y: 40 },\n        { x: 5, y: 45 },\n        { x: 6, y: 42 },\n      ],\n      color: \"#2196f3\",\n      showMarkers: true,\n    },\n    {\n      name: \"Product B\",\n      data: [\n        { x: 1, y: 20 },\n        { x: 2, y: 25 },\n        { x: 3, y: 28 },\n        { x: 4, y: 30 },\n        { x: 5, y: 33 },\n        { x: 6, y: 38 },\n      ],\n      color: \"#f44336\",\n      showMarkers: true,\n    },\n    {\n      name: \"Product C\",\n      data: [\n        { x: 1, y: 15 },\n        { x: 2, y: 18 },\n        { x: 3, y: 22 },\n        { x: 4, y: 25 },\n        { x: 5, y: 28 },\n        { x: 6, y: 32 },\n      ],\n      color: \"#4caf50\",\n      showMarkers: true,\n    },\n  ],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: false,\n});\n\nexample2Container.addElement(multiSeriesChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample2Container.addElement(legendContainer);\n\nconst legendItems = [\n  { name: \"Product A\", color: \"#2196f3\" },\n  { name: \"Product B\", color: \"#f44336\" },\n  { name: \"Product C\", color: \"#4caf50\" },\n];\n\nlegendItems.forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legendContainer.addElement(legendItem);\n  \n  const colorMarker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(colorMarker);\n  \n  const legendText = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(legendText);\n});\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Smooth Area Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst smoothAreaChart = new LineChart({\n  series: [{\n    name: \"Revenue\",\n    data: [\n      { x: 0, y: 100 },\n      { x: 1, y: 120 },\n      { x: 2, y: 115 },\n      { x: 3, y: 140 },\n      { x: 4, y: 165 },\n      { x: 5, y: 155 },\n      { x: 6, y: 180 },\n      { x: 7, y: 200 },\n    ],\n    color: \"#9c27b0\",\n    showMarkers: false,\n  }],\n  width: 400,\n  height: 250,\n  smoothLines: true,\n  fillArea: true,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  lineWidth: 3,\n  detectRemarkablePoints: false,\n});\n\nexample3Container.addElement(smoothAreaChart);\n\nconst desc3 = new Text({\n  content: \"Smooth curves with area fill for trend visualization\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample3Container.addElement(desc3);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 400,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Remarkable Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst remarkableChart = new LineChart({\n  series: [{\n    name: \"Stock Price\",\n    data: [\n      { x: 0, y: 50 },\n      { x: 1, y: 55 },\n      { x: 2, y: 60 },\n      { x: 3, y: 58 },\n      { x: 4, y: 65 },\n      { x: 5, y: 70 },\n      { x: 6, y: 68 },\n      { x: 7, y: 72 },\n      { x: 8, y: 69 },\n      { x: 9, y: 75 },\n    ],\n    color: \"#00bcd4\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nexample4Container.addElement(remarkableChart);\n\nconst localMaxima = remarkableChart.getRemarkablePoints(\"localMaximum\");\nconst localMinima = remarkableChart.getRemarkablePoints(\"localMinimum\");\n\nlocalMaxima.forEach((point) => {\n  const pos = remarkableChart.getRemarkablePointPosition(point);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#4caf50\",\n      stroke: \"#2e7d32\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n  \n  const arrow = new Text({\n    content: \"▲\",\n    fontSize: 12,\n    style: { fill: \"#2e7d32\" },\n  });\n  \n  arrow.position({\n    relativeFrom: arrow.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -18,\n  });\n  \n  artboard.addElement(arrow);\n});\n\nlocalMinima.forEach((point) => {\n  const pos = remarkableChart.getRemarkablePointPosition(point);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#f44336\",\n      stroke: \"#c62828\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n  \n  const arrow = new Text({\n    content: \"▼\",\n    fontSize: 12,\n    style: { fill: \"#c62828\" },\n  });\n  \n  arrow.position({\n    relativeFrom: arrow.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 18,\n  });\n  \n  artboard.addElement(arrow);\n});\n\nconst desc4 = new Text({\n  content: `Local maxima (▲) and minima (▼) automatically detected`,\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample4Container.addElement(desc4);\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 400,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Wave Functions\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst sineData = [];\nconst cosineData = [];\nconst steps = 50;\n\nfor (let i = 0; i <= steps; i++) {\n  const x = (i / steps) * 4 * Math.PI;\n  sineData.push({ x: x, y: Math.sin(x) });\n  cosineData.push({ x: x, y: Math.cos(x) });\n}\n\nconst waveChart = new LineChart({\n  series: [\n    {\n      name: \"sin(x)\",\n      data: sineData,\n      color: \"#e91e63\",\n      showMarkers: false,\n    },\n    {\n      name: \"cos(x)\",\n      data: cosineData,\n      color: \"#673ab7\",\n      showMarkers: false,\n    },\n  ],\n  width: 400,\n  height: 250,\n  smoothLines: false,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  lineWidth: 2,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n  minY: -1.5,\n  maxY: 1.5,\n});\n\nexample5Container.addElement(waveChart);\n\nconst crossings = waveChart.getRemarkablePoints(\"crossing\").filter(p => p.seriesIndex === 0);\n\ncrossings.forEach((crossing) => {\n  const pos = waveChart.getRemarkablePointPosition(crossing);\n  \n  const marker = new Circle({\n    radius: 4,\n    style: {\n      fill: \"#ff9800\",\n      stroke: \"#f57c00\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n});\n\nconst waveLegend = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample5Container.addElement(waveLegend);\n\n[\n  { name: \"sin(x)\", color: \"#e91e63\" },\n  { name: \"cos(x)\", color: \"#673ab7\" },\n  { name: \"Zero crossings\", color: \"#ff9800\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  waveLegend.addElement(legendItem);\n  \n  const colorMarker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(colorMarker);\n  \n  const legendText = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(legendText);\n});\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample6Container.position({\n  relativeFrom: example6Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 400,\n});\n\nartboard.addElement(example6Container);\n\nconst title6 = new Text({\n  content: \"Example 6: Custom Annotations\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample6Container.addElement(title6);\n\nconst annotatedChart = new LineChart({\n  series: [{\n    name: \"Growth\",\n    data: [\n      { x: 0, y: 10, label: \"Start\" },\n      { x: 1, y: 15 },\n      { x: 2, y: 22 },\n      { x: 3, y: 28, label: \"Milestone\" },\n      { x: 4, y: 35 },\n      { x: 5, y: 50, label: \"Target\" },\n    ],\n    color: \"#009688\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: false,\n});\n\nexample6Container.addElement(annotatedChart);\n\nconst allPoints = annotatedChart.getSeriesDataPoints(0);\n\nallPoints.forEach((point) => {\n  if (point.label) {\n    const pos = point.position;\n    \n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"none\",\n        stroke: \"#009688\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n    \n    const label = new Text({\n      content: point.label,\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#00695c\" },\n    });\n    \n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: -15,\n    });\n    \n    artboard.addElement(label);\n    \n    const valueLabel = new Text({\n      content: `${point.y}`,\n      fontSize: 10,\n      style: { fill: \"#00695c\" },\n    });\n    \n    valueLabel.position({\n      relativeFrom: valueLabel.topCenter,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 15,\n    });\n    \n    artboard.addElement(valueLabel);\n  }\n});\n\nconst desc6 = new Text({\n  content: \"Using data point positions for custom annotations\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample6Container.addElement(desc6);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw an artboard containing several different types of charts. Include some line charts with various styles, like smooth lines or multiple data series. Add markers to highlight interesting points in the data. Also, include annotations and a legend to explain the data. Use different colors for different data sets and arrange them in a grid layout with titles and descriptions for each chart."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  LineChart,\n  Text,\n  Circle,\n  Line,\n  Arrow,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Simple Line Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst simpleLineChart = new LineChart({\n  series: [{\n    name: \"Temperature\",\n    data: [\n      { x: 0, y: 20 },\n      { x: 1, y: 22 },\n      { x: 2, y: 25 },\n      { x: 3, y: 23 },\n      { x: 4, y: 27 },\n      { x: 5, y: 30 },\n      { x: 6, y: 28 },\n      { x: 7, y: 26 },\n    ],\n    color: \"#2196f3\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nexample1Container.addElement(simpleLineChart);\n\nconst maxPoints = simpleLineChart.getRemarkablePoints(\"maximum\");\nif (maxPoints.length > 0) {\n  const maxPoint = maxPoints[0];\n  const maxPos = simpleLineChart.getRemarkablePointPosition(maxPoint);\n  \n  const maxMarker = new Circle({\n    radius: 8,\n    style: {\n      fill: \"#ff5722\",\n      stroke: \"#d84315\",\n      strokeWidth: 2,\n    },\n  });\n  \n  maxMarker.position({\n    relativeFrom: maxMarker.center,\n    relativeTo: maxPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(maxMarker);\n  \n  const maxLabel = new Text({\n    content: `Max: ${maxPoint.y.toFixed(1)}°C`,\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#d84315\" },\n  });\n  \n  maxLabel.position({\n    relativeFrom: maxLabel.bottomCenter,\n    relativeTo: maxPos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -15,\n  });\n  \n  artboard.addElement(maxLabel);\n}\n\nconst desc1 = new Text({\n  content: \"Single series with markers and maximum point highlighted\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample1Container.addElement(desc1);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Multiple Series\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst multiSeriesChart = new LineChart({\n  series: [\n    {\n      name: \"Product A\",\n      data: [\n        { x: 1, y: 30 },\n        { x: 2, y: 35 },\n        { x: 3, y: 32 },\n        { x: 4, y: 40 },\n        { x: 5, y: 45 },\n        { x: 6, y: 42 },\n      ],\n      color: \"#2196f3\",\n      showMarkers: true,\n    },\n    {\n      name: \"Product B\",\n      data: [\n        { x: 1, y: 20 },\n        { x: 2, y: 25 },\n        { x: 3, y: 28 },\n        { x: 4, y: 30 },\n        { x: 5, y: 33 },\n        { x: 6, y: 38 },\n      ],\n      color: \"#f44336\",\n      showMarkers: true,\n    },\n    {\n      name: \"Product C\",\n      data: [\n        { x: 1, y: 15 },\n        { x: 2, y: 18 },\n        { x: 3, y: 22 },\n        { x: 4, y: 25 },\n        { x: 5, y: 28 },\n        { x: 6, y: 32 },\n      ],\n      color: \"#4caf50\",\n      showMarkers: true,\n    },\n  ],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: false,\n});\n\nexample2Container.addElement(multiSeriesChart);\n\nconst legendContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample2Container.addElement(legendContainer);\n\nconst legendItems = [\n  { name: \"Product A\", color: \"#2196f3\" },\n  { name: \"Product B\", color: \"#f44336\" },\n  { name: \"Product C\", color: \"#4caf50\" },\n];\n\nlegendItems.forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legendContainer.addElement(legendItem);\n  \n  const colorMarker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(colorMarker);\n  \n  const legendText = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(legendText);\n});\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Smooth Area Chart\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst smoothAreaChart = new LineChart({\n  series: [{\n    name: \"Revenue\",\n    data: [\n      { x: 0, y: 100 },\n      { x: 1, y: 120 },\n      { x: 2, y: 115 },\n      { x: 3, y: 140 },\n      { x: 4, y: 165 },\n      { x: 5, y: 155 },\n      { x: 6, y: 180 },\n      { x: 7, y: 200 },\n    ],\n    color: \"#9c27b0\",\n    showMarkers: false,\n  }],\n  width: 400,\n  height: 250,\n  smoothLines: true,\n  fillArea: true,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  lineWidth: 3,\n  detectRemarkablePoints: false,\n});\n\nexample3Container.addElement(smoothAreaChart);\n\nconst desc3 = new Text({\n  content: \"Smooth curves with area fill for trend visualization\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample3Container.addElement(desc3);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 400,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Remarkable Points\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst remarkableChart = new LineChart({\n  series: [{\n    name: \"Stock Price\",\n    data: [\n      { x: 0, y: 50 },\n      { x: 1, y: 55 },\n      { x: 2, y: 60 },\n      { x: 3, y: 58 },\n      { x: 4, y: 65 },\n      { x: 5, y: 70 },\n      { x: 6, y: 68 },\n      { x: 7, y: 72 },\n      { x: 8, y: 69 },\n      { x: 9, y: 75 },\n    ],\n    color: \"#00bcd4\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n});\n\nexample4Container.addElement(remarkableChart);\n\nconst localMaxima = remarkableChart.getRemarkablePoints(\"localMaximum\");\nconst localMinima = remarkableChart.getRemarkablePoints(\"localMinimum\");\n\nlocalMaxima.forEach((point) => {\n  const pos = remarkableChart.getRemarkablePointPosition(point);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#4caf50\",\n      stroke: \"#2e7d32\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n  \n  const arrow = new Text({\n    content: \"▲\",\n    fontSize: 12,\n    style: { fill: \"#2e7d32\" },\n  });\n  \n  arrow.position({\n    relativeFrom: arrow.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -18,\n  });\n  \n  artboard.addElement(arrow);\n});\n\nlocalMinima.forEach((point) => {\n  const pos = remarkableChart.getRemarkablePointPosition(point);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: {\n      fill: \"#f44336\",\n      stroke: \"#c62828\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n  \n  const arrow = new Text({\n    content: \"▼\",\n    fontSize: 12,\n    style: { fill: \"#c62828\" },\n  });\n  \n  arrow.position({\n    relativeFrom: arrow.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 18,\n  });\n  \n  artboard.addElement(arrow);\n});\n\nconst desc4 = new Text({\n  content: `Local maxima (▲) and minima (▼) automatically detected`,\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample4Container.addElement(desc4);\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 400,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Wave Functions\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst sineData = [];\nconst cosineData = [];\nconst steps = 50;\n\nfor (let i = 0; i <= steps; i++) {\n  const x = (i / steps) * 4 * Math.PI;\n  sineData.push({ x: x, y: Math.sin(x) });\n  cosineData.push({ x: x, y: Math.cos(x) });\n}\n\nconst waveChart = new LineChart({\n  series: [\n    {\n      name: \"sin(x)\",\n      data: sineData,\n      color: \"#e91e63\",\n      showMarkers: false,\n    },\n    {\n      name: \"cos(x)\",\n      data: cosineData,\n      color: \"#673ab7\",\n      showMarkers: false,\n    },\n  ],\n  width: 400,\n  height: 250,\n  smoothLines: false,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  lineWidth: 2,\n  detectRemarkablePoints: true,\n  showRemarkablePoints: false,\n  minY: -1.5,\n  maxY: 1.5,\n});\n\nexample5Container.addElement(waveChart);\n\nconst crossings = waveChart.getRemarkablePoints(\"crossing\").filter(p => p.seriesIndex === 0);\n\ncrossings.forEach((crossing) => {\n  const pos = waveChart.getRemarkablePointPosition(crossing);\n  \n  const marker = new Circle({\n    radius: 4,\n    style: {\n      fill: \"#ff9800\",\n      stroke: \"#f57c00\",\n      strokeWidth: 2,\n    },\n  });\n  \n  marker.position({\n    relativeFrom: marker.center,\n    relativeTo: pos,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(marker);\n});\n\nconst waveLegend = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample5Container.addElement(waveLegend);\n\n[\n  { name: \"sin(x)\", color: \"#e91e63\" },\n  { name: \"cos(x)\", color: \"#673ab7\" },\n  { name: \"Zero crossings\", color: \"#ff9800\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  waveLegend.addElement(legendItem);\n  \n  const colorMarker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(colorMarker);\n  \n  const legendText = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(legendText);\n});\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample6Container.position({\n  relativeFrom: example6Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 400,\n});\n\nartboard.addElement(example6Container);\n\nconst title6 = new Text({\n  content: \"Example 6: Custom Annotations\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample6Container.addElement(title6);\n\nconst annotatedChart = new LineChart({\n  series: [{\n    name: \"Growth\",\n    data: [\n      { x: 0, y: 10, label: \"Start\" },\n      { x: 1, y: 15 },\n      { x: 2, y: 22 },\n      { x: 3, y: 28, label: \"Milestone\" },\n      { x: 4, y: 35 },\n      { x: 5, y: 50, label: \"Target\" },\n    ],\n    color: \"#009688\",\n    showMarkers: true,\n  }],\n  width: 400,\n  height: 250,\n  showGrid: true,\n  showAxes: true,\n  showAxisLabels: true,\n  detectRemarkablePoints: false,\n});\n\nexample6Container.addElement(annotatedChart);\n\nconst allPoints = annotatedChart.getSeriesDataPoints(0);\n\nallPoints.forEach((point) => {\n  if (point.label) {\n    const pos = point.position;\n    \n    const marker = new Circle({\n      radius: 8,\n      style: {\n        fill: \"none\",\n        stroke: \"#009688\",\n        strokeWidth: 2,\n      },\n    });\n    \n    marker.position({\n      relativeFrom: marker.center,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 0,\n    });\n    \n    artboard.addElement(marker);\n    \n    const label = new Text({\n      content: point.label,\n      fontSize: 12,\n      fontWeight: \"bold\",\n      style: { fill: \"#00695c\" },\n    });\n    \n    label.position({\n      relativeFrom: label.bottomCenter,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: -15,\n    });\n    \n    artboard.addElement(label);\n    \n    const valueLabel = new Text({\n      content: `${point.y}`,\n      fontSize: 10,\n      style: { fill: \"#00695c\" },\n    });\n    \n    valueLabel.position({\n      relativeFrom: valueLabel.topCenter,\n      relativeTo: pos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: 15,\n    });\n    \n    artboard.addElement(valueLabel);\n  }\n});\n\nconst desc6 = new Text({\n  content: \"Using data point positions for custom annotations\",\n  fontSize: 12,\n  style: { fill: \"#616161\" },\n});\n\nexample6Container.addElement(desc6);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a dashboard with five examples. The first example should be a bar and line chart titled 'Actual Sales vs Target' with quarters on the x-axis and sales in millions on the y-axis. Use blue bars for actual sales data and red lines for target data. Add a legend with colored circles indicating 'Actual' and 'Target'. The second example is an area and line chart titled 'Revenue Forecast' with months on the x-axis and revenue in thousands on the y-axis. Display historical data as a solid blue line and forecast data as a dashed purple line with a light purple area fill. Include a legend for 'Historical' and 'Forecast (projected)'. The third example is a scatter plot with a trend line titled 'Data with Trend Line', using blue points and a red dashed trend line, along with a legend for 'Data Points' and 'Trend'. The fourth example is a bar chart titled 'Category Positioning' with monthly performance scores, highlighting the month with the highest score using a green circle and label. Finally, the fifth example is a multi-layer chart titled 'Budget vs Efficiency Analysis', featuring blue bars for budget spent, orange lines for efficiency, and a green area for the target, accompanied by a legend for all elements."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Chart,\n  BarLayer,\n  LineLayer,\n  AreaLayer,\n  ScatterLayer,\n  Text,\n  Circle,\n  Arrow,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Actual Sales vs Target\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst actualSales = [\n  { label: \"Q1\", value: 45 },\n  { label: \"Q2\", value: 52 },\n  { label: \"Q3\", value: 48 },\n  { label: \"Q4\", value: 61 },\n];\n\nconst targetLine = [\n  { x: 0.5, y: 50 },\n  { x: 1.5, y: 50 },\n  { x: 2.5, y: 55 },\n  { x: 3.5, y: 55 },\n];\n\nconst barLineChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new BarLayer({\n      id: \"sales\",\n      data: actualSales,\n      color: \"#2196f3\",\n    }),\n    new LineLayer({\n      id: \"target\",\n      data: targetLine,\n      color: \"#f44336\",\n      lineWidth: 3,\n      showMarkers: true,\n      markerSize: 8,\n    }),\n  ],\n  title: \"Sales Performance\",\n  xAxisLabel: \"Quarter\",\n  yAxisLabel: \"Sales ($M)\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample1Container.addElement(barLineChart);\n\nconst legend1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample1Container.addElement(legend1);\n\n[\n  { name: \"Actual\", color: \"#2196f3\" },\n  { name: \"Target\", color: \"#f44336\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend1.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Revenue Forecast\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst historicalData = [\n  { x: 1, y: 100 },\n  { x: 2, y: 110 },\n  { x: 3, y: 120 },\n  { x: 4, y: 115 },\n  { x: 5, y: 130 },\n  { x: 6, y: 140 },\n];\n\nconst forecastData = [\n  { x: 6, y: 140 },\n  { x: 7, y: 145 },\n  { x: 8, y: 155 },\n  { x: 9, y: 165 },\n  { x: 10, y: 170 },\n];\n\nconst forecastChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new AreaLayer({\n      id: \"forecast-area\",\n      data: forecastData,\n      color: \"#9c27b0\",\n      style: { fillOpacity: \"0.2\" },\n      showLine: false,\n    }),\n    new LineLayer({\n      id: \"historical\",\n      data: historicalData,\n      color: \"#2196f3\",\n      lineWidth: 3,\n      showMarkers: true,\n    }),\n    new LineLayer({\n      id: \"forecast\",\n      data: forecastData,\n      color: \"#9c27b0\",\n      lineWidth: 3,\n      showMarkers: true,\n      lineStyle: { strokeDasharray: \"5,5\" },\n    }),\n  ],\n  title: \"Revenue Projection\",\n  xAxisLabel: \"Month\",\n  yAxisLabel: \"Revenue ($K)\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample2Container.addElement(forecastChart);\n\nconst desc2 = new Text({\n  content: \"Area fill shows the trend visually under the forecast line\",\n  fontSize: 11,\n  style: { fill: \"#616161\" },\n});\n\nexample2Container.addElement(desc2);\n\nconst legend2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n});\n\nexample2Container.addElement(legend2);\n\n[\n  { name: \"Historical\", color: \"#2196f3\" },\n  { name: \"Forecast (projected)\", color: \"#9c27b0\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend2.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Data with Trend Line\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst scatterData = [\n  { x: 1, y: 20 },\n  { x: 2, y: 23 },\n  { x: 3, y: 21 },\n  { x: 4, y: 26 },\n  { x: 5, y: 28 },\n  { x: 6, y: 25 },\n  { x: 7, y: 30 },\n  { x: 8, y: 32 },\n  { x: 9, y: 29 },\n  { x: 10, y: 35 },\n];\n\nconst trendLine = [\n  { x: 1, y: 20 },\n  { x: 10, y: 34 },\n];\n\nconst scatterChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new LineLayer({\n      id: \"trend\",\n      data: trendLine,\n      color: \"#f44336\",\n      lineWidth: 2,\n      showMarkers: false,\n      lineStyle: { strokeDasharray: \"4,4\" },\n    }),\n    new ScatterLayer({\n      id: \"data\",\n      data: scatterData,\n      color: \"#2196f3\",\n      pointSize: 8,\n    }),\n  ],\n  title: \"Scatter Plot with Trend\",\n  xAxisLabel: \"Time\",\n  yAxisLabel: \"Value\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample3Container.addElement(scatterChart);\n\nconst legend3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n});\n\nexample3Container.addElement(legend3);\n\n[\n  { name: \"Data Points\", color: \"#2196f3\" },\n  { name: \"Trend\", color: \"#f44336\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend3.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 380,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Category Positioning\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst desc4 = new Text({\n  content: \"Using getCategoryPosition() to highlight categorical data\",\n  fontSize: 11,\n  style: { fill: \"#616161\" },\n});\n\nexample4Container.addElement(desc4);\n\nconst performanceData = [\n  { label: \"Jan\", value: 85 },\n  { label: \"Feb\", value: 78 },\n  { label: \"Mar\", value: 92 },\n  { label: \"Apr\", value: 88 },\n];\n\nconst performanceBarLayer = new BarLayer({\n  id: \"performance\",\n  data: performanceData,\n  color: \"#00bcd4\",\n});\n\nconst annotationChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [performanceBarLayer],\n  title: \"Performance Score\",\n  xAxisLabel: \"Month\",\n  yAxisLabel: \"Score\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample4Container.addElement(annotationChart);\n\nconst maxValue = Math.max(...performanceData.map(d => d.value));\nconst bestMonth = performanceData.find(d => d.value === maxValue);\n\nconst marPosition = annotationChart.getCategoryPosition(bestMonth.label);\n\nif (marPosition) {\n  const highlightCircle = new Circle({\n    radius: 15,\n    style: {\n      fill: \"none\",\n      stroke: \"#4caf50\",\n      strokeWidth: 3,\n    },\n  });\n\n  highlightCircle.position({\n    relativeFrom: highlightCircle.center,\n    relativeTo: marPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -8,\n  });\n\n  artboard.addElement(highlightCircle);\n\n  const highlightLabel = new Text({\n    content: bestMonth.label,\n    fontSize: 13,\n    fontWeight: \"bold\",\n    style: { fill: \"#4caf50\" },\n  });\n\n  highlightLabel.position({\n    relativeFrom: highlightLabel.bottomCenter,\n    relativeTo: marPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -25,\n  });\n\n  artboard.addElement(highlightLabel);\n}\n\nperformanceData.forEach((dataPoint, index) => {\n  const barPos = annotationChart.getCategoryPosition(dataPoint.label);\n  if (barPos) {\n    const valueLabel = new Text({\n      content: `${dataPoint.value}`,\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#424242\" },\n    });\n    \n    valueLabel.position({\n      relativeFrom: valueLabel.bottomCenter,\n      relativeTo: barPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: -5,\n    });\n    \n    artboard.addElement(valueLabel);\n  }\n});\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 380,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Multi-Layer Analysis\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst budgetSpent = [\n  { label: \"Marketing\", value: 45 },\n  { label: \"R&D\", value: 60 },\n  { label: \"Sales\", value: 38 },\n  { label: \"Operations\", value: 52 },\n];\n\nconst efficiencyLine = [\n  { x: 0.5, y: 75 },\n  { x: 1.5, y: 85 },\n  { x: 2.5, y: 70 },\n  { x: 3.5, y: 80 },\n];\n\nconst targetArea = [\n  { x: 0, y: 70 },\n  { x: 4, y: 70 },\n];\n\nconst complexChart = new Chart({\n  width: 800,\n  height: 300,\n  layers: [\n    new AreaLayer({\n      data: targetArea,\n      color: \"#4caf50\",\n      style: { fillOpacity: \"0.1\" },\n      showLine: true,\n      lineStyle: { strokeDasharray: \"4,4\" },\n      lineWidth: 2,\n    }),\n    new BarLayer({\n      data: budgetSpent,\n      color: \"#2196f3\",\n      style: { fillOpacity: \"0.7\" },\n    }),\n    new LineLayer({\n      data: efficiencyLine,\n      color: \"#ff9800\",\n      lineWidth: 3,\n      showMarkers: true,\n      markerSize: 10,\n    }),\n  ],\n  title: \"Budget vs Efficiency Analysis\",\n  xAxisLabel: \"Department\",\n  yAxisLabel: \"Value\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample5Container.addElement(complexChart);\n\nconst legend5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample5Container.addElement(legend5);\n\n[\n  { name: \"Budget Spent ($K)\", color: \"#2196f3\" },\n  { name: \"Efficiency (%)\", color: \"#ff9800\" },\n  { name: \"Target (70%)\", color: \"#4caf50\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend5.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a comprehensive multi-chart dashboard with several examples. Incorporate various types of charts like bar, line, area, and scatter plots. Use a mix of colors to differentiate data types, and ensure to include legends for each example to explain the data representations. Highlight specific points or trends where necessary, and arrange the examples in a visually appealing, organized manner. Ensure each chart has appropriate titles and axis labels, and make use of padding and spacing to maintain clarity and readability."},{"role":"assistant","content":"import {\n  Artboard,\n  Container,\n  Chart,\n  BarLayer,\n  LineLayer,\n  AreaLayer,\n  ScatterLayer,\n  Text,\n  Circle,\n  Arrow,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.position({\n  relativeFrom: example1Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(example1Container);\n\nconst title1 = new Text({\n  content: \"Example 1: Actual Sales vs Target\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample1Container.addElement(title1);\n\nconst actualSales = [\n  { label: \"Q1\", value: 45 },\n  { label: \"Q2\", value: 52 },\n  { label: \"Q3\", value: 48 },\n  { label: \"Q4\", value: 61 },\n];\n\nconst targetLine = [\n  { x: 0.5, y: 50 },\n  { x: 1.5, y: 50 },\n  { x: 2.5, y: 55 },\n  { x: 3.5, y: 55 },\n];\n\nconst barLineChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new BarLayer({\n      id: \"sales\",\n      data: actualSales,\n      color: \"#2196f3\",\n    }),\n    new LineLayer({\n      id: \"target\",\n      data: targetLine,\n      color: \"#f44336\",\n      lineWidth: 3,\n      showMarkers: true,\n      markerSize: 8,\n    }),\n  ],\n  title: \"Sales Performance\",\n  xAxisLabel: \"Quarter\",\n  yAxisLabel: \"Sales ($M)\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample1Container.addElement(barLineChart);\n\nconst legend1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample1Container.addElement(legend1);\n\n[\n  { name: \"Actual\", color: \"#2196f3\" },\n  { name: \"Target\", color: \"#f44336\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend1.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.position({\n  relativeFrom: example2Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 0,\n});\n\nartboard.addElement(example2Container);\n\nconst title2 = new Text({\n  content: \"Example 2: Revenue Forecast\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample2Container.addElement(title2);\n\nconst historicalData = [\n  { x: 1, y: 100 },\n  { x: 2, y: 110 },\n  { x: 3, y: 120 },\n  { x: 4, y: 115 },\n  { x: 5, y: 130 },\n  { x: 6, y: 140 },\n];\n\nconst forecastData = [\n  { x: 6, y: 140 },\n  { x: 7, y: 145 },\n  { x: 8, y: 155 },\n  { x: 9, y: 165 },\n  { x: 10, y: 170 },\n];\n\nconst forecastChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new AreaLayer({\n      id: \"forecast-area\",\n      data: forecastData,\n      color: \"#9c27b0\",\n      style: { fillOpacity: \"0.2\" },\n      showLine: false,\n    }),\n    new LineLayer({\n      id: \"historical\",\n      data: historicalData,\n      color: \"#2196f3\",\n      lineWidth: 3,\n      showMarkers: true,\n    }),\n    new LineLayer({\n      id: \"forecast\",\n      data: forecastData,\n      color: \"#9c27b0\",\n      lineWidth: 3,\n      showMarkers: true,\n      lineStyle: { strokeDasharray: \"5,5\" },\n    }),\n  ],\n  title: \"Revenue Projection\",\n  xAxisLabel: \"Month\",\n  yAxisLabel: \"Revenue ($K)\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample2Container.addElement(forecastChart);\n\nconst desc2 = new Text({\n  content: \"Area fill shows the trend visually under the forecast line\",\n  fontSize: 11,\n  style: { fill: \"#616161\" },\n});\n\nexample2Container.addElement(desc2);\n\nconst legend2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n});\n\nexample2Container.addElement(legend2);\n\n[\n  { name: \"Historical\", color: \"#2196f3\" },\n  { name: \"Forecast (projected)\", color: \"#9c27b0\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend2.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.position({\n  relativeFrom: example3Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 960,\n  y: 0,\n});\n\nartboard.addElement(example3Container);\n\nconst title3 = new Text({\n  content: \"Example 3: Data with Trend Line\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample3Container.addElement(title3);\n\nconst scatterData = [\n  { x: 1, y: 20 },\n  { x: 2, y: 23 },\n  { x: 3, y: 21 },\n  { x: 4, y: 26 },\n  { x: 5, y: 28 },\n  { x: 6, y: 25 },\n  { x: 7, y: 30 },\n  { x: 8, y: 32 },\n  { x: 9, y: 29 },\n  { x: 10, y: 35 },\n];\n\nconst trendLine = [\n  { x: 1, y: 20 },\n  { x: 10, y: 34 },\n];\n\nconst scatterChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [\n    new LineLayer({\n      id: \"trend\",\n      data: trendLine,\n      color: \"#f44336\",\n      lineWidth: 2,\n      showMarkers: false,\n      lineStyle: { strokeDasharray: \"4,4\" },\n    }),\n    new ScatterLayer({\n      id: \"data\",\n      data: scatterData,\n      color: \"#2196f3\",\n      pointSize: 8,\n    }),\n  ],\n  title: \"Scatter Plot with Trend\",\n  xAxisLabel: \"Time\",\n  yAxisLabel: \"Value\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample3Container.addElement(scatterChart);\n\nconst legend3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 15,\n  horizontalAlignment: \"center\",\n});\n\nexample3Container.addElement(legend3);\n\n[\n  { name: \"Data Points\", color: \"#2196f3\" },\n  { name: \"Trend\", color: \"#f44336\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend3.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 5,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 11,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.position({\n  relativeFrom: example4Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 380,\n});\n\nartboard.addElement(example4Container);\n\nconst title4 = new Text({\n  content: \"Example 4: Category Positioning\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample4Container.addElement(title4);\n\nconst desc4 = new Text({\n  content: \"Using getCategoryPosition() to highlight categorical data\",\n  fontSize: 11,\n  style: { fill: \"#616161\" },\n});\n\nexample4Container.addElement(desc4);\n\nconst performanceData = [\n  { label: \"Jan\", value: 85 },\n  { label: \"Feb\", value: 78 },\n  { label: \"Mar\", value: 92 },\n  { label: \"Apr\", value: 88 },\n];\n\nconst performanceBarLayer = new BarLayer({\n  id: \"performance\",\n  data: performanceData,\n  color: \"#00bcd4\",\n});\n\nconst annotationChart = new Chart({\n  width: 400,\n  height: 250,\n  layers: [performanceBarLayer],\n  title: \"Performance Score\",\n  xAxisLabel: \"Month\",\n  yAxisLabel: \"Score\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample4Container.addElement(annotationChart);\n\nconst maxValue = Math.max(...performanceData.map(d => d.value));\nconst bestMonth = performanceData.find(d => d.value === maxValue);\n\nconst marPosition = annotationChart.getCategoryPosition(bestMonth.label);\n\nif (marPosition) {\n  const highlightCircle = new Circle({\n    radius: 15,\n    style: {\n      fill: \"none\",\n      stroke: \"#4caf50\",\n      strokeWidth: 3,\n    },\n  });\n\n  highlightCircle.position({\n    relativeFrom: highlightCircle.center,\n    relativeTo: marPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -8,\n  });\n\n  artboard.addElement(highlightCircle);\n\n  const highlightLabel = new Text({\n    content: bestMonth.label,\n    fontSize: 13,\n    fontWeight: \"bold\",\n    style: { fill: \"#4caf50\" },\n  });\n\n  highlightLabel.position({\n    relativeFrom: highlightLabel.bottomCenter,\n    relativeTo: marPosition,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -25,\n  });\n\n  artboard.addElement(highlightLabel);\n}\n\nperformanceData.forEach((dataPoint, index) => {\n  const barPos = annotationChart.getCategoryPosition(dataPoint.label);\n  if (barPos) {\n    const valueLabel = new Text({\n      content: `${dataPoint.value}`,\n      fontSize: 11,\n      fontWeight: \"bold\",\n      style: { fill: \"#424242\" },\n    });\n    \n    valueLabel.position({\n      relativeFrom: valueLabel.bottomCenter,\n      relativeTo: barPos,\n      boxReference: \"artboard\",\n      x: 0,\n      y: -5,\n    });\n    \n    artboard.addElement(valueLabel);\n  }\n});\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 15,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#e0e0e0\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.position({\n  relativeFrom: example5Container.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 480,\n  y: 380,\n});\n\nartboard.addElement(example5Container);\n\nconst title5 = new Text({\n  content: \"Example 5: Multi-Layer Analysis\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nexample5Container.addElement(title5);\n\nconst budgetSpent = [\n  { label: \"Marketing\", value: 45 },\n  { label: \"R&D\", value: 60 },\n  { label: \"Sales\", value: 38 },\n  { label: \"Operations\", value: 52 },\n];\n\nconst efficiencyLine = [\n  { x: 0.5, y: 75 },\n  { x: 1.5, y: 85 },\n  { x: 2.5, y: 70 },\n  { x: 3.5, y: 80 },\n];\n\nconst targetArea = [\n  { x: 0, y: 70 },\n  { x: 4, y: 70 },\n];\n\nconst complexChart = new Chart({\n  width: 800,\n  height: 300,\n  layers: [\n    new AreaLayer({\n      data: targetArea,\n      color: \"#4caf50\",\n      style: { fillOpacity: \"0.1\" },\n      showLine: true,\n      lineStyle: { strokeDasharray: \"4,4\" },\n      lineWidth: 2,\n    }),\n    new BarLayer({\n      data: budgetSpent,\n      color: \"#2196f3\",\n      style: { fillOpacity: \"0.7\" },\n    }),\n    new LineLayer({\n      data: efficiencyLine,\n      color: \"#ff9800\",\n      lineWidth: 3,\n      showMarkers: true,\n      markerSize: 10,\n    }),\n  ],\n  title: \"Budget vs Efficiency Analysis\",\n  xAxisLabel: \"Department\",\n  yAxisLabel: \"Value\",\n  showGrid: true,\n  showAxes: true,\n});\n\nexample5Container.addElement(complexChart);\n\nconst legend5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n  horizontalAlignment: \"center\",\n});\n\nexample5Container.addElement(legend5);\n\n[\n  { name: \"Budget Spent ($K)\", color: \"#2196f3\" },\n  { name: \"Efficiency (%)\", color: \"#ff9800\" },\n  { name: \"Target (70%)\", color: \"#4caf50\" },\n].forEach((item) => {\n  const legendItem = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 5,\n  });\n  \n  legend5.addElement(legendItem);\n  \n  const marker = new Circle({\n    radius: 6,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n  \n  legendItem.addElement(marker);\n  \n  const label = new Text({\n    content: item.name,\n    fontSize: 12,\n    style: { fill: \"#424242\" },\n  });\n  \n  legendItem.addElement(label);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and populate it with three types of stacked bar charts. The first chart should be a vertical stacked bar chart titled 'Vertical Stacked Bar Chart: Quarterly Revenue Breakdown', with categories for Q1 to Q4, showing 'Product Sales', 'Services', and 'Licensing' in different colors. The second chart should be a horizontal stacked bar chart titled 'Horizontal Stacked Bar Chart: Project Progress by Team', with categories for four teams, showing 'Completed', 'In Progress', and 'Pending' in different colors. The third chart should be a vertical stacked bar chart titled 'With Annotations: Highlighting Best Quarter', covering four quarters, highlighting the best quarter with stars and annotation. Include legends for each chart with color indicators and text labels."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Stacked Bar Charts\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Vertical Stacked Bar Chart: Quarterly Revenue Breakdown\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst verticalStackedChart = new BarChart({\n  categories: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\n  series: [\n    {\n      name: \"Product Sales\",\n      data: [120, 145, 168, 190],\n      color: \"#2196f3\",\n    },\n    {\n      name: \"Services\",\n      data: [80, 95, 110, 125],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"Licensing\",\n      data: [40, 50, 45, 60],\n      color: \"#ff9800\",\n    },\n  ],\n  stacked: true,\n  orientation: \"vertical\",\n  width: 700,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 40,\n    right: 40,\n    bottom: 60,\n    left: 80,\n  },\n});\n\nmainContainer.addElement(verticalStackedChart);\n\nconst legend1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend1Container);\n\nconst legend1Items = [\n  { color: \"#2196f3\", label: \"Product Sales\" },\n  { color: \"#4caf50\", label: \"Services\" },\n  { color: \"#ff9800\", label: \"Licensing\" },\n];\n\nlegend1Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend1Container.addElement(itemContainer);\n});\n\n\nconst example2Title = new Text({\n  content: \"2. Horizontal Stacked Bar Chart: Project Progress by Team\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst horizontalStackedChart = new BarChart({\n  categories: [\"Backend Team\", \"Frontend Team\", \"DevOps Team\", \"Design Team\"],\n  series: [\n    {\n      name: \"Completed\",\n      data: [85, 92, 78, 95],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"In Progress\",\n      data: [12, 15, 18, 8],\n      color: \"#ff9800\",\n    },\n    {\n      name: \"Pending\",\n      data: [8, 6, 10, 4],\n      color: \"#f44336\",\n    },\n  ],\n  stacked: true,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 40,\n    right: 60,\n    bottom: 50,\n    left: 140,\n  },\n});\n\nmainContainer.addElement(horizontalStackedChart);\n\nconst legend2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend2Container);\n\nconst legend2Items = [\n  { color: \"#4caf50\", label: \"Completed\" },\n  { color: \"#ff9800\", label: \"In Progress\" },\n  { color: \"#f44336\", label: \"Pending\" },\n];\n\nlegend2Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend2Container.addElement(itemContainer);\n});\n\n\nconst example3Title = new Text({\n  content: \"3. With Annotations: Highlighting Best Quarter\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst annotatedStackedChart = new BarChart({\n  categories: [\"Jan-Mar\", \"Apr-Jun\", \"Jul-Sep\", \"Oct-Dec\"],\n  series: [\n    {\n      name: \"North Region\",\n      data: [45, 52, 48, 65],\n      color: \"#2196f3\",\n    },\n    {\n      name: \"South Region\",\n      data: [38, 45, 42, 58],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"East Region\",\n      data: [32, 38, 35, 48],\n      color: \"#ff9800\",\n    },\n    {\n      name: \"West Region\",\n      data: [28, 34, 31, 44],\n      color: \"#9c27b0\",\n    },\n  ],\n  stacked: true,\n  orientation: \"vertical\",\n  width: 750,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 60,\n    right: 40,\n    bottom: 60,\n    left: 80,\n  },\n});\n\nmainContainer.addElement(annotatedStackedChart);\n\nconst bars = annotatedStackedChart.getBars();\nconst bestQuarterBar = bars[3]; // Oct-Dec\n\nif (bestQuarterBar) {\n  const star = new Text({\n    content: \"⭐ Best Quarter!\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n    style: { fill: \"#ff6f00\" },\n  });\n\n  star.position({\n    relativeFrom: star.bottomCenter,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -20,\n  });\n\n  artboard.addElement(star);\n\n  const totalLabel = new Text({\n    content: `Total: ${bestQuarterBar.value.toFixed(0)}`,\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#424242\" },\n  });\n\n  totalLabel.position({\n    relativeFrom: totalLabel.bottomCenter,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -5,\n  });\n\n  artboard.addElement(totalLabel);\n\n  const pointer = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: 0, y: -10 },\n    style: {\n      stroke: \"#ff6f00\",\n      strokeWidth: \"2\",\n      strokeDasharray: \"3,3\",\n    },\n  });\n\n  pointer.position({\n    relativeFrom: pointer.end,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(pointer);\n}\n\nconst legend3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n});\n\nmainContainer.addElement(legend3Container);\n\nconst legend3Items = [\n  { color: \"#2196f3\", label: \"North Region\" },\n  { color: \"#4caf50\", label: \"South Region\" },\n  { color: \"#ff9800\", label: \"East Region\" },\n  { color: \"#9c27b0\", label: \"West Region\" },\n];\n\nlegend3Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend3Container.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a series of stacked bar charts on a light background. Include a few charts showing different categories and data series, with some charts oriented vertically and others horizontally. Use a variety of colors to distinguish between the data series and include legends that explain what each color represents. Highlight important data points with annotations or symbols to emphasize their significance."},{"role":"assistant","content":"import {\n  Artboard,\n  BarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Stacked Bar Charts\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Vertical Stacked Bar Chart: Quarterly Revenue Breakdown\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst verticalStackedChart = new BarChart({\n  categories: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\n  series: [\n    {\n      name: \"Product Sales\",\n      data: [120, 145, 168, 190],\n      color: \"#2196f3\",\n    },\n    {\n      name: \"Services\",\n      data: [80, 95, 110, 125],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"Licensing\",\n      data: [40, 50, 45, 60],\n      color: \"#ff9800\",\n    },\n  ],\n  stacked: true,\n  orientation: \"vertical\",\n  width: 700,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 40,\n    right: 40,\n    bottom: 60,\n    left: 80,\n  },\n});\n\nmainContainer.addElement(verticalStackedChart);\n\nconst legend1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend1Container);\n\nconst legend1Items = [\n  { color: \"#2196f3\", label: \"Product Sales\" },\n  { color: \"#4caf50\", label: \"Services\" },\n  { color: \"#ff9800\", label: \"Licensing\" },\n];\n\nlegend1Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend1Container.addElement(itemContainer);\n});\n\n\nconst example2Title = new Text({\n  content: \"2. Horizontal Stacked Bar Chart: Project Progress by Team\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst horizontalStackedChart = new BarChart({\n  categories: [\"Backend Team\", \"Frontend Team\", \"DevOps Team\", \"Design Team\"],\n  series: [\n    {\n      name: \"Completed\",\n      data: [85, 92, 78, 95],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"In Progress\",\n      data: [12, 15, 18, 8],\n      color: \"#ff9800\",\n    },\n    {\n      name: \"Pending\",\n      data: [8, 6, 10, 4],\n      color: \"#f44336\",\n    },\n  ],\n  stacked: true,\n  orientation: \"horizontal\",\n  width: 700,\n  height: 350,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 40,\n    right: 60,\n    bottom: 50,\n    left: 140,\n  },\n});\n\nmainContainer.addElement(horizontalStackedChart);\n\nconst legend2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend2Container);\n\nconst legend2Items = [\n  { color: \"#4caf50\", label: \"Completed\" },\n  { color: \"#ff9800\", label: \"In Progress\" },\n  { color: \"#f44336\", label: \"Pending\" },\n];\n\nlegend2Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend2Container.addElement(itemContainer);\n});\n\n\nconst example3Title = new Text({\n  content: \"3. With Annotations: Highlighting Best Quarter\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst annotatedStackedChart = new BarChart({\n  categories: [\"Jan-Mar\", \"Apr-Jun\", \"Jul-Sep\", \"Oct-Dec\"],\n  series: [\n    {\n      name: \"North Region\",\n      data: [45, 52, 48, 65],\n      color: \"#2196f3\",\n    },\n    {\n      name: \"South Region\",\n      data: [38, 45, 42, 58],\n      color: \"#4caf50\",\n    },\n    {\n      name: \"East Region\",\n      data: [32, 38, 35, 48],\n      color: \"#ff9800\",\n    },\n    {\n      name: \"West Region\",\n      data: [28, 34, 31, 44],\n      color: \"#9c27b0\",\n    },\n  ],\n  stacked: true,\n  orientation: \"vertical\",\n  width: 750,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  showCategoryLabels: true,\n  showValueLabels: false,\n  detectRemarkablePoints: false,\n  chartPadding: {\n    top: 60,\n    right: 40,\n    bottom: 60,\n    left: 80,\n  },\n});\n\nmainContainer.addElement(annotatedStackedChart);\n\nconst bars = annotatedStackedChart.getBars();\nconst bestQuarterBar = bars[3]; // Oct-Dec\n\nif (bestQuarterBar) {\n  const star = new Text({\n    content: \"⭐ Best Quarter!\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n    style: { fill: \"#ff6f00\" },\n  });\n\n  star.position({\n    relativeFrom: star.bottomCenter,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -20,\n  });\n\n  artboard.addElement(star);\n\n  const totalLabel = new Text({\n    content: `Total: ${bestQuarterBar.value.toFixed(0)}`,\n    fontSize: 12,\n    fontWeight: \"bold\",\n    style: { fill: \"#424242\" },\n  });\n\n  totalLabel.position({\n    relativeFrom: totalLabel.bottomCenter,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: -5,\n  });\n\n  artboard.addElement(totalLabel);\n\n  const pointer = new Line({\n    start: { x: 0, y: 0 },\n    end: { x: 0, y: -10 },\n    style: {\n      stroke: \"#ff6f00\",\n      strokeWidth: \"2\",\n      strokeDasharray: \"3,3\",\n    },\n  });\n\n  pointer.position({\n    relativeFrom: pointer.end,\n    relativeTo: bestQuarterBar.topCenter,\n    boxReference: \"artboard\",\n    x: 0,\n    y: 0,\n  });\n\n  artboard.addElement(pointer);\n}\n\nconst legend3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 20,\n});\n\nmainContainer.addElement(legend3Container);\n\nconst legend3Items = [\n  { color: \"#2196f3\", label: \"North Region\" },\n  { color: \"#4caf50\", label: \"South Region\" },\n  { color: \"#ff9800\", label: \"East Region\" },\n  { color: \"#9c27b0\", label: \"West Region\" },\n];\n\nlegend3Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend3Container.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a light gray background and padding of 40 pixels. Display a title saying 'Radar Charts (Spider Charts)' in bold, dark blue font, size 24. Below, add three radar charts titled '1. Skills Assessment Comparison', '2. Product Feature Comparison', and '3. Team Performance with Peak Highlights', each with bold, dark gray font, size 18. For the first chart, plot two series named 'Candidate A' and 'Candidate B' with data points across six axes: 'Communication', 'Leadership', 'Technical', 'Problem Solving', 'Creativity', and 'Teamwork'. Use a blue color for Candidate A and a green color for Candidate B, both filled, with the chart size 600x600 pixels. Include a legend with circular color markers and labels for each candidate. The second chart compares three products using similar settings but across five axes: 'Performance', 'Design', 'Battery Life', 'Camera', and 'Price', with the series in red, teal, and yellow colors. The third chart shows team performance across four axes: 'Quality', 'Speed', 'Innovation', and 'Collaboration', with data for Q1 and Q2 of 2024, using purple and orange colors. Highlight the peak value on the 'Collaboration' axis for Q2 with an orange circle and label. Add legends with circular markers for each series."},{"role":"assistant","content":"import {\n  Artboard,\n  RadarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Radar Charts (Spider Charts)\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Skills Assessment Comparison\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst skillsChart = new RadarChart({\n  axes: [\"Communication\", \"Leadership\", \"Technical\", \"Problem Solving\", \"Creativity\", \"Teamwork\"],\n  series: [\n    {\n      name: \"Candidate A\",\n      data: [85, 75, 90, 80, 70, 88],\n      color: \"#2196f3\",\n      filled: true,\n    },\n    {\n      name: \"Candidate B\",\n      data: [78, 88, 75, 85, 92, 80],\n      color: \"#4caf50\",\n      filled: true,\n    },\n  ],\n  width: 600,\n  height: 600,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  showValueLabels: false,\n});\n\nmainContainer.addElement(skillsChart);\n\nconst legend1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend1Container);\n\nconst legend1Items = [\n  { color: \"#2196f3\", label: \"Candidate A\" },\n  { color: \"#4caf50\", label: \"Candidate B\" },\n];\n\nlegend1Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend1Container.addElement(itemContainer);\n});\n\n\nconst example2Title = new Text({\n  content: \"2. Product Feature Comparison\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst productChart = new RadarChart({\n  axes: [\"Performance\", \"Design\", \"Battery Life\", \"Camera\", \"Price\"],\n  series: [\n    {\n      name: \"Product X\",\n      data: [90, 85, 70, 95, 60],\n      color: \"#ff6b6b\",\n      filled: true,\n    },\n    {\n      name: \"Product Y\",\n      data: [75, 95, 85, 80, 75],\n      color: \"#4ecdc4\",\n      filled: true,\n    },\n    {\n      name: \"Product Z\",\n      data: [85, 80, 90, 75, 85],\n      color: \"#ffe66d\",\n      filled: true,\n    },\n  ],\n  width: 600,\n  height: 600,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  showValueLabels: true,\n  gridLevels: 5,\n});\n\nmainContainer.addElement(productChart);\n\nconst legend2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend2Container);\n\nconst legend2Items = [\n  { color: \"#ff6b6b\", label: \"Product X\" },\n  { color: \"#4ecdc4\", label: \"Product Y\" },\n  { color: \"#ffe66d\", label: \"Product Z\" },\n];\n\nlegend2Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend2Container.addElement(itemContainer);\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Team Performance with Peak Highlights\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst teamChart = new RadarChart({\n  axes: [\"Quality\", \"Speed\", \"Innovation\", \"Collaboration\"],\n  series: [\n    {\n      name: \"Q1 2024\",\n      data: [78, 82, 75, 88],\n      color: \"#9c27b0\",\n      filled: true,\n    },\n    {\n      name: \"Q2 2024\",\n      data: [85, 88, 82, 92],\n      color: \"#ff9800\",\n      filled: true,\n    },\n  ],\n  width: 550,\n  height: 550,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nmainContainer.addElement(teamChart);\n\nconst bestPos = teamChart.getDataPointPosition(1, 3); // Series 1 (Q2), Axis 3 (Collaboration)\n\nconst bestMarker = new Circle({\n  radius: 12,\n  style: {\n    fill: \"none\",\n    stroke: \"#ff5722\",\n    strokeWidth: 3,\n  },\n});\n\nbestMarker.position({\n  relativeFrom: bestMarker.center,\n  relativeTo: bestPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(bestMarker);\n\nconst bestLabel = new Text({\n  content: \"Peak! 92\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#ff5722\" },\n});\n\nbestLabel.position({\n  relativeFrom: bestLabel.center,\n  relativeTo: bestPos,\n  boxReference: \"artboard\",\n  x: 25,\n  y: 0,\n});\n\nartboard.addElement(bestLabel);\n\nconst legend3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend3Container);\n\nconst legend3Items = [\n  { color: \"#9c27b0\", label: \"Q1 2024\" },\n  { color: \"#ff9800\", label: \"Q2 2024\" },\n];\n\nlegend3Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend3Container.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw an artboard with a neutral background, featuring a main title and several radar charts. Each chart should have titles describing different comparisons, like skills or product features. Include multiple axes and compare several series with different colors. Use circles to represent values on the charts, and provide legends to explain the colors. Highlight any key data points of interest with markers and labels."},{"role":"assistant","content":"import {\n  Artboard,\n  RadarChart,\n  Container,\n  Text,\n  Circle,\n  Line,\n} from \"w2l\";\n\nconst artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#fafafa\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nconst title = new Text({\n  content: \"Radar Charts (Spider Charts)\",\n  fontSize: 24,\n  fontWeight: \"bold\",\n  style: { fill: \"#1a237e\" },\n});\n\nmainContainer.addElement(title);\n\n\nconst example1Title = new Text({\n  content: \"1. Skills Assessment Comparison\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example1Title);\n\nconst skillsChart = new RadarChart({\n  axes: [\"Communication\", \"Leadership\", \"Technical\", \"Problem Solving\", \"Creativity\", \"Teamwork\"],\n  series: [\n    {\n      name: \"Candidate A\",\n      data: [85, 75, 90, 80, 70, 88],\n      color: \"#2196f3\",\n      filled: true,\n    },\n    {\n      name: \"Candidate B\",\n      data: [78, 88, 75, 85, 92, 80],\n      color: \"#4caf50\",\n      filled: true,\n    },\n  ],\n  width: 600,\n  height: 600,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  showValueLabels: false,\n});\n\nmainContainer.addElement(skillsChart);\n\nconst legend1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend1Container);\n\nconst legend1Items = [\n  { color: \"#2196f3\", label: \"Candidate A\" },\n  { color: \"#4caf50\", label: \"Candidate B\" },\n];\n\nlegend1Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend1Container.addElement(itemContainer);\n});\n\n\nconst example2Title = new Text({\n  content: \"2. Product Feature Comparison\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example2Title);\n\nconst productChart = new RadarChart({\n  axes: [\"Performance\", \"Design\", \"Battery Life\", \"Camera\", \"Price\"],\n  series: [\n    {\n      name: \"Product X\",\n      data: [90, 85, 70, 95, 60],\n      color: \"#ff6b6b\",\n      filled: true,\n    },\n    {\n      name: \"Product Y\",\n      data: [75, 95, 85, 80, 75],\n      color: \"#4ecdc4\",\n      filled: true,\n    },\n    {\n      name: \"Product Z\",\n      data: [85, 80, 90, 75, 85],\n      color: \"#ffe66d\",\n      filled: true,\n    },\n  ],\n  width: 600,\n  height: 600,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  showValueLabels: true,\n  gridLevels: 5,\n});\n\nmainContainer.addElement(productChart);\n\nconst legend2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend2Container);\n\nconst legend2Items = [\n  { color: \"#ff6b6b\", label: \"Product X\" },\n  { color: \"#4ecdc4\", label: \"Product Y\" },\n  { color: \"#ffe66d\", label: \"Product Z\" },\n];\n\nlegend2Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend2Container.addElement(itemContainer);\n});\n\n\nconst example3Title = new Text({\n  content: \"3. Team Performance with Peak Highlights\",\n  fontSize: 18,\n  fontWeight: \"bold\",\n  style: { fill: \"#424242\" },\n});\n\nmainContainer.addElement(example3Title);\n\nconst teamChart = new RadarChart({\n  axes: [\"Quality\", \"Speed\", \"Innovation\", \"Collaboration\"],\n  series: [\n    {\n      name: \"Q1 2024\",\n      data: [78, 82, 75, 88],\n      color: \"#9c27b0\",\n      filled: true,\n    },\n    {\n      name: \"Q2 2024\",\n      data: [85, 88, 82, 92],\n      color: \"#ff9800\",\n      filled: true,\n    },\n  ],\n  width: 550,\n  height: 550,\n  maxValue: 100,\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true,\n});\n\nmainContainer.addElement(teamChart);\n\nconst bestPos = teamChart.getDataPointPosition(1, 3); // Series 1 (Q2), Axis 3 (Collaboration)\n\nconst bestMarker = new Circle({\n  radius: 12,\n  style: {\n    fill: \"none\",\n    stroke: \"#ff5722\",\n    strokeWidth: 3,\n  },\n});\n\nbestMarker.position({\n  relativeFrom: bestMarker.center,\n  relativeTo: bestPos,\n  boxReference: \"artboard\",\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(bestMarker);\n\nconst bestLabel = new Text({\n  content: \"Peak! 92\",\n  fontSize: 12,\n  fontWeight: \"bold\",\n  style: { fill: \"#ff5722\" },\n});\n\nbestLabel.position({\n  relativeFrom: bestLabel.center,\n  relativeTo: bestPos,\n  boxReference: \"artboard\",\n  x: 25,\n  y: 0,\n});\n\nartboard.addElement(bestLabel);\n\nconst legend3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 25,\n});\n\nmainContainer.addElement(legend3Container);\n\nconst legend3Items = [\n  { color: \"#9c27b0\", label: \"Q1 2024\" },\n  { color: \"#ff9800\", label: \"Q2 2024\" },\n];\n\nlegend3Items.forEach((item) => {\n  const itemContainer = new Container({\n    width: \"auto\",\n    height: \"auto\",\n    direction: \"horizontal\",\n    spacing: 8,\n    verticalAlignment: \"center\",\n  });\n\n  const colorBox = new Circle({\n    radius: 8,\n    style: { fill: item.color, stroke: \"none\" },\n  });\n\n  itemContainer.addElement(colorBox);\n\n  const labelText = new Text({\n    content: item.label,\n    fontSize: 12,\n    style: { fill: \"#616161\" },\n  });\n\n  itemContainer.addElement(labelText);\n  legend3Container.addElement(itemContainer);\n});\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization on an artboard with dimensions 1400x1000. Include five sections with titles: 1. 'Angles at Intersection (Quadrant Selection)' with two intersecting lines at (120, 200) to (380, 200) and (160, 130) to (340, 270), showing four internal angles labeled UR, UL, LL, LR with different colors and radii. 2. 'Internal vs External at Intersection' showing two intersecting lines at (100, 350) to (400, 350) and (320, 270) to (180, 430), with internal and external angles in the upper-right quadrant. 3. 'Angles at Vertex (Segments)' with two segments from a vertex at (650, 200) to points (750, 150) and (780, 250), showing internal and external angles labeled α and β. 4. 'Right Angle Markers' with two right angles, one marked with a square and the other with a dot. 5. 'Explicit Angles' showing angles of 45°, 90°, 135°, 270°, and a full circle 360° around different centers. Add a summary section highlighting points about intersection and vertex angles."},{"role":"assistant","content":"import {\n  Artboard,\n  Line,\n  Side,\n  Angle,\n  Text,\n  Circle,\n} from \"w2l\";\n\n\nconst artboard = new Artboard({ width: 1400, height: 1000 });\n\n\nconst section1Y = 100;\n\nconst title1 = new Text({\n  content: \"1. Angles at Intersection (Quadrant Selection)\",\n  fontSize: 18,\n});\ntitle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title1.topLeft,\n  x: 50,\n  y: section1Y - 40,\n});\nartboard.addElement(title1);\n\nconst line1 = new Line({\n  start: { x: 120, y: section1Y + 100 },\n  end: { x: 380, y: section1Y + 100 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst line2 = new Line({\n  start: { x: 160, y: section1Y + 30 },\n  end: { x: 340, y: section1Y + 170 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(line1);\nartboard.addElement(line2);\n\nconst angleUR = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"upper-right\",\n  mode: \"internal\",\n  label: (deg) => `UR: ${deg}°`,\n  radius: 40,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n});\n\nconst angleUL = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"upper-left\",\n  mode: \"internal\",\n  label: (deg) => `UL: ${deg}°`,\n  radius: 50,\n  style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n});\n\nconst angleLL = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"lower-left\",\n  mode: \"internal\",\n  label: (deg) => `LL: ${deg}°`,\n  radius: 50,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n});\n\nconst angleLR = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"lower-right\",\n  mode: \"internal\",\n  label: (deg) => `LR: ${deg}°`,\n  radius: 40,\n  style: { stroke: \"#f39c12\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(angleUR);\nartboard.addElement(angleUL);\nartboard.addElement(angleLL);\nartboard.addElement(angleLR);\n\n\nconst section2Y = section1Y + 250;\n\nconst title2 = new Text({\n  content: \"2. Internal vs External at Intersection\",\n  fontSize: 18,\n});\ntitle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title2.topLeft,\n  x: 50,\n  y: section2Y - 40,\n});\nartboard.addElement(title2);\n\nconst line3 = new Line({\n  start: { x: 100, y: section2Y + 100 },\n  end: { x: 400, y: section2Y + 100 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst line4 = new Line({\n  start: { x: 320, y: section2Y + 20 },\n  end: { x: 180, y: section2Y + 180 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(line3);\nartboard.addElement(line4);\n\nconst angleInternal = new Angle({\n  from: \"intersection\",\n  lines: [line3, line4],\n  quadrant: \"upper-right\",\n  mode: \"internal\",\n  showDegrees: true, // Will automatically show degrees\n  radius: 45,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nconst angleExternal = new Angle({\n  from: \"intersection\",\n  lines: [line3, line4],\n  quadrant: \"upper-right\",\n  mode: \"external\",\n  showDegrees: true,\n  radius: 60,\n  style: { stroke: \"#e67e22\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(angleInternal);\nartboard.addElement(angleExternal);\n\n\nconst section3Y = 100;\nconst section3X = 500;\n\nconst title3 = new Text({\n  content: \"3. Angles at Vertex (Segments)\",\n  fontSize: 18,\n});\ntitle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title3.topLeft,\n  x: section3X,\n  y: section3Y - 40,\n});\nartboard.addElement(title3);\n\nconst vertexA = { x: section3X + 150, y: section3Y + 100 };\nconst pointB = { x: section3X + 250, y: section3Y + 50 };\nconst pointC = { x: section3X + 280, y: section3Y + 150 };\n\nconst lineAB = new Line({\n  start: vertexA,\n  end: pointB,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineAC = new Line({\n  start: vertexA,\n  end: pointC,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentAB = new Side({ start: vertexA, end: pointB });\nconst segmentAC = new Side({ start: vertexA, end: pointC });\n\nartboard.addElement(lineAB);\nartboard.addElement(lineAC);\n\nartboard.addElement(\n  new Circle({\n    center: vertexA,\n    radius: 4,\n    style: { fill: \"#e74c3c\", stroke: \"none\" },\n  })\n);\n\nconst angleVertexInternal = new Angle({\n  from: \"vertex\",\n  segments: [segmentAB, segmentAC],\n  mode: \"internal\",\n  label: \"α\",\n  radius: 40,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n});\n\nconst angleVertexExternal = new Angle({\n  from: \"vertex\",\n  segments: [segmentAB, segmentAC],\n  mode: \"external\",\n  label: \"β\",\n  radius: 55,\n  style: { stroke: \"#3498db\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(angleVertexInternal);\nartboard.addElement(angleVertexExternal);\n\n\nconst section4Y = section3Y + 250;\nconst section4X = section3X;\n\nconst title4 = new Text({\n  content: \"4. Right Angle Markers\",\n  fontSize: 18,\n});\ntitle4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title4.topLeft,\n  x: section4X,\n  y: section4Y - 40,\n});\nartboard.addElement(title4);\n\nconst vertexD = { x: section4X + 150, y: section4Y + 100 };\nconst pointE = { x: section4X + 250, y: section4Y + 100 };\nconst pointF = { x: section4X + 150, y: section4Y + 0 };\n\nconst lineDE = new Line({\n  start: vertexD,\n  end: pointE,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineDF = new Line({\n  start: vertexD,\n  end: pointF,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentDE = new Side({ start: vertexD, end: pointE });\nconst segmentDF = new Side({ start: vertexD, end: pointF });\n\nartboard.addElement(lineDE);\nartboard.addElement(lineDF);\n\nconst rightAngleSquare = new Angle({\n  from: \"vertex\",\n  segments: [segmentDE, segmentDF],\n  mode: \"internal\",\n  rightAngleMarker: \"square\",\n  radius: 30,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rightAngleSquare);\n\nconst label1 = new Text({\n  content: \"90° (square)\",\n  fontSize: 12,\n});\nlabel1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: label1.topLeft,\n  x: section4X + 120,\n  y: section4Y + 120,\n});\nartboard.addElement(label1);\n\nconst vertexG = { x: section4X + 150, y: section4Y + 200 };\nconst pointH = { x: section4X + 250, y: section4Y + 200 };\nconst pointI = { x: section4X + 150, y: section4Y + 100 };\n\nconst lineGH = new Line({\n  start: vertexG,\n  end: pointH,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineGI = new Line({\n  start: vertexG,\n  end: pointI,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentGH = new Side({ start: vertexG, end: pointH });\nconst segmentGI = new Side({ start: vertexG, end: pointI });\n\nartboard.addElement(lineGH);\nartboard.addElement(lineGI);\n\nconst rightAngleDot = new Angle({\n  from: \"vertex\",\n  segments: [segmentGH, segmentGI],\n  mode: \"internal\",\n  rightAngleMarker: \"dot\",\n  radius: 30,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rightAngleDot);\n\nconst label2 = new Text({\n  content: \"90° (dot)\",\n  fontSize: 12,\n});\nlabel2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: label2.topLeft,\n  x: section4X + 120,\n  y: section4Y + 220,\n});\nartboard.addElement(label2);\n\n\nconst section5Y = 100;\nconst section5X = 950;\n\nconst title5 = new Text({\n  content: \"5. Explicit Angles\",\n  fontSize: 18,\n});\ntitle5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title5.topLeft,\n  x: section5X,\n  y: section5Y - 40,\n});\nartboard.addElement(title5);\n\nconst explicitAngles = [\n  { start: 0, end: 45, label: \"45°\", y: 0, color: \"#e74c3c\" },\n  { start: 0, end: 90, label: \"90°\", y: 100, color: \"#3498db\" },\n  { start: 0, end: 135, label: \"135°\", y: 200, color: \"#2ecc71\" },\n  { start: 0, end: 270, label: \"270°\", y: 300, color: \"#f39c12\" },\n];\n\nexplicitAngles.forEach((spec, i) => {\n  const centerX = section5X + 120;\n  const centerY = section5Y + spec.y + 50;\n\n  artboard.addElement(\n    new Circle({\n      center: { x: centerX, y: centerY },\n      radius: 3,\n      style: { fill: spec.color, stroke: \"none\" },\n    })\n  );\n\n  const angle = new Angle({\n    vertex: { x: centerX, y: centerY },\n    startAngle: spec.start,\n    endAngle: spec.end,\n    label: spec.label,\n    radius: 40,\n    style: { stroke: spec.color, strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(angle);\n});\n\nconst fullCircleVertex = { x: section5X + 120, y: section5Y + 480 };\n\nartboard.addElement(\n  new Circle({\n    center: fullCircleVertex,\n    radius: 3,\n    style: { fill: \"#9b59b6\", stroke: \"none\" },\n  })\n);\n\nconst fullCircle = new Angle({\n  vertex: fullCircleVertex,\n  startAngle: 0,\n  endAngle: 360,\n  label: \"360°\",\n  radius: 40,\n  labelDistance: 0,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(fullCircle);\n\n\nconst summaryTitle = new Text({\n  content: \"Refactored Angle API:\",\n  fontSize: 14,\n  style: { fontWeight: \"bold\" },\n});\nsummaryTitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryTitle.topLeft,\n  x: 50,\n  y: 750,\n});\nartboard.addElement(summaryTitle);\n\nconst summaryLine1 = new Text({\n  content: \"• Intersection: quadrant selection (upper-right, upper-left, lower-left, lower-right)\",\n  fontSize: 12,\n});\nsummaryLine1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine1.topLeft,\n  x: 70,\n  y: 780,\n});\nartboard.addElement(summaryLine1);\n\nconst summaryLine2 = new Text({\n  content: \"• Vertex: automatic shared vertex detection with internal/external modes\",\n  fontSize: 12,\n});\nsummaryLine2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine2.topLeft,\n  x: 70,\n  y: 800,\n});\nartboard.addElement(summaryLine2);\n\nconst summaryLine3 = new Text({\n  content: \"• Explicit: manual vertex and angle specification for full control\",\n  fontSize: 12,\n});\nsummaryLine3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine3.topLeft,\n  x: 70,\n  y: 820,\n});\nartboard.addElement(summaryLine3);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a visual artboard that demonstrates various geometric angles. Include several sections, each with a title and different types of angles like intersection angles, vertex angles, and explicit angles. Use different colors to distinguish between the angles and include labels for clarity. Some sections should highlight internal versus external angles, and others should show right angles with distinct markers. Conclude with a brief summary to describe the types of angles shown in the visualization."},{"role":"assistant","content":"import {\n  Artboard,\n  Line,\n  Side,\n  Angle,\n  Text,\n  Circle,\n} from \"w2l\";\n\n\nconst artboard = new Artboard({ width: 1400, height: 1000 });\n\n\nconst section1Y = 100;\n\nconst title1 = new Text({\n  content: \"1. Angles at Intersection (Quadrant Selection)\",\n  fontSize: 18,\n});\ntitle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title1.topLeft,\n  x: 50,\n  y: section1Y - 40,\n});\nartboard.addElement(title1);\n\nconst line1 = new Line({\n  start: { x: 120, y: section1Y + 100 },\n  end: { x: 380, y: section1Y + 100 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst line2 = new Line({\n  start: { x: 160, y: section1Y + 30 },\n  end: { x: 340, y: section1Y + 170 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(line1);\nartboard.addElement(line2);\n\nconst angleUR = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"upper-right\",\n  mode: \"internal\",\n  label: (deg) => `UR: ${deg}°`,\n  radius: 40,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n});\n\nconst angleUL = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"upper-left\",\n  mode: \"internal\",\n  label: (deg) => `UL: ${deg}°`,\n  radius: 50,\n  style: { stroke: \"#3498db\", strokeWidth: \"2\" },\n});\n\nconst angleLL = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"lower-left\",\n  mode: \"internal\",\n  label: (deg) => `LL: ${deg}°`,\n  radius: 50,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n});\n\nconst angleLR = new Angle({\n  from: \"intersection\",\n  lines: [line1, line2],\n  quadrant: \"lower-right\",\n  mode: \"internal\",\n  label: (deg) => `LR: ${deg}°`,\n  radius: 40,\n  style: { stroke: \"#f39c12\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(angleUR);\nartboard.addElement(angleUL);\nartboard.addElement(angleLL);\nartboard.addElement(angleLR);\n\n\nconst section2Y = section1Y + 250;\n\nconst title2 = new Text({\n  content: \"2. Internal vs External at Intersection\",\n  fontSize: 18,\n});\ntitle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title2.topLeft,\n  x: 50,\n  y: section2Y - 40,\n});\nartboard.addElement(title2);\n\nconst line3 = new Line({\n  start: { x: 100, y: section2Y + 100 },\n  end: { x: 400, y: section2Y + 100 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst line4 = new Line({\n  start: { x: 320, y: section2Y + 20 },\n  end: { x: 180, y: section2Y + 180 },\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(line3);\nartboard.addElement(line4);\n\nconst angleInternal = new Angle({\n  from: \"intersection\",\n  lines: [line3, line4],\n  quadrant: \"upper-right\",\n  mode: \"internal\",\n  showDegrees: true, // Will automatically show degrees\n  radius: 45,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nconst angleExternal = new Angle({\n  from: \"intersection\",\n  lines: [line3, line4],\n  quadrant: \"upper-right\",\n  mode: \"external\",\n  showDegrees: true,\n  radius: 60,\n  style: { stroke: \"#e67e22\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(angleInternal);\nartboard.addElement(angleExternal);\n\n\nconst section3Y = 100;\nconst section3X = 500;\n\nconst title3 = new Text({\n  content: \"3. Angles at Vertex (Segments)\",\n  fontSize: 18,\n});\ntitle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title3.topLeft,\n  x: section3X,\n  y: section3Y - 40,\n});\nartboard.addElement(title3);\n\nconst vertexA = { x: section3X + 150, y: section3Y + 100 };\nconst pointB = { x: section3X + 250, y: section3Y + 50 };\nconst pointC = { x: section3X + 280, y: section3Y + 150 };\n\nconst lineAB = new Line({\n  start: vertexA,\n  end: pointB,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineAC = new Line({\n  start: vertexA,\n  end: pointC,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentAB = new Side({ start: vertexA, end: pointB });\nconst segmentAC = new Side({ start: vertexA, end: pointC });\n\nartboard.addElement(lineAB);\nartboard.addElement(lineAC);\n\nartboard.addElement(\n  new Circle({\n    center: vertexA,\n    radius: 4,\n    style: { fill: \"#e74c3c\", stroke: \"none\" },\n  })\n);\n\nconst angleVertexInternal = new Angle({\n  from: \"vertex\",\n  segments: [segmentAB, segmentAC],\n  mode: \"internal\",\n  label: \"α\",\n  radius: 40,\n  style: { stroke: \"#e74c3c\", strokeWidth: \"2\" },\n});\n\nconst angleVertexExternal = new Angle({\n  from: \"vertex\",\n  segments: [segmentAB, segmentAC],\n  mode: \"external\",\n  label: \"β\",\n  radius: 55,\n  style: { stroke: \"#3498db\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(angleVertexInternal);\nartboard.addElement(angleVertexExternal);\n\n\nconst section4Y = section3Y + 250;\nconst section4X = section3X;\n\nconst title4 = new Text({\n  content: \"4. Right Angle Markers\",\n  fontSize: 18,\n});\ntitle4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title4.topLeft,\n  x: section4X,\n  y: section4Y - 40,\n});\nartboard.addElement(title4);\n\nconst vertexD = { x: section4X + 150, y: section4Y + 100 };\nconst pointE = { x: section4X + 250, y: section4Y + 100 };\nconst pointF = { x: section4X + 150, y: section4Y + 0 };\n\nconst lineDE = new Line({\n  start: vertexD,\n  end: pointE,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineDF = new Line({\n  start: vertexD,\n  end: pointF,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentDE = new Side({ start: vertexD, end: pointE });\nconst segmentDF = new Side({ start: vertexD, end: pointF });\n\nartboard.addElement(lineDE);\nartboard.addElement(lineDF);\n\nconst rightAngleSquare = new Angle({\n  from: \"vertex\",\n  segments: [segmentDE, segmentDF],\n  mode: \"internal\",\n  rightAngleMarker: \"square\",\n  radius: 30,\n  style: { stroke: \"#2ecc71\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rightAngleSquare);\n\nconst label1 = new Text({\n  content: \"90° (square)\",\n  fontSize: 12,\n});\nlabel1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: label1.topLeft,\n  x: section4X + 120,\n  y: section4Y + 120,\n});\nartboard.addElement(label1);\n\nconst vertexG = { x: section4X + 150, y: section4Y + 200 };\nconst pointH = { x: section4X + 250, y: section4Y + 200 };\nconst pointI = { x: section4X + 150, y: section4Y + 100 };\n\nconst lineGH = new Line({\n  start: vertexG,\n  end: pointH,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst lineGI = new Line({\n  start: vertexG,\n  end: pointI,\n  style: { stroke: \"#333\", strokeWidth: \"2\" },\n});\n\nconst segmentGH = new Side({ start: vertexG, end: pointH });\nconst segmentGI = new Side({ start: vertexG, end: pointI });\n\nartboard.addElement(lineGH);\nartboard.addElement(lineGI);\n\nconst rightAngleDot = new Angle({\n  from: \"vertex\",\n  segments: [segmentGH, segmentGI],\n  mode: \"internal\",\n  rightAngleMarker: \"dot\",\n  radius: 30,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rightAngleDot);\n\nconst label2 = new Text({\n  content: \"90° (dot)\",\n  fontSize: 12,\n});\nlabel2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: label2.topLeft,\n  x: section4X + 120,\n  y: section4Y + 220,\n});\nartboard.addElement(label2);\n\n\nconst section5Y = 100;\nconst section5X = 950;\n\nconst title5 = new Text({\n  content: \"5. Explicit Angles\",\n  fontSize: 18,\n});\ntitle5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title5.topLeft,\n  x: section5X,\n  y: section5Y - 40,\n});\nartboard.addElement(title5);\n\nconst explicitAngles = [\n  { start: 0, end: 45, label: \"45°\", y: 0, color: \"#e74c3c\" },\n  { start: 0, end: 90, label: \"90°\", y: 100, color: \"#3498db\" },\n  { start: 0, end: 135, label: \"135°\", y: 200, color: \"#2ecc71\" },\n  { start: 0, end: 270, label: \"270°\", y: 300, color: \"#f39c12\" },\n];\n\nexplicitAngles.forEach((spec, i) => {\n  const centerX = section5X + 120;\n  const centerY = section5Y + spec.y + 50;\n\n  artboard.addElement(\n    new Circle({\n      center: { x: centerX, y: centerY },\n      radius: 3,\n      style: { fill: spec.color, stroke: \"none\" },\n    })\n  );\n\n  const angle = new Angle({\n    vertex: { x: centerX, y: centerY },\n    startAngle: spec.start,\n    endAngle: spec.end,\n    label: spec.label,\n    radius: 40,\n    style: { stroke: spec.color, strokeWidth: \"2\" },\n  });\n\n  artboard.addElement(angle);\n});\n\nconst fullCircleVertex = { x: section5X + 120, y: section5Y + 480 };\n\nartboard.addElement(\n  new Circle({\n    center: fullCircleVertex,\n    radius: 3,\n    style: { fill: \"#9b59b6\", stroke: \"none\" },\n  })\n);\n\nconst fullCircle = new Angle({\n  vertex: fullCircleVertex,\n  startAngle: 0,\n  endAngle: 360,\n  label: \"360°\",\n  radius: 40,\n  labelDistance: 0,\n  style: { stroke: \"#9b59b6\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(fullCircle);\n\n\nconst summaryTitle = new Text({\n  content: \"Refactored Angle API:\",\n  fontSize: 14,\n  style: { fontWeight: \"bold\" },\n});\nsummaryTitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryTitle.topLeft,\n  x: 50,\n  y: 750,\n});\nartboard.addElement(summaryTitle);\n\nconst summaryLine1 = new Text({\n  content: \"• Intersection: quadrant selection (upper-right, upper-left, lower-left, lower-right)\",\n  fontSize: 12,\n});\nsummaryLine1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine1.topLeft,\n  x: 70,\n  y: 780,\n});\nartboard.addElement(summaryLine1);\n\nconst summaryLine2 = new Text({\n  content: \"• Vertex: automatic shared vertex detection with internal/external modes\",\n  fontSize: 12,\n});\nsummaryLine2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine2.topLeft,\n  x: 70,\n  y: 800,\n});\nartboard.addElement(summaryLine2);\n\nconst summaryLine3 = new Text({\n  content: \"• Explicit: manual vertex and angle specification for full control\",\n  fontSize: 12,\n});\nsummaryLine3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine3.topLeft,\n  x: 70,\n  y: 820,\n});\nartboard.addElement(summaryLine3);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visualization with different types of triangles and quadrilaterals. Start with a right triangle with internal angles labeled as α, β, and γ, filled with light blue and outlined in dark blue. Position this at 100, 120 on the canvas. Next, add an equilateral triangle, filled with light orange and outlined in dark orange, with a specific angle labeled as 60° at position 450, 120. Then, create an isosceles triangle with external angles labeled as α', β', and γ', filled with light purple and outlined in purple with dashed lines, positioned at 800, 120. Include a rectangle with right angle markers at 100, 420, filled with light green and outlined in dark green. Add a parallelogram with internal angles labeled as 60° and 120° at 450, 420, filled with light pink and outlined in pink. Finally, place a rhombus with external angles labeled as α, β, γ, and δ at 100, 670, filled with light yellow and outlined in gold. Each section should have bold titles, and add a summary on the right with bullet points starting at 750, 600."},{"role":"assistant","content":"import {\n  Artboard,\n  Triangle,\n  Quadrilateral,\n  Text,\n} from \"w2l\";\n\n\nconst artboard = new Artboard({ width: 1400, height: 900 });\n\n\nconst title1 = new Text({\n  content: \"Triangle.showAngles() - All Internal Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title1.topLeft,\n  x: 50,\n  y: 50,\n});\nartboard.addElement(title1);\n\nconst triangle1 = new Triangle({\n  type: \"right\",\n  a: 100,\n  b: 80,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\ntriangle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle1.boundingBoxTopLeft,\n  x: 100,\n  y: 120,\n});\n\nconst angles1 = triangle1.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\"],\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle1);\nangles1.forEach((angle) => artboard.addElement(angle));\n\n\nconst title2 = new Text({\n  content: \"Triangle.showAngle(index) - Specific Angle\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title2.topLeft,\n  x: 400,\n  y: 50,\n});\nartboard.addElement(title2);\n\nconst triangle2 = new Triangle({\n  type: \"equilateral\",\n  a: 100,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntriangle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle2.boundingBoxTopLeft,\n  x: 450,\n  y: 120,\n});\n\nconst specificAngle = triangle2.showAngle(0, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 45,\n  style: { stroke: \"#f57c00\", strokeWidth: \"2.5\" },\n});\n\nartboard.addElement(triangle2);\nartboard.addElement(specificAngle);\n\n\nconst title3 = new Text({\n  content: \"Triangle - External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title3.topLeft,\n  x: 750,\n  y: 50,\n});\nartboard.addElement(title3);\n\nconst triangle3 = new Triangle({\n  type: \"isosceles\",\n  a: 100,\n  b: 100,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\ntriangle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle3.boundingBoxTopLeft,\n  x: 800,\n  y: 120,\n});\n\nconst externalAngles = triangle3.showAngles({\n  mode: \"external\",\n  labels: [\"α'\", \"β'\", \"γ'\"],\n  radius: 50,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(triangle3);\nexternalAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst title4 = new Text({\n  content: \"Rectangle.showAngles() - Right Angle Markers\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title4.topLeft,\n  x: 50,\n  y: 350,\n});\nartboard.addElement(title4);\n\nconst rectangle = new Quadrilateral({\n  type: \"rectangle\",\n  a: 120,\n  b: 80,\n  style: { fill: \"#e8f5e9\", stroke: \"#2e7d32\", strokeWidth: \"2\" },\n});\n\nrectangle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rectangle.boundingBoxTopLeft,\n  x: 100,\n  y: 420,\n});\n\nconst rectAngles = rectangle.showAngles({\n  mode: \"internal\",\n  radius: 25,\n  rightAngleMarker: \"square\",\n  style: { stroke: \"#2e7d32\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rectangle);\nrectAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst title5 = new Text({\n  content: \"Parallelogram - Internal and External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title5.topLeft,\n  x: 400,\n  y: 350,\n});\nartboard.addElement(title5);\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 120,\n  b: 70,\n  angle: 60,\n  style: { fill: \"#fce4ec\", stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  x: 450,\n  y: 420,\n});\n\nconst paraInternal1 = parallelogram.showAngle(0, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 35,\n  style: { stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nconst paraInternal2 = parallelogram.showAngle(2, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 35,\n  style: { stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nconst paraInternal3 = parallelogram.showAngle(1, {\n  mode: \"internal\",\n  label: \"120°\",\n  radius: 35,\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nconst paraInternal4 = parallelogram.showAngle(3, {\n  mode: \"internal\",\n  label: \"120°\",\n  radius: 35,\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(parallelogram);\nartboard.addElement(paraInternal1);\nartboard.addElement(paraInternal2);\nartboard.addElement(paraInternal3);\nartboard.addElement(paraInternal4);\n\n\nconst title6 = new Text({\n  content: \"Rhombus - External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle6.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title6.topLeft,\n  x: 50,\n  y: 600,\n});\nartboard.addElement(title6);\n\nconst rhombus = new Quadrilateral({\n  type: \"rhombus\",\n  a: 100,\n  angle: 70,\n  style: { fill: \"#fff8e1\", stroke: \"#f9a825\", strokeWidth: \"2\" },\n});\n\nrhombus.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rhombus.boundingBoxTopLeft,\n  x: 100,\n  y: 670,\n});\n\nconst rhombusExtAngles = rhombus.showAngles({\n  mode: \"external\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 55,\n  style: { stroke: \"#f9a825\", strokeWidth: \"2\", strokeDasharray: \"4,4\" },\n});\n\nartboard.addElement(rhombus);\nrhombusExtAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst summaryTitle = new Text({\n  content: \"New API Summary:\",\n  fontSize: 14,\n  style: { fontWeight: \"bold\" },\n});\nsummaryTitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryTitle.topLeft,\n  x: 750,\n  y: 600,\n});\nartboard.addElement(summaryTitle);\n\nconst summaryLine1 = new Text({\n  content: \"• triangle.showAngles({ mode: 'internal', labels: [...] })\",\n  fontSize: 12,\n});\nsummaryLine1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine1.topLeft,\n  x: 770,\n  y: 630,\n});\nartboard.addElement(summaryLine1);\n\nconst summaryLine2 = new Text({\n  content: \"• triangle.showAngle(0, { mode: 'external', label: 'α' })\",\n  fontSize: 12,\n});\nsummaryLine2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine2.topLeft,\n  x: 770,\n  y: 650,\n});\nartboard.addElement(summaryLine2);\n\nconst summaryLine3 = new Text({\n  content: \"• quadrilateral.showAngles({ mode: 'internal', ... })\",\n  fontSize: 12,\n});\nsummaryLine3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine3.topLeft,\n  x: 770,\n  y: 670,\n});\nartboard.addElement(summaryLine3);\n\nconst summaryLine4 = new Text({\n  content: \"• Supports: internal/external modes, custom labels, styling\",\n  fontSize: 12,\n});\nsummaryLine4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine4.topLeft,\n  x: 770,\n  y: 690,\n});\nartboard.addElement(summaryLine4);\n\nconst summaryLine5 = new Text({\n  content: \"• Automatic right angle detection (square/dot markers)\",\n  fontSize: 12,\n});\nsummaryLine5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine5.topLeft,\n  x: 770,\n  y: 710,\n});\nartboard.addElement(summaryLine5);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual display showing various geometric shapes including triangles and quadrilaterals. Include different types of triangles and label their angles. Use some bright and some muted colors for filling and outlining the shapes. Position them in different areas of the canvas and ensure each type of shape has a clear label above it. Include a summary section on one side with points describing features of these shapes."},{"role":"assistant","content":"import {\n  Artboard,\n  Triangle,\n  Quadrilateral,\n  Text,\n} from \"w2l\";\n\n\nconst artboard = new Artboard({ width: 1400, height: 900 });\n\n\nconst title1 = new Text({\n  content: \"Triangle.showAngles() - All Internal Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title1.topLeft,\n  x: 50,\n  y: 50,\n});\nartboard.addElement(title1);\n\nconst triangle1 = new Triangle({\n  type: \"right\",\n  a: 100,\n  b: 80,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\ntriangle1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle1.boundingBoxTopLeft,\n  x: 100,\n  y: 120,\n});\n\nconst angles1 = triangle1.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\"],\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(triangle1);\nangles1.forEach((angle) => artboard.addElement(angle));\n\n\nconst title2 = new Text({\n  content: \"Triangle.showAngle(index) - Specific Angle\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title2.topLeft,\n  x: 400,\n  y: 50,\n});\nartboard.addElement(title2);\n\nconst triangle2 = new Triangle({\n  type: \"equilateral\",\n  a: 100,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\n\ntriangle2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle2.boundingBoxTopLeft,\n  x: 450,\n  y: 120,\n});\n\nconst specificAngle = triangle2.showAngle(0, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 45,\n  style: { stroke: \"#f57c00\", strokeWidth: \"2.5\" },\n});\n\nartboard.addElement(triangle2);\nartboard.addElement(specificAngle);\n\n\nconst title3 = new Text({\n  content: \"Triangle - External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title3.topLeft,\n  x: 750,\n  y: 50,\n});\nartboard.addElement(title3);\n\nconst triangle3 = new Triangle({\n  type: \"isosceles\",\n  a: 100,\n  b: 100,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\n\ntriangle3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle3.boundingBoxTopLeft,\n  x: 800,\n  y: 120,\n});\n\nconst externalAngles = triangle3.showAngles({\n  mode: \"external\",\n  labels: [\"α'\", \"β'\", \"γ'\"],\n  radius: 50,\n  style: { stroke: \"#7b1fa2\", strokeWidth: \"2\", strokeDasharray: \"5,5\" },\n});\n\nartboard.addElement(triangle3);\nexternalAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst title4 = new Text({\n  content: \"Rectangle.showAngles() - Right Angle Markers\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title4.topLeft,\n  x: 50,\n  y: 350,\n});\nartboard.addElement(title4);\n\nconst rectangle = new Quadrilateral({\n  type: \"rectangle\",\n  a: 120,\n  b: 80,\n  style: { fill: \"#e8f5e9\", stroke: \"#2e7d32\", strokeWidth: \"2\" },\n});\n\nrectangle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rectangle.boundingBoxTopLeft,\n  x: 100,\n  y: 420,\n});\n\nconst rectAngles = rectangle.showAngles({\n  mode: \"internal\",\n  radius: 25,\n  rightAngleMarker: \"square\",\n  style: { stroke: \"#2e7d32\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(rectangle);\nrectAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst title5 = new Text({\n  content: \"Parallelogram - Internal and External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title5.topLeft,\n  x: 400,\n  y: 350,\n});\nartboard.addElement(title5);\n\nconst parallelogram = new Quadrilateral({\n  type: \"parallelogram\",\n  a: 120,\n  b: 70,\n  angle: 60,\n  style: { fill: \"#fce4ec\", stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nparallelogram.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: parallelogram.boundingBoxTopLeft,\n  x: 450,\n  y: 420,\n});\n\nconst paraInternal1 = parallelogram.showAngle(0, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 35,\n  style: { stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nconst paraInternal2 = parallelogram.showAngle(2, {\n  mode: \"internal\",\n  label: \"60°\",\n  radius: 35,\n  style: { stroke: \"#c2185b\", strokeWidth: \"2\" },\n});\n\nconst paraInternal3 = parallelogram.showAngle(1, {\n  mode: \"internal\",\n  label: \"120°\",\n  radius: 35,\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nconst paraInternal4 = parallelogram.showAngle(3, {\n  mode: \"internal\",\n  label: \"120°\",\n  radius: 35,\n  style: { stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nartboard.addElement(parallelogram);\nartboard.addElement(paraInternal1);\nartboard.addElement(paraInternal2);\nartboard.addElement(paraInternal3);\nartboard.addElement(paraInternal4);\n\n\nconst title6 = new Text({\n  content: \"Rhombus - External Angles\",\n  fontSize: 18,\n  style: { fontWeight: \"bold\" },\n});\ntitle6.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title6.topLeft,\n  x: 50,\n  y: 600,\n});\nartboard.addElement(title6);\n\nconst rhombus = new Quadrilateral({\n  type: \"rhombus\",\n  a: 100,\n  angle: 70,\n  style: { fill: \"#fff8e1\", stroke: \"#f9a825\", strokeWidth: \"2\" },\n});\n\nrhombus.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rhombus.boundingBoxTopLeft,\n  x: 100,\n  y: 670,\n});\n\nconst rhombusExtAngles = rhombus.showAngles({\n  mode: \"external\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 55,\n  style: { stroke: \"#f9a825\", strokeWidth: \"2\", strokeDasharray: \"4,4\" },\n});\n\nartboard.addElement(rhombus);\nrhombusExtAngles.forEach((angle) => artboard.addElement(angle));\n\n\nconst summaryTitle = new Text({\n  content: \"New API Summary:\",\n  fontSize: 14,\n  style: { fontWeight: \"bold\" },\n});\nsummaryTitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryTitle.topLeft,\n  x: 750,\n  y: 600,\n});\nartboard.addElement(summaryTitle);\n\nconst summaryLine1 = new Text({\n  content: \"• triangle.showAngles({ mode: 'internal', labels: [...] })\",\n  fontSize: 12,\n});\nsummaryLine1.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine1.topLeft,\n  x: 770,\n  y: 630,\n});\nartboard.addElement(summaryLine1);\n\nconst summaryLine2 = new Text({\n  content: \"• triangle.showAngle(0, { mode: 'external', label: 'α' })\",\n  fontSize: 12,\n});\nsummaryLine2.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine2.topLeft,\n  x: 770,\n  y: 650,\n});\nartboard.addElement(summaryLine2);\n\nconst summaryLine3 = new Text({\n  content: \"• quadrilateral.showAngles({ mode: 'internal', ... })\",\n  fontSize: 12,\n});\nsummaryLine3.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine3.topLeft,\n  x: 770,\n  y: 670,\n});\nartboard.addElement(summaryLine3);\n\nconst summaryLine4 = new Text({\n  content: \"• Supports: internal/external modes, custom labels, styling\",\n  fontSize: 12,\n});\nsummaryLine4.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine4.topLeft,\n  x: 770,\n  y: 690,\n});\nartboard.addElement(summaryLine4);\n\nconst summaryLine5 = new Text({\n  content: \"• Automatic right angle detection (square/dot markers)\",\n  fontSize: 12,\n});\nsummaryLine5.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: summaryLine5.topLeft,\n  x: 770,\n  y: 710,\n});\nartboard.addElement(summaryLine5);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with the title 'Auto-Sized Artboard' in bold, size 24 font, positioned at (50, 50). Add a subtitle 'Width and height automatically fit the content' in size 14 font at (50, 85). Draw a circle with center at (150, 180), radius 40, filled with color #e3f2fd and stroke #1976d2. Include a rectangular shape of 80 by 80 units at position (250, 140), filled with color #f3e5f5 and stroked with #7b1fa2. Add an equilateral triangle with side length 80 at position (400, 140), filled with #fff3e0 and stroked with #f57c00. Finally, add a note in size 12 font at (50, 260) saying 'The artboard automatically calculates its size based on all child elements.', in color #666."},{"role":"assistant","content":"import {\n  Artboard,\n  Circle,\n  Rect,\n  Text,\n  Triangle,\n} from \"w2l\";\n\n\nconst artboard = new Artboard();\n\nconst title = new Text({\n  content: \"Auto-Sized Artboard\",\n  fontSize: 24,\n  style: { fontWeight: \"bold\" },\n});\ntitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title.topLeft,\n  x: 50,\n  y: 50,\n});\n\nconst subtitle = new Text({\n  content: \"Width and height automatically fit the content\",\n  fontSize: 14,\n});\nsubtitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: subtitle.topLeft,\n  x: 50,\n  y: 85,\n});\n\nconst circle = new Circle({\n  center: { x: 150, y: 180 },\n  radius: 40,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nconst rect = new Rect({\n  width: 80,\n  height: 80,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\nrect.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rect.topLeft,\n  x: 250,\n  y: 140,\n});\n\nconst triangle = new Triangle({\n  type: \"equilateral\",\n  a: 80,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\ntriangle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle.boundingBoxTopLeft,\n  x: 400,\n  y: 140,\n});\n\nconst note = new Text({\n  content: \"The artboard automatically calculates its size based on all child elements.\",\n  fontSize: 12,\n  style: { fill: \"#666\" },\n});\nnote.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: note.topLeft,\n  x: 50,\n  y: 260,\n});\n\nartboard.addElement(title);\nartboard.addElement(subtitle);\nartboard.addElement(circle);\nartboard.addElement(rect);\nartboard.addElement(triangle);\nartboard.addElement(note);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual composition with several text elements including a bold title and a subtitle. Add a mix of geometric shapes like circles, rectangles, and triangles, each with distinct colors and outlines. Ensure the elements are spaced out across the canvas, and include a note at the bottom mentioning the automatic sizing of the canvas based on the elements included."},{"role":"assistant","content":"import {\n  Artboard,\n  Circle,\n  Rect,\n  Text,\n  Triangle,\n} from \"w2l\";\n\n\nconst artboard = new Artboard();\n\nconst title = new Text({\n  content: \"Auto-Sized Artboard\",\n  fontSize: 24,\n  style: { fontWeight: \"bold\" },\n});\ntitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: title.topLeft,\n  x: 50,\n  y: 50,\n});\n\nconst subtitle = new Text({\n  content: \"Width and height automatically fit the content\",\n  fontSize: 14,\n});\nsubtitle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: subtitle.topLeft,\n  x: 50,\n  y: 85,\n});\n\nconst circle = new Circle({\n  center: { x: 150, y: 180 },\n  radius: 40,\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: \"2\" },\n});\n\nconst rect = new Rect({\n  width: 80,\n  height: 80,\n  style: { fill: \"#f3e5f5\", stroke: \"#7b1fa2\", strokeWidth: \"2\" },\n});\nrect.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: rect.topLeft,\n  x: 250,\n  y: 140,\n});\n\nconst triangle = new Triangle({\n  type: \"equilateral\",\n  a: 80,\n  style: { fill: \"#fff3e0\", stroke: \"#f57c00\", strokeWidth: \"2\" },\n});\ntriangle.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: triangle.boundingBoxTopLeft,\n  x: 400,\n  y: 140,\n});\n\nconst note = new Text({\n  content: \"The artboard automatically calculates its size based on all child elements.\",\n  fontSize: 12,\n  style: { fill: \"#666\" },\n});\nnote.position({\n  relativeTo: artboard.contentBox.topLeft,\n  relativeFrom: note.topLeft,\n  x: 50,\n  y: 260,\n});\n\nartboard.addElement(title);\nartboard.addElement(subtitle);\nartboard.addElement(circle);\nartboard.addElement(rect);\nartboard.addElement(triangle);\nartboard.addElement(note);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a layout on a white background with a main container having vertical sections. Each section should have three containers aligned horizontally, each containing a label and a text area. The text areas should have different widths and styles: one with a width of 250px and a blue border, another with a width of 180px and a yellow background, and another with a width of 350px using the Georgia font. Include a second row with a single-line text, a box without padding or background, and a smaller font size text area. Finally, add a third row featuring a large bold text, a debug mode with visible box outlines, and a monospace font text area, each with distinct colors and styles."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst sampleText = \"This is a longer piece of text that will wrap to multiple lines when it exceeds the specified width of the TextArea component.\";\nconst shortText = \"Short text that fits on one line.\";\nconst loremIpsum = \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.\";\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst row1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row1);\n\nconst example1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Basic with Padding\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: sampleText,\n  width: 250,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n  },\n});\n\nexample1.addElement(label1);\nexample1.addElement(textArea1);\nrow1.addElement(example1);\n\nconst example2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Narrow (180px)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: loremIpsum,\n  width: 180,\n  fontSize: 14,\n  lineHeight: 1.4,\n  textColor: \"#856404\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n});\n\nexample2.addElement(label2);\nexample2.addElement(textArea2);\nrow1.addElement(example2);\n\nconst example3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Wide (350px) - Georgia\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: loremIpsum,\n  width: 350,\n  fontSize: 16,\n  lineHeight: 1.5,\n  fontFamily: \"Georgia\",\n  textColor: \"#1b5e20\",\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nexample3.addElement(label3);\nexample3.addElement(textArea3);\nrow1.addElement(example3);\n\n\nconst row2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row2);\n\nconst example4 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Short Text (Single Line)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: shortText,\n  width: 300,\n  fontSize: 18,\n  textColor: \"#4a148c\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4.addElement(label4);\nexample4.addElement(textArea4);\nrow2.addElement(example4);\n\nconst example5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"No Background/Padding\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"This TextArea has no padding and no background. It only renders the text content with wrapping.\",\n  width: 300,\n  fontSize: 16,\n  textColor: \"#34495e\",\n});\n\nexample5.addElement(label5);\nexample5.addElement(textArea5);\nrow2.addElement(example5);\n\nconst example6 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Small Font (12px)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: sampleText,\n  width: 200,\n  fontSize: 12,\n  lineHeight: 1.3,\n  textColor: \"#880e4f\",\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#e91e63\",\n    strokeWidth: 1,\n  },\n});\n\nexample6.addElement(label6);\nexample6.addElement(textArea6);\nrow2.addElement(example6);\n\n\nconst row3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row3);\n\nconst example7 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Large Font (20px, Bold)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"Large text that wraps with bigger font size!\",\n  width: 250,\n  fontSize: 20,\n  fontWeight: \"bold\",\n  lineHeight: 1.4,\n  textColor: \"#0d47a1\",\n  boxModel: { padding: 18 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 3,\n  },\n});\n\nexample7.addElement(label7);\nexample7.addElement(textArea7);\nrow3.addElement(example7);\n\nconst example8 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label8 = new Text({\n  content: \"Debug Mode (shows boxes)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea8 = new TextArea({\n  content: \"Debug mode shows the border box (blue) and content box (red) for development.\",\n  width: 220,\n  fontSize: 15,\n  textColor: \"#d84315\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n  debug: true,\n});\n\nexample8.addElement(label8);\nexample8.addElement(textArea8);\nrow3.addElement(example8);\n\nconst example9 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label9 = new Text({\n  content: \"Monospace Font\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea9 = new TextArea({\n  content: \"function wrap(text) { return text.split(' ').join('\\\\n'); }\",\n  width: 280,\n  fontSize: 14,\n  fontFamily: \"monospace\",\n  textColor: \"#1a1a1a\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#424242\",\n    strokeWidth: 1,\n  },\n});\n\nexample9.addElement(label9);\nexample9.addElement(textArea9);\nrow3.addElement(example9);\n\nconsole.log(\"=== TextArea Debug Info ===\");\nconsole.log(\"TextArea 1 lines:\", textArea1.lines);\nconsole.log(\"TextArea 1 height:\", textArea1.height);\nconsole.log(\"TextArea 2 lines:\", textArea2.lines);\nconsole.log(\"TextArea 2 height:\", textArea2.height);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design a series of text areas displayed in different styles and layouts on a light background. Arrange several groups of text boxes horizontally and vertically, mixing different font sizes, colors, and padding. Include some text areas that have visible outlines or special formatting like monospace fonts or larger text sizes. Use a mix of narrow and wide text areas to demonstrate various text wrapping behaviors."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst sampleText = \"This is a longer piece of text that will wrap to multiple lines when it exceeds the specified width of the TextArea component.\";\nconst shortText = \"Short text that fits on one line.\";\nconst loremIpsum = \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.\";\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst row1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row1);\n\nconst example1 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Basic with Padding\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: sampleText,\n  width: 250,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ecf0f1\",\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n  },\n});\n\nexample1.addElement(label1);\nexample1.addElement(textArea1);\nrow1.addElement(example1);\n\nconst example2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Narrow (180px)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: loremIpsum,\n  width: 180,\n  fontSize: 14,\n  lineHeight: 1.4,\n  textColor: \"#856404\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n});\n\nexample2.addElement(label2);\nexample2.addElement(textArea2);\nrow1.addElement(example2);\n\nconst example3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Wide (350px) - Georgia\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: loremIpsum,\n  width: 350,\n  fontSize: 16,\n  lineHeight: 1.5,\n  fontFamily: \"Georgia\",\n  textColor: \"#1b5e20\",\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nexample3.addElement(label3);\nexample3.addElement(textArea3);\nrow1.addElement(example3);\n\n\nconst row2 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row2);\n\nconst example4 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Short Text (Single Line)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: shortText,\n  width: 300,\n  fontSize: 18,\n  textColor: \"#4a148c\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4.addElement(label4);\nexample4.addElement(textArea4);\nrow2.addElement(example4);\n\nconst example5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"No Background/Padding\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"This TextArea has no padding and no background. It only renders the text content with wrapping.\",\n  width: 300,\n  fontSize: 16,\n  textColor: \"#34495e\",\n});\n\nexample5.addElement(label5);\nexample5.addElement(textArea5);\nrow2.addElement(example5);\n\nconst example6 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Small Font (12px)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: sampleText,\n  width: 200,\n  fontSize: 12,\n  lineHeight: 1.3,\n  textColor: \"#880e4f\",\n  boxModel: { padding: 10 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#e91e63\",\n    strokeWidth: 1,\n  },\n});\n\nexample6.addElement(label6);\nexample6.addElement(textArea6);\nrow2.addElement(example6);\n\n\nconst row3 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nmainContainer.addElement(row3);\n\nconst example7 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Large Font (20px, Bold)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"Large text that wraps with bigger font size!\",\n  width: 250,\n  fontSize: 20,\n  fontWeight: \"bold\",\n  lineHeight: 1.4,\n  textColor: \"#0d47a1\",\n  boxModel: { padding: 18 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 3,\n  },\n});\n\nexample7.addElement(label7);\nexample7.addElement(textArea7);\nrow3.addElement(example7);\n\nconst example8 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label8 = new Text({\n  content: \"Debug Mode (shows boxes)\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea8 = new TextArea({\n  content: \"Debug mode shows the border box (blue) and content box (red) for development.\",\n  width: 220,\n  fontSize: 15,\n  textColor: \"#d84315\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n  debug: true,\n});\n\nexample8.addElement(label8);\nexample8.addElement(textArea8);\nrow3.addElement(example8);\n\nconst example9 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label9 = new Text({\n  content: \"Monospace Font\",\n  fontSize: 14,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea9 = new TextArea({\n  content: \"function wrap(text) { return text.split(' ').join('\\\\n'); }\",\n  width: 280,\n  fontSize: 14,\n  fontFamily: \"monospace\",\n  textColor: \"#1a1a1a\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#f5f5f5\",\n    stroke: \"#424242\",\n    strokeWidth: 1,\n  },\n});\n\nexample9.addElement(label9);\nexample9.addElement(textArea9);\nrow3.addElement(example9);\n\nconsole.log(\"=== TextArea Debug Info ===\");\nconsole.log(\"TextArea 1 lines:\", textArea1.lines);\nconsole.log(\"TextArea 1 height:\", textArea1.height);\nconsole.log(\"TextArea 2 lines:\", textArea2.lines);\nconsole.log(\"TextArea 2 height:\", textArea2.height);\n\nreturn artboard.render();\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a white background and several containers with vertical layouts and specific spacings. Each container should feature examples of text highlighting and LaTeX integration. Include highlights in specific colors for words like 'quick', 'lazy', 'classic', and 'quadratic', among others. Use different background colors and box styles for each example. Additionally, make sure one example uses a narrow width for more text wrapping, and another shows debug mode with visible border boxes."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nfunction addHighlight(element, color, opacity = 0.4) {\n  if (!element) return;\n  \n  const highlight = new Rect({\n    width: element.bbox.width,\n    height: element.bbox.height,\n    style: {\n      fill: color,\n      opacity: opacity,\n    },\n  });\n  \n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: element.topLeft,\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(highlight);\n}\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Example 1: Word Highlighting\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: \"The {highlight:quick}quick{/highlight} brown fox jumps over the {highlight:lazy}lazy{/highlight} dog. This is a {highlight:classic}classic{/highlight} sentence.\",\n  width: 400,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.addElement(label1);\nexample1Container.addElement(textArea1);\nmainContainer.addElement(example1Container);\n\naddHighlight(textArea1.getHighlightedWord('quick'), \"#fff3cd\", 0.6);\naddHighlight(textArea1.getHighlightedWord('lazy'), \"#d1ecf1\", 0.6);\naddHighlight(textArea1.getHighlightedWord('classic'), \"#f8d7da\", 0.6);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Example 2: Inline LaTeX\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: \"Einstein's famous equation $E = mc^2$ relates energy and mass. The Pythagorean theorem $a^2 + b^2 = c^2$ is fundamental in geometry.\",\n  width: 400,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.addElement(label2);\nexample2Container.addElement(textArea2);\nmainContainer.addElement(example2Container);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Example 3: LaTeX + Highlighting\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: \"The {highlight:quadratic}quadratic formula{/highlight} is given by $x = \\\\frac{-b \\\\pm \\\\sqrt{b^2-4ac}}{2a}$. It's a {highlight:powerful}powerful{/highlight} tool for solving equations.\",\n  width: 450,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.addElement(label3);\nexample3Container.addElement(textArea3);\nmainContainer.addElement(example3Container);\n\naddHighlight(textArea3.getHighlightedWord('quadratic'), \"#d1ecf1\", 0.6);\naddHighlight(textArea3.getHighlightedWord('powerful'), \"#f8d7da\", 0.6);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Example 4: Complex Content\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: \"In mathematics, {highlight:calculus}calculus{/highlight} is the study of continuous change. The derivative $\\\\frac{dy}{dx}$ represents the rate of change, while the integral $\\\\int f(x) dx$ represents accumulation. These {highlight:concepts}concepts{/highlight} are {highlight:fundamental}fundamental{/highlight} to modern science and engineering.\",\n  width: 500,\n  fontSize: 15,\n  lineHeight: 1.5,\n  textColor: \"#1a1a1a\",\n  boxModel: { padding: 18 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.addElement(label4);\nexample4Container.addElement(textArea4);\nmainContainer.addElement(example4Container);\n\naddHighlight(textArea4.getHighlightedWord('calculus'), \"#ffcdd2\", 0.6);\naddHighlight(textArea4.getHighlightedWord('concepts'), \"#c5e1a5\", 0.6);\naddHighlight(textArea4.getHighlightedWord('fundamental'), \"#b3e5fc\", 0.6);\n\n\nconst row5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"Example 5: Narrow (wraps more)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"The {highlight:area}area{/highlight} of a circle is $A = \\\\pi r^2$ where $r$ is the {highlight:radius}radius{/highlight}. This simple formula has many applications.\",\n  width: 220,\n  fontSize: 14,\n  lineHeight: 1.4,\n  textColor: \"#0d47a1\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.addElement(label5);\nexample5Container.addElement(textArea5);\nrow5.addElement(example5Container);\n\naddHighlight(textArea5.getHighlightedWord('area'), \"#ffe082\", 0.6);\naddHighlight(textArea5.getHighlightedWord('radius'), \"#ce93d8\", 0.6);\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Example 6: No Background\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: \"The {highlight:limit}limit{/highlight} of $f(x)$ as $x$ approaches infinity is an {highlight:important}important{/highlight} concept.\",\n  width: 300,\n  fontSize: 14,\n  textColor: \"#2c3e50\",\n});\n\nexample6Container.addElement(label6);\nexample6Container.addElement(textArea6);\nrow5.addElement(example6Container);\n\naddHighlight(textArea6.getHighlightedWord('limit'), \"#ffecb3\", 0.7);\naddHighlight(textArea6.getHighlightedWord('important'), \"#f8bbd0\", 0.7);\n\nmainContainer.addElement(row5);\n\n\nconst example7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Example 7: Debug Mode (shows boxes)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"Debug mode shows the {highlight:border}border box{/highlight} and {highlight:content}content box{/highlight} with $x = 5$.\",\n  width: 350,\n  fontSize: 15,\n  textColor: \"#c62828\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n  debug: true,\n});\n\nexample7Container.addElement(label7);\nexample7Container.addElement(textArea7);\nmainContainer.addElement(example7Container);\n\naddHighlight(textArea7.getHighlightedWord('border'), \"#c5cae9\", 0.5);\naddHighlight(textArea7.getHighlightedWord('content'), \"#fff9c4\", 0.5);\n\nconsole.log(\"=== TextArea Highlighting Debug Info ===\");\nconsole.log(\"Example 1 highlighted words:\", textArea1.getHighlightedWordIds());\nconsole.log(\"Example 3 'quadratic' position:\", textArea3.getHighlightedWord('quadratic'));\nconsole.log(\"Example 4 highlighted words:\", textArea4.getHighlightedWordIds());\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Design an artboard containing multiple text sections. Each section should showcase different text features such as highlights and mathematical notation. Use a variety of colors and styles for these sections, ensuring some text wraps more due to narrower width. Include at least one example that demonstrates enhanced visibility settings, showing additional details about the text layout."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 40,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\nfunction addHighlight(element, color, opacity = 0.4) {\n  if (!element) return;\n  \n  const highlight = new Rect({\n    width: element.bbox.width,\n    height: element.bbox.height,\n    style: {\n      fill: color,\n      opacity: opacity,\n    },\n  });\n  \n  highlight.position({\n    relativeFrom: highlight.topLeft,\n    relativeTo: element.topLeft,\n    x: 0,\n    y: 0,\n  });\n  \n  artboard.addElement(highlight);\n}\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Example 1: Word Highlighting\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: \"The {highlight:quick}quick{/highlight} brown fox jumps over the {highlight:lazy}lazy{/highlight} dog. This is a {highlight:classic}classic{/highlight} sentence.\",\n  width: 400,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffffff\",\n    stroke: \"#3498db\",\n    strokeWidth: 2,\n  },\n});\n\nexample1Container.addElement(label1);\nexample1Container.addElement(textArea1);\nmainContainer.addElement(example1Container);\n\naddHighlight(textArea1.getHighlightedWord('quick'), \"#fff3cd\", 0.6);\naddHighlight(textArea1.getHighlightedWord('lazy'), \"#d1ecf1\", 0.6);\naddHighlight(textArea1.getHighlightedWord('classic'), \"#f8d7da\", 0.6);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Example 2: Inline LaTeX\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: \"Einstein's famous equation $E = mc^2$ relates energy and mass. The Pythagorean theorem $a^2 + b^2 = c^2$ is fundamental in geometry.\",\n  width: 400,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n});\n\nexample2Container.addElement(label2);\nexample2Container.addElement(textArea2);\nmainContainer.addElement(example2Container);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Example 3: LaTeX + Highlighting\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: \"The {highlight:quadratic}quadratic formula{/highlight} is given by $x = \\\\frac{-b \\\\pm \\\\sqrt{b^2-4ac}}{2a}$. It's a {highlight:powerful}powerful{/highlight} tool for solving equations.\",\n  width: 450,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.addElement(label3);\nexample3Container.addElement(textArea3);\nmainContainer.addElement(example3Container);\n\naddHighlight(textArea3.getHighlightedWord('quadratic'), \"#d1ecf1\", 0.6);\naddHighlight(textArea3.getHighlightedWord('powerful'), \"#f8d7da\", 0.6);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Example 4: Complex Content\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: \"In mathematics, {highlight:calculus}calculus{/highlight} is the study of continuous change. The derivative $\\\\frac{dy}{dx}$ represents the rate of change, while the integral $\\\\int f(x) dx$ represents accumulation. These {highlight:concepts}concepts{/highlight} are {highlight:fundamental}fundamental{/highlight} to modern science and engineering.\",\n  width: 500,\n  fontSize: 15,\n  lineHeight: 1.5,\n  textColor: \"#1a1a1a\",\n  boxModel: { padding: 18 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample4Container.addElement(label4);\nexample4Container.addElement(textArea4);\nmainContainer.addElement(example4Container);\n\naddHighlight(textArea4.getHighlightedWord('calculus'), \"#ffcdd2\", 0.6);\naddHighlight(textArea4.getHighlightedWord('concepts'), \"#c5e1a5\", 0.6);\naddHighlight(textArea4.getHighlightedWord('fundamental'), \"#b3e5fc\", 0.6);\n\n\nconst row5 = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"horizontal\",\n  spacing: 30,\n  verticalAlignment: \"top\",\n});\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"Example 5: Narrow (wraps more)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"The {highlight:area}area{/highlight} of a circle is $A = \\\\pi r^2$ where $r$ is the {highlight:radius}radius{/highlight}. This simple formula has many applications.\",\n  width: 220,\n  fontSize: 14,\n  lineHeight: 1.4,\n  textColor: \"#0d47a1\",\n  boxModel: { padding: 12 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.addElement(label5);\nexample5Container.addElement(textArea5);\nrow5.addElement(example5Container);\n\naddHighlight(textArea5.getHighlightedWord('area'), \"#ffe082\", 0.6);\naddHighlight(textArea5.getHighlightedWord('radius'), \"#ce93d8\", 0.6);\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Example 6: No Background\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: \"The {highlight:limit}limit{/highlight} of $f(x)$ as $x$ approaches infinity is an {highlight:important}important{/highlight} concept.\",\n  width: 300,\n  fontSize: 14,\n  textColor: \"#2c3e50\",\n});\n\nexample6Container.addElement(label6);\nexample6Container.addElement(textArea6);\nrow5.addElement(example6Container);\n\naddHighlight(textArea6.getHighlightedWord('limit'), \"#ffecb3\", 0.7);\naddHighlight(textArea6.getHighlightedWord('important'), \"#f8bbd0\", 0.7);\n\nmainContainer.addElement(row5);\n\n\nconst example7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Example 7: Debug Mode (shows boxes)\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"Debug mode shows the {highlight:border}border box{/highlight} and {highlight:content}content box{/highlight} with $x = 5$.\",\n  width: 350,\n  fontSize: 15,\n  textColor: \"#c62828\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n  debug: true,\n});\n\nexample7Container.addElement(label7);\nexample7Container.addElement(textArea7);\nmainContainer.addElement(example7Container);\n\naddHighlight(textArea7.getHighlightedWord('border'), \"#c5cae9\", 0.5);\naddHighlight(textArea7.getHighlightedWord('content'), \"#fff9c4\", 0.5);\n\nconsole.log(\"=== TextArea Highlighting Debug Info ===\");\nconsole.log(\"Example 1 highlighted words:\", textArea1.getHighlightedWordIds());\nconsole.log(\"Example 3 'quadratic' position:\", textArea3.getHighlightedWord('quadratic'));\nconsole.log(\"Example 4 highlighted words:\", textArea4.getHighlightedWordIds());\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create an artboard with a white background and paddings, and on it, place a vertically stacked container with a light grey background and border. Inside this container, add seven examples, each consisting of a bold label and a text area containing mathematical formulas with specific background colors and borders. Ensure the text areas show baseline markers to help align elements. Include fractions, nested fractions, square roots, summations, integrals, and various formula alignments. Each example should have specific spacing and container paddings."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Example 1: Simple Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: \"The simple fraction $\\\\frac{a}{b}$ should align nicely with surrounding text on the same line.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show red baseline markers for debugging\n});\n\nexample1Container.addElement(label1);\nexample1Container.addElement(textArea1);\nmainContainer.addElement(example1Container);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Example 2: Complex Nested Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: \"The quadratic formula $x = \\\\frac{-b \\\\pm \\\\sqrt{b^2-4ac}}{2a}$ is used to solve equations like $ax^2 + bx + c = 0$.\",\n  width: 550,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show baseline markers\n});\n\nexample2Container.addElement(label2);\nexample2Container.addElement(textArea2);\nmainContainer.addElement(example2Container);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Example 3: Very Tall - Breaks to Separate Line\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: \"This nested fraction $\\\\frac{\\\\frac{a+b}{c+d}}{\\\\frac{e+f}{g+h}}$ is so tall it gets its own line automatically.\",\n  width: 450,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.addElement(label3);\nexample3Container.addElement(textArea3);\nmainContainer.addElement(example3Container);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Example 4: Square Roots\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: \"The distance formula $d = \\\\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$ calculates the distance between two points.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show baseline markers to debug square root alignment\n});\n\nexample4Container.addElement(label4);\nexample4Container.addElement(textArea4);\nmainContainer.addElement(example4Container);\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"Example 5: Multiple Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"Compare $\\\\frac{1}{2}$ with $\\\\frac{3}{4}$ and $\\\\frac{5}{6}$ to see consistent alignment across multiple fractions.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.addElement(label5);\nexample5Container.addElement(textArea5);\nmainContainer.addElement(example5Container);\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Example 6: Mixed Small and Tall\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: \"Small formula $a+b$ next to tall formula $\\\\frac{x+y}{z}$ and then normal text again shows smart spacing.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#e91e63\",\n    strokeWidth: 2,\n  },\n});\n\nexample6Container.addElement(label6);\nexample6Container.addElement(textArea6);\nmainContainer.addElement(example6Container);\n\n\nconst example7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Example 7: Summations and Integrals\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"The sum $\\\\sum_{i=1}^{n} i = \\\\frac{n(n+1)}{2}$ and integral $\\\\int_{0}^{1} x^2 dx = \\\\frac{1}{3}$ are fundamental formulas.\",\n  width: 550,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e0f2f1\",\n    stroke: \"#009688\",\n    strokeWidth: 2,\n  },\n});\n\nexample7Container.addElement(label7);\nexample7Container.addElement(textArea7);\nmainContainer.addElement(example7Container);\n\nconsole.log(\"=== Tall LaTeX Debug Info ===\");\nconsole.log(\"Example 2 lines:\", textArea2.lines);\nconsole.log(\"Example 3 lines (should break tall formula):\", textArea3.lines);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Create a visual layout with multiple sections showcasing mathematical formulas. Use different colors and borders for each section to distinguish them. Include examples of fractions, square roots, and integrals, ensuring they are well-spaced and aligned. The layout should help visualize how different mathematical elements interact with text."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: \"auto\",\n  height: \"auto\",\n  backgroundColor: \"#ffffff\",\n  boxModel: { padding: 40 },\n});\n\nconst mainContainer = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 30,\n  boxModel: { padding: 20 },\n  style: {\n    fill: \"#f8f9fa\",\n    stroke: \"#dee2e6\",\n    strokeWidth: 2,\n  },\n});\n\nmainContainer.position({\n  relativeFrom: mainContainer.topLeft,\n  relativeTo: artboard.contentBox.topLeft,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(mainContainer);\n\n\nconst example1Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label1 = new Text({\n  content: \"Example 1: Simple Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea1 = new TextArea({\n  content: \"The simple fraction $\\\\frac{a}{b}$ should align nicely with surrounding text on the same line.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e3f2fd\",\n    stroke: \"#2196f3\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show red baseline markers for debugging\n});\n\nexample1Container.addElement(label1);\nexample1Container.addElement(textArea1);\nmainContainer.addElement(example1Container);\n\n\nconst example2Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label2 = new Text({\n  content: \"Example 2: Complex Nested Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea2 = new TextArea({\n  content: \"The quadratic formula $x = \\\\frac{-b \\\\pm \\\\sqrt{b^2-4ac}}{2a}$ is used to solve equations like $ax^2 + bx + c = 0$.\",\n  width: 550,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fff3cd\",\n    stroke: \"#ffc107\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show baseline markers\n});\n\nexample2Container.addElement(label2);\nexample2Container.addElement(textArea2);\nmainContainer.addElement(example2Container);\n\n\nconst example3Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label3 = new Text({\n  content: \"Example 3: Very Tall - Breaks to Separate Line\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea3 = new TextArea({\n  content: \"This nested fraction $\\\\frac{\\\\frac{a+b}{c+d}}{\\\\frac{e+f}{g+h}}$ is so tall it gets its own line automatically.\",\n  width: 450,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#f3e5f5\",\n    stroke: \"#9c27b0\",\n    strokeWidth: 2,\n  },\n});\n\nexample3Container.addElement(label3);\nexample3Container.addElement(textArea3);\nmainContainer.addElement(example3Container);\n\n\nconst example4Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label4 = new Text({\n  content: \"Example 4: Square Roots\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea4 = new TextArea({\n  content: \"The distance formula $d = \\\\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}$ calculates the distance between two points.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e8f5e9\",\n    stroke: \"#4caf50\",\n    strokeWidth: 2,\n  },\n  showBaselines: true, // Show baseline markers to debug square root alignment\n});\n\nexample4Container.addElement(label4);\nexample4Container.addElement(textArea4);\nmainContainer.addElement(example4Container);\n\n\nconst example5Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label5 = new Text({\n  content: \"Example 5: Multiple Fractions\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea5 = new TextArea({\n  content: \"Compare $\\\\frac{1}{2}$ with $\\\\frac{3}{4}$ and $\\\\frac{5}{6}$ to see consistent alignment across multiple fractions.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#ffebee\",\n    stroke: \"#f44336\",\n    strokeWidth: 2,\n  },\n});\n\nexample5Container.addElement(label5);\nexample5Container.addElement(textArea5);\nmainContainer.addElement(example5Container);\n\n\nconst example6Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label6 = new Text({\n  content: \"Example 6: Mixed Small and Tall\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea6 = new TextArea({\n  content: \"Small formula $a+b$ next to tall formula $\\\\frac{x+y}{z}$ and then normal text again shows smart spacing.\",\n  width: 500,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#fce4ec\",\n    stroke: \"#e91e63\",\n    strokeWidth: 2,\n  },\n});\n\nexample6Container.addElement(label6);\nexample6Container.addElement(textArea6);\nmainContainer.addElement(example6Container);\n\n\nconst example7Container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"vertical\",\n  spacing: 10,\n});\n\nconst label7 = new Text({\n  content: \"Example 7: Summations and Integrals\",\n  fontSize: 16,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nconst textArea7 = new TextArea({\n  content: \"The sum $\\\\sum_{i=1}^{n} i = \\\\frac{n(n+1)}{2}$ and integral $\\\\int_{0}^{1} x^2 dx = \\\\frac{1}{3}$ are fundamental formulas.\",\n  width: 550,\n  fontSize: 16,\n  textColor: \"#2c3e50\",\n  boxModel: { padding: 15 },\n  style: {\n    fill: \"#e0f2f1\",\n    stroke: \"#009688\",\n    strokeWidth: 2,\n  },\n});\n\nexample7Container.addElement(label7);\nexample7Container.addElement(textArea7);\nmainContainer.addElement(example7Container);\n\nconsole.log(\"=== Tall LaTeX Debug Info ===\");\nconsole.log(\"Example 2 lines:\", textArea2.lines);\nconsole.log(\"Example 3 lines (should break tall formula):\", textArea3.lines);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Please create a 400 by 300 artboard with a light gray background and a padding of 20. Add a circle with a radius of 50 pixels, filled with a light blue color and a darker blue stroke that's 3 pixels wide. Position this circle exactly in the center of the artboard."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 400,\n  height: 300,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 20 },\n});\n\nconst circle = new Circle({\n  radius: 50,\n  style: {\n    fill: \"#4a90e2\",\n    stroke: \"#2e5f8a\",\n    strokeWidth: 3,\n  },\n});\n\ncircle.position({\n  relativeFrom: circle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(circle);\n\nreturn artboard.render();\n\n"}]}
{"messages":[{"role":"system","content":"You are an assistant that responds with code for drawing whatever user has requested in our library.\n\n# W2L Library System Guide\n\nYou are an AI assistant that generates code using the w2l (Write-to-Layout) library to create visual diagrams, charts, and mathematical visualizations. Users will describe what they want to draw, and you will respond with complete, executable JavaScript code.\n\n## Core Principles\n\n1. **No Imports Needed**: Never write import statements - all w2l elements are globally available\n2. **Use Library Positioning**: Always use the library's built-in positioning system and calculations - never manually calculate positions\n3. **Return artboard.render()**: Always end your code with `return artboard.render();`\n4. **Leverage Built-in Features**: The library handles positioning, alignment, transformations, and measurements automatically\n\n## Coordinate System\n\n- **Origin**: Top-left corner (0, 0)\n- **X-axis**: Right is positive\n- **Y-axis**: Down is positive\n- **Angles**: 0° points right, increases clockwise\n- **Units**: Pixels by default (numbers are treated as px)\n\n## Core Elements\n\n### Artboard (Canvas)\n\nThe root container for all visualizations:\n\n```javascript\nconst artboard = new Artboard({\n  width: 800, // or \"auto\" to fit content\n  height: 600, // or \"auto\" to fit content\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 }, // spacing around content\n});\n```\n\n### Positioning System\n\nAll elements use a powerful positioning API:\n\n```javascript\nelement.position({\n  relativeFrom: element.center, // anchor point on element\n  relativeTo: parent.center, // target point to align to\n  x: 0, // offset in x\n  y: 20, // offset in y\n  boxReference: \"contentBox\", // optional: \"borderBox\" (default) or \"contentBox\"\n});\n```\n\n**Key position properties**:\n\n- `center`, `topLeft`, `topRight`, `bottomLeft`, `bottomRight`\n- `top`, `bottom`, `left`, `right` (edge midpoints)\n- All properties return `Point` objects with `.x` and `.y`\n\n### Box Model\n\nEvery element follows a CSS-like box model:\n\n```javascript\n{\n  boxModel: {\n    padding: 20,          // or { top: 10, right: 20, bottom: 10, left: 20 }\n    margin: 10            // spacing outside element\n  }\n}\n```\n\n**Box layers** (outermost to innermost):\n\n1. `marginBox` - includes margin\n2. `borderBox` - default positioning reference\n3. `contentBox` - area inside padding\n\nAccess via: `element.borderBox.center` or `element.contentBox.topLeft`\n\n## Layout Containers\n\n### Container\n\nFlexible layout system with multiple modes:\n\n```javascript\nconst container = new Container({\n  width: 400, // or \"auto\"\n  height: 300, // or \"auto\"\n  direction: \"vertical\", // \"horizontal\", \"vertical\", \"none\", or \"freeform\"\n  spacing: 20, // space between children\n  horizontalAlignment: \"center\", // \"left\", \"center\", \"right\"\n  verticalAlignment: \"top\", // \"top\", \"center\", \"bottom\"\n  boxModel: { padding: 20 },\n  style: { fill: \"#fff\", stroke: \"#ccc\", strokeWidth: 2 },\n});\n\ncontainer.addElement(childElement);\n```\n\n**Directions**:\n\n- `\"horizontal\"`: Stack left-to-right\n- `\"vertical\"`: Stack top-to-bottom\n- `\"freeform\"`: Children position themselves, container auto-sizes\n- `\"none\"`: Position at content top-left, normalize bounds\n\n### Grid Layout\n\n```javascript\nconst grid = new Grid({\n  rows: 3,\n  cols: 3,\n  cellWidth: 100,\n  cellHeight: 100,\n  gap: 10,\n  boxModel: { padding: 20 },\n});\n\ngrid.placeElement(element, { row: 0, col: 0 });\n```\n\n### Columns Layout\n\n```javascript\nconst columns = new Columns({\n  count: 3,\n  columnWidth: 300,\n  height: \"auto\",\n  gutter: 30, // space between columns\n  columnSpacing: 20, // space between items within column\n  verticalAlignment: \"top\",\n  horizontalAlignment: \"center\",\n});\n\ncolumns.getColumn(0).addElement(element); // add to first column\n```\n\n## Shapes\n\n### Circle\n\n```javascript\nconst circle = new Circle({\n  radius: 50,\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n```\n\n### Rectangle / Square\n\n```javascript\nconst rect = new Rect({\n  width: 100,\n  height: 60,\n  style: { fill: \"#e74c3c\", stroke: \"#c0392b\", strokeWidth: 2 },\n});\n\nconst square = new Square({\n  size: 80,\n  style: { fill: \"#2ecc71\" },\n});\n```\n\n### Triangle\n\n```javascript\nconst triangle = new Triangle({\n  type: \"right\", // \"right\", \"equilateral\", \"isosceles\", or \"scalene\"\n  a: 120, // base side length\n  b: 90, // height side length (for right/isosceles)\n  c: 150, // third side (for scalene)\n  orientation: \"bottomLeft\", // where the right angle is\n  style: { fill: \"#9b59b6\", stroke: \"#8e44ad\", strokeWidth: 2 },\n});\n\n// Access triangle properties:\ntriangle.sides; // array of Side objects with .length, .center, .angle, .outwardNormal\ntriangle.vertices; // array of vertices\n```\n\n### Regular Polygons\n\n```javascript\nconst polygon = new RegularPolygon({\n  sides: 6, // hexagon\n  radius: 50, // distance from center to vertex\n  rotation: 0, // optional rotation\n  style: { fill: \"#f39c12\", stroke: \"#e67e22\", strokeWidth: 2 },\n});\n```\n\n### Quadrilaterals\n\n```javascript\nconst quad = new Quadrilateral({\n  type: \"parallelogram\", // \"parallelogram\", \"trapezoid\", \"rhombus\", \"rectangle\"\n  a: 140, // first side length\n  b: 80, // second side length\n  angle: 65, // angle in degrees\n  style: { fill: \"#e3f2fd\", stroke: \"#1976d2\", strokeWidth: 2 },\n});\n\n// Show angles:\nconst angle = quad.showAngle(0, {\n  mode: \"internal\", // or 'external'\n  radius: 40,\n  label: \"α\",\n  labelFontSize: 16,\n  style: { stroke: \"#d32f2f\", strokeWidth: 2 },\n});\n\n// Show all angles at once:\nconst angles = quad.showAngles({\n  mode: \"internal\",\n  labels: [\"α\", \"β\", \"γ\", \"δ\"],\n  radius: 35,\n});\n```\n\n### Lines\n\n```javascript\nconst line = new Line({\n  start: { x: 0, y: 0 },\n  end: { x: 100, y: 100 },\n  style: { stroke: \"#34495e\", strokeWidth: 2 },\n});\n\n// Reactive line (follows elements):\nconst line = new Line({\n  start: circle1.center, // Point reference\n  end: circle2.center, // automatically updates\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n```\n\n## Text and LaTeX\n\n### Text\n\n```javascript\nconst text = new Text({\n  content: \"Hello, World!\",\n  fontSize: 18,\n  fontWeight: \"bold\", // \"normal\", \"bold\"\n  fontFamily: \"Arial\",\n  textAlign: \"center\", // \"left\", \"center\", \"right\"\n  maxWidth: 400, // text wrapping width\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX\n\nInline LaTeX in text using `$...$` delimiters:\n\n```javascript\nconst text = new Text({\n  content: \"The formula is $E = mc^2$ where $E$ is energy.\",\n  fontSize: 16,\n});\n```\n\nStandalone LaTeX:\n\n```javascript\nconst latex = new Latex({\n  content: \"\\\\frac{-b \\\\pm \\\\sqrt{b^2 - 4ac}}{2a}\",\n  fontSize: 24,\n  style: { fill: \"#2c3e50\" },\n});\n```\n\n### LaTeX Annotations (Highlighting)\n\nUse `\\cssId{id}{content}` or `\\class{name}{content}` to mark parts:\n\n```javascript\nconst text = new Text({\n  content: \"Einstein's $\\\\cssId{mass-energy}{E = mc^2}$ equation\",\n  fontSize: 20,\n  annotatedElements: [\n    {\n      id: \"mass-energy\",\n      style: {\n        backgroundColor: \"#ffeb3b\",\n        padding: \"2px 4px\",\n        borderRadius: \"3px\",\n      },\n    },\n  ],\n});\n```\n\n### Text Areas (Multi-paragraph)\n\n```javascript\nconst textarea = new TextArea({\n  content: \"First paragraph.\\n\\nSecond paragraph with $x^2 + y^2 = r^2$.\",\n  fontSize: 16,\n  maxWidth: 600,\n  lineHeight: 1.6,\n  paragraphSpacing: 12,\n  highlightedWords: [\n    { word: \"important\", style: { backgroundColor: \"#ffeb3b\" } },\n  ],\n});\n```\n\n## Mathematical Visualizations\n\n### Function Graphs\n\n```javascript\nconst graph = new FunctionGraph({\n  width: 500,\n  height: 400,\n  xRange: [-5, 5],\n  yRange: [-5, 5],\n  functions: [\n    {\n      fn: (x) => x * x,\n      style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n      label: \"$y = x^2$\",\n    },\n    {\n      fn: (x) => Math.sin(x),\n      style: { stroke: \"#3498db\", strokeWidth: 2 },\n      label: \"$y = \\\\sin(x)$\",\n    },\n  ],\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true, // auto-detect roots, extrema, inflection points\n  axisLabels: { x: \"$x$\", y: \"$y$\" },\n});\n\n// Access remarkable points:\ngraph.remarkablePoints; // array of {type, x, y, functionIndex}\n// types: \"root\", \"minimum\", \"maximum\", \"inflection\"\n```\n\n### Angles\n\n```javascript\nconst angle = new Angle({\n  vertex: { x: 100, y: 100 },\n  start: { x: 150, y: 100 }, // first ray endpoint\n  end: { x: 100, y: 50 }, // second ray endpoint\n  radius: 30,\n  label: \"θ\",\n  labelFontSize: 14,\n  showLabel: true,\n  style: {\n    stroke: \"#e74c3c\",\n    strokeWidth: 2,\n    fill: \"#e74c3c\",\n    fillOpacity: 0.1,\n  },\n});\n\n// Or from lines:\nconst angle = Angle.fromLines(line1, line2, {\n  radius: 40,\n  label: \"α\",\n});\n\n// Or from shape sides:\nconst angle = Angle.fromSides(triangle.sides[0], triangle.sides[1], {\n  radius: 35,\n  label: \"90°\",\n});\n```\n\n### Arrows\n\n```javascript\nconst arrow = new Arrow({\n  start: { x: 50, y: 50 },\n  end: { x: 200, y: 150 },\n  headSize: 12,\n  style: { stroke: \"#3498db\", strokeWidth: 2, fill: \"#3498db\" },\n});\n\n// Reactive arrow (follows elements):\nconst arrow = new Arrow({\n  start: circle1.center,\n  end: circle2.center,\n  headSize: 10,\n});\n```\n\n## Charts\n\n### Bar Chart\n\n```javascript\nconst chart = new BarChart({\n  data: [\n    { label: \"Jan\", value: 45 },\n    { label: \"Feb\", value: 52 },\n    { label: \"Mar\", value: 38 },\n  ],\n  orientation: \"vertical\", // or \"horizontal\"\n  width: 600,\n  height: 400,\n  barColor: \"#2196f3\",\n  showGrid: true,\n  showAxes: true,\n  showLabels: true,\n  detectRemarkablePoints: true, // auto-detect max, min, average\n});\n\n// Access remarkable points:\nchart.remarkablePoints; // array of {type, index, value}\n// types: \"maximum\", \"minimum\", \"average\"\n```\n\n### Donut Chart\n\n```javascript\nconst donut = new DonutChart({\n  data: [\n    { label: \"Category A\", value: 30, color: \"#e74c3c\" },\n    { label: \"Category B\", value: 45, color: \"#3498db\" },\n    { label: \"Category C\", value: 25, color: \"#2ecc71\" },\n  ],\n  radius: 120,\n  innerRadius: 60, // creates donut hole\n  showLabels: true,\n  showPercentages: true,\n});\n```\n\n### Line Chart\n\n```javascript\nconst lineChart = new LineChart({\n  data: [\n    {\n      label: \"Series 1\",\n      points: [\n        { x: 0, y: 10 },\n        { x: 1, y: 25 },\n        { x: 2, y: 18 },\n      ],\n      color: \"#e74c3c\",\n    },\n  ],\n  width: 600,\n  height: 400,\n  showGrid: true,\n  showAxes: true,\n  detectRemarkablePoints: true,\n});\n```\n\n### Radar Chart\n\n```javascript\nconst radar = new RadarChart({\n  data: [\n    {\n      label: \"Skills\",\n      values: [8, 7, 9, 6, 8],\n      color: \"#3498db\",\n    },\n  ],\n  labels: [\"Math\", \"Science\", \"Arts\", \"Sports\", \"Music\"],\n  radius: 150,\n  showGrid: true,\n  showLabels: true,\n});\n```\n\n## Transformations\n\nAll shapes support geometric transformations:\n\n```javascript\n// Translate (move)\nelement.translate({ x: 1, y: 0 }, 50); // move 50px to the right\nelement.translate({ x: 0, y: 1 }, -30); // move 30px up\n\n// Rotate\nelement.rotate(45); // rotate 45° clockwise around center\n\n// Scale\nelement.scale(1.5); // scale to 150%\n```\n\n## Styling\n\nStandard SVG style properties:\n\n```javascript\n{\n  style: {\n    fill: \"#3498db\",           // fill color\n    fillOpacity: 0.7,          // fill transparency (0-1)\n    stroke: \"#2980b9\",         // border color\n    strokeWidth: 2,            // border width\n    strokeDasharray: \"5,5\",    // dashed line pattern\n    strokeOpacity: 1           // border transparency (0-1)\n  }\n}\n```\n\n## Common Patterns\n\n### Centering Elements\n\n```javascript\n// Center element in artboard\nelement.position({\n  relativeFrom: element.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n```\n\n### Placing Elements Relative to Each Other\n\n```javascript\n// Place element2 below element1\nelement2.position({\n  relativeFrom: element2.topLeft,\n  relativeTo: element1.bottomLeft,\n  x: 0,\n  y: 20, // 20px gap\n});\n```\n\n### Creating Geometric Diagrams\n\n```javascript\n// Use triangle sides for precise positioning\nconst square = new Rect({\n  width: triangle.sides[0].length,\n  height: triangle.sides[0].length,\n});\n\nsquare.position({\n  relativeFrom: square.center,\n  relativeTo: triangle.sides[0].center, // center of side\n  x: 0,\n  y: 0,\n});\n\nsquare.rotate(triangle.sides[0].angle); // align with side\nsquare.translate(triangle.sides[0].outwardNormal, square.width / 2); // move outward\n```\n\n### Auto-sizing Containers\n\n```javascript\nconst container = new Container({\n  width: \"auto\",\n  height: \"auto\",\n  direction: \"freeform\",\n});\n\n// Add all children...\ncontainer.addElement(element1);\ncontainer.addElement(element2);\n\n// Finalize before positioning container\ncontainer.finalizeFreeformLayout();\n\n// Now position the container\ncontainer.position({\n  relativeFrom: container.center,\n  relativeTo: artboard.contentBox.center,\n});\n```\n\n## Best Practices\n\n1. **Always use library positioning**: Never calculate coordinates manually\n2. **Use reactive positioning**: Reference element properties (e.g., `circle.center`) for automatic updates\n3. **Leverage sides and vertices**: Access built-in geometric properties instead of computing them\n4. **Use appropriate containers**: Choose Container direction based on layout needs\n5. **Let the library handle calculations**: Use `.translate()`, `.rotate()` instead of manual math\n6. **Use auto-sizing**: Set `width: \"auto\"` or `height: \"auto\"` when appropriate\n7. **Reference box models**: Use `.contentBox` or `.borderBox` for precise positioning\n8. **Return render result**: Always end with `return artboard.render();`\n\n## Complete Example\n\n```javascript\n// Create artboard\nconst artboard = new Artboard({\n  width: 800,\n  height: 600,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 40 },\n});\n\n// Create a right triangle\nconst triangle = new Triangle({\n  type: \"right\",\n  a: 120,\n  b: 90,\n  orientation: \"bottomLeft\",\n  style: { fill: \"#3498db\", stroke: \"#2980b9\", strokeWidth: 2 },\n});\n\n// Center triangle in artboard\ntriangle.position({\n  relativeFrom: triangle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(triangle);\n\n// Add angle annotation\nconst angle = triangle.showAngle(0, {\n  mode: \"internal\",\n  radius: 30,\n  label: \"90°\",\n  style: { stroke: \"#e74c3c\", strokeWidth: 2 },\n});\n\nartboard.addElement(angle);\n\n// Add label\nconst label = new Text({\n  content: \"Right Triangle\",\n  fontSize: 20,\n  fontWeight: \"bold\",\n  style: { fill: \"#2c3e50\" },\n});\n\nlabel.position({\n  relativeFrom: label.bottom,\n  relativeTo: triangle.top,\n  x: 0,\n  y: -20,\n});\n\nartboard.addElement(label);\n\nreturn artboard.render();\n```\n\nRemember: The user provides the description, you provide the complete executable code. Focus on leveraging the library's built-in features for positioning, calculations, and layout.\n"},{"role":"user","content":"Draw a medium-sized rectangle with a neutral background and some padding. Place a large circle in the middle, using a few shades of blue for the fill and border."},{"role":"assistant","content":"const artboard = new Artboard({\n  width: 400,\n  height: 300,\n  backgroundColor: \"#f0f0f0\",\n  boxModel: { padding: 20 },\n});\n\nconst circle = new Circle({\n  radius: 50,\n  style: {\n    fill: \"#4a90e2\",\n    stroke: \"#2e5f8a\",\n    strokeWidth: 3,\n  },\n});\n\ncircle.position({\n  relativeFrom: circle.center,\n  relativeTo: artboard.contentBox.center,\n  x: 0,\n  y: 0,\n});\n\nartboard.addElement(circle);\n\nreturn artboard.render();\n\n"}]}
